{"remainingRequest":"D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\thread-loader\\dist\\cjs.js!D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\babel-loader\\lib\\index.js!D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\huangcaiplace\\zhihuiguanqu\\src\\table\\table-zfsq\\table-history.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\huangcaiplace\\zhihuiguanqu\\src\\table\\table-zfsq\\table-history.vue","mtime":1577669404091},{"path":"D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _parseInt from \"D:\\\\huangcaiplace\\\\zhihuiguanqu\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/parse-int\";\nimport \"core-js/modules/web.dom.iterable\";\nimport _JSON$stringify from \"D:\\\\huangcaiplace\\\\zhihuiguanqu\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/json/stringify\";\nimport \"core-js/modules/es6.regexp.replace\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport FilterMethods from \"@/assets/commonJS/FilterMethods\";\nimport GetDataMethods from \"@/assets/commonJS/GetDataMethods\";\nimport App from \"@/App.vue\";\nexport default {\n  data: function data() {\n    return {\n      yujingdata: [],\n      loading: false,\n      qudao: true,\n      xingzhengquhua: false,\n      show1: true,\n      Menu: {\n        show_Controller: false\n      },\n      span1: '19',\n      span2: '5',\n      Treedata: [{\n        title: \"xxx灌区\",\n        expand: true,\n        children: [{\n          title: \"xxx渠道\",\n          expand: true,\n          children: [{\n            title: \"站点A\"\n          }, {\n            title: \"站点B\"\n          }]\n        }, {\n          title: \"xxx渠道\",\n          children: [{\n            title: \"站点C\"\n          }]\n        }, {\n          title: \"xxx渠道\",\n          children: [{\n            title: \"站点D\"\n          }]\n        }]\n      }],\n      AD_CD: '',\n      Treedata2: [],\n      GD: '',\n      data1: [],\n      data2: [],\n      changebtn: '切换线形图',\n      date: '',\n      STinfo: {},\n      searchs: \"\",\n      timesearch: '',\n      CZMC: '',\n      echarts: {\n        TM: [],\n        Q: [],\n        UPZ: [],\n        DWZ: []\n      },\n      form: {\n        searchmsg: '',\n        date: '',\n        field: ''\n      },\n      searchmsg: '',\n      MaxY1: 0,\n      MaxY2: 0,\n      MinY1: 0,\n      MinY2: 0,\n      list_input: {\n        total: 0,\n        pagesize: 50,\n        pagesizeopts: [10, 20, 50, 75, 100, 200],\n        current: 1\n      }\n    };\n  },\n  // 引入过滤方法到此组件\n  mixins: [FilterMethods, GetDataMethods],\n  // watch: {\n  //   searchmsg(val) {\n  //     this.$refs.tree.filter(val);\n  //   }\n  // },\n  mounted: function mounted() {\n    var _this = this;\n\n    var date = new Date();\n    var Month = date.getMonth() + 1;\n    var datelist = new Array();\n    var Hours = date.getHours();\n    var Minutes = date.getMinutes();\n    var Seconds = date.getSeconds();\n\n    if (Hours < 10) {\n      Hours = \"0\".concat(Hours);\n    }\n\n    if (Minutes < 10) {\n      Minutes = \"0\".concat(Minutes);\n    }\n\n    if (Seconds < 10) {\n      Seconds = \"0\".concat(Seconds);\n    }\n\n    if (Month < 10) {\n      Month = \"0\".concat(Month);\n    }\n\n    datelist[0] = \"\".concat(date.getFullYear(), \"-\").concat(Month, \"-\").concat(date.getDate(), \" 00:00:00\");\n    datelist[1] = \"\".concat(date.getFullYear(), \"-\").concat(Month, \"-\").concat(date.getDate(), \" \").concat(Hours, \":\").concat(Minutes, \":\").concat(Seconds);\n    this.form.date = datelist;\n    console.log(this.form.date);\n    this.axios.get(\"/guanqu/table/xingzhen_tree?type=5\").then(function (res) {\n      console.log(res);\n      _this.Treedata2 = _this.XingZheng_Tree_Filter('650000000000', res.data).data;\n    }); //获取输排水渠道数据,然后设置渠道选择框选项\n\n    this.axios.get(\"/guanqu/table/qudao_tree?type=5\").then(function (res) {\n      _this.Treedata = _this.QuDao_Tree_Filter(res.data).data;\n      _this.CZMC = _this.QuDao_Tree_Filter(res.data).siteinfo.canal_name; // this.searchs = `&STCD=${this.QuDao_Tree_Filter(res.data).siteinfo.canal_code}`;\n\n      _this.STinfo.STNM = _this.QuDao_Tree_Filter(res.data).siteinfo.canal_name;\n      _this.STinfo.STCD = _this.QuDao_Tree_Filter(res.data).siteinfo.canal_code;\n      _this.searchs = _this.QuDao_Tree_Filter(res.data).siteinfo.canal_code;\n      console.log(_this.searchs);\n\n      _this.Reload();\n\n      console.log('渠道', _this.QuDao_Tree_Filter(res.data));\n    }); // this.Reload();\n  },\n  methods: {\n    sort_change: function sort_change(column) {\n      console.log(column);\n\n      if (column.order == 'ascending') {\n        this.form.field = column.prop;\n        this.Reload();\n      }\n\n      if (column.order == 'descending') {\n        this.form.field = column.prop + ' desc';\n        this.Reload();\n      }\n\n      if (column.order == null) {\n        this.form.field = '';\n        this.Reload();\n      }\n    },\n    Menu_toggle: function Menu_toggle() {\n      this.Menu.show_Controller = !this.Menu.show_Controller;\n      this.show1 = !this.show1;\n\n      if (this.show1 == true) {\n        this.span1 = '19';\n        this.span2 = '5';\n        this.data2 = {};\n        this.Reload();\n      } else {\n        this.span1 = '24';\n        this.span2 = '0';\n        this.data2 = {};\n        this.Reload();\n      }\n    },\n    // 监听动态参数事件处理函数\n    test1: function test1(agmt) {\n      this.Menu.show_Controller = !agmt; // this.show1 = agmt;\n\n      if (agmt) {\n        if (this.span1 == '24') {\n          this.span2 = '0';\n          this.asyncExecute();\n          return;\n        }\n\n        this.span1 = '19';\n        this.span2 = '5';\n        this.data2 = {};\n        this.asyncExecute();\n      } else {\n        if (this.span1 == '24') {\n          this.span2 = '0';\n          this.asyncExecute();\n          return;\n        }\n\n        this.span1 = '19';\n        this.span2 = '5';\n        this.data2 = {};\n        this.asyncExecute();\n      }\n    },\n    // 异步刷新，重新绘图\n    asyncExecute: function asyncExecute() {\n      setTimeout(this.Reload, 100);\n    },\n    qudao_tree: function qudao_tree(data) {\n      console.log(data);\n\n      if (data.bj !== 0) {\n        this.searchs = data.canal_code;\n        this.STinfo.STCD = data.canal_code;\n        this.STinfo = data;\n        this.CZMC = data.label.replace('【站点】', '');\n        this.Reload();\n      }\n    },\n    xingzheng_tree: function xingzheng_tree(data) {\n      console.log(data);\n\n      if (data.bj !== 0) {\n        this.searchs = data.ad_cd;\n        this.STinfo.STCD = data.ad_cd;\n        this.STinfo = data;\n        this.CZMC = data.label.replace('【站点】', '');\n        this.Reload();\n      }\n    },\n    filterNode: function filterNode(value, Treedata, node) {\n      this.filterTreeData.push(node);\n      if (!value) return true;\n      return Treedata.label.indexOf(value) !== -1;\n    },\n    search: function search() {\n      var _this2 = this;\n\n      // console.log(this.searchmsg);\n      this.filterTreeData = [];\n      this.$refs.tree.filter(this.searchmsg);\n\n      if (this.searchmsg != '') {\n        this.filterTreeData.some(function (val, index) {\n          // console.log(val.expanded, val.data)\n          if (val.visible && val.data.bj == 0 && val.data.canal_code) {\n            console.log(val);\n            val.isCurrent = true;\n            _this2.searchs = \"\".concat(val.data.canal_code);\n            _this2.CZMC = val.label.replace('【站点】', '');\n            _this2.STinfo.STCD = val.data.canal_code;\n            console.log(\"this.searchmsg\", _this2.searchmsg);\n            return true;\n          } else if (val.visible && val.data.bj == 0 && val.data.ad_cd) {\n            val.isCurrent = true;\n            _this2.searchs = \"\".concat(val.data.ad_cd);\n            _this2.STinfo.STCD = val.data.canal_code;\n            _this2.CZMC = val.label.replace('【站点】', '');\n            return true;\n          }\n        });\n        this.Reload();\n      } else {\n        // this.searchs = '';\n        this.Reload();\n      }\n    },\n    timechange: function timechange() {\n      console.log(this.form.date);\n      this.Reload();\n    },\n    cellclick: function cellclick() {\n      var _this3 = this;\n\n      console.log(_JSON$stringify(this.STinfo));\n\n      if (_JSON$stringify(this.STinfo) == \"{}\") {\n        this.$Message.warning('请先选择站点');\n      } else {\n        if (this.STinfo.bj) {\n          this.STinfo.STCD = this.STinfo.canal_code;\n        } // 给将要传过去的参数添加预警信息\n\n\n        this.yujingdata.forEach(function (item) {\n          if (item.rowinfo.STCD === _this3.STinfo.STCD) {\n            _this3.STinfo.YUJING_EZ = item.rowinfo.YUJING_EZ;\n            _this3.STinfo.YUJING_JYEZ = item.rowinfo.YUJING_JYEZ;\n            _this3.STinfo.YUJING_JYQ = item.rowinfo.YUJING_JYQ;\n            _this3.STinfo.YUJING_JYSZ = item.rowinfo.YUJING_JYSZ;\n            _this3.STinfo.YUJING_Q = item.rowinfo.YUJING_Q;\n            _this3.STinfo.YUJING_SZ = item.rowinfo.YUJING_SZ;\n          }\n        });\n        console.log(this.STinfo);\n        var evt = new Object();\n        evt.graphic = new Object();\n        evt.graphic.attributes = this.STinfo;\n        evt.graphic.attributes.STNM = this.CZMC;\n        evt.graphic.attributes.itype = \"zhafashuiqing\";\n        evt.graphic.attributes.rowinfo = JSON.parse(_JSON$stringify(this.STinfo));\n        evt.graphic.attributes.rowinfo.tableType = {\n          zfsq: \"historyTable\"\n        };\n        var v = new Object();\n        v.itype = \"zhafashuiqing\";\n        console.log(\"evt\", evt);\n        this.$App.showDrawer(evt, v);\n      }\n    },\n    drawchart: function drawchart() {\n      var achart = this.$echarts.init(this.$refs.achart);\n      console.log(achart);\n      achart.resize();\n      achart.setOption({\n        title: {\n          text: \"\"\n        },\n        tooltip: {\n          trigger: \"axis\"\n        },\n        legend: {\n          data: [\"流量\", \"闸前水深\", \"闸后水深\"]\n        },\n        calculable: true,\n        xAxis: [{\n          type: \"category\",\n          boundaryGap: false,\n          data: this.data2.x.list,\n          axisLabel: {\n            interval: _parseInt(this.data2.x.list.length / 3.2),\n            rotate: 50\n          }\n        }],\n        grid: {\n          // 控制图的大小，调整下面这些值就可以，\n          x: 70,\n          x2: 40,\n          y2: 100 // y2可以控制 X轴跟Zoom控件之间的间隔，避免以为倾斜后造成 label重叠到zoom上\n\n        },\n        yAxis: [{\n          name: \"流量\",\n          type: \"value\",\n          min: this.data2.y1.min,\n          max: this.data2.y1.max\n        }, {\n          name: \"水深\",\n          type: \"value\",\n          min: this.data2.y2.min,\n          max: this.data2.y2.max\n        }],\n        series: [{\n          name: \"流量\",\n          type: \"line\",\n          yAxisIndex: 0,\n          data: this.data2.y1.list,\n          itemStyle: {\n            normal: {\n              color: \"#006400\",\n              //折线点的颜色\n              lineStyle: {\n                color: \"#006400\" //折线的颜色\n\n              }\n            }\n          } // data: [0.36, 0.28, 0.36, 0.02, 0.12]\n\n        }, {\n          name: \"闸前水深\",\n          type: \"line\",\n          yAxisIndex: 1,\n          data: this.data2.y2.list,\n          itemStyle: {\n            normal: {\n              color: \"#8B0000\",\n              //折线点的颜色\n              lineStyle: {\n                color: \"#8B0000\" //折线的颜色\n\n              }\n            }\n          } // data: [5.0, 10.0, 20.0, 25.0, 22.0]\n\n        }, {\n          name: \"闸后水深\",\n          type: \"line\",\n          yAxisIndex: 1,\n          data: this.data2.y3.list,\n          itemStyle: {\n            normal: {\n              color: \"#9400D3\",\n              //折线点的颜色\n              lineStyle: {\n                color: \"#9400D3\" //折线的颜色\n\n              }\n            }\n          } // data: [5.0, 10.0, 20.0, 25.0, 22.0]\n\n        }]\n      });\n    },\n    err: function err() {\n      this.$Message.warning('该功能还在开发中...');\n    },\n    changeTree: function changeTree() {\n      this.qudao = !this.qudao;\n      this.xingzhengquhua = !this.xingzhengquhua;\n    },\n    Reload: function Reload() {\n      var _this4 = this;\n\n      this.loading = true;\n      console.log(this.searchs);\n      var obj = {\n        Time_min: this.form.date[0].substr(0, 19),\n        Time_max: this.form.date[1].substr(0, 19),\n        STCD: this.searchs,\n        _orderby: this.form.field // console.log(this.list_input.current + this.searchs);\n\n      };\n      this.axios.get(\"/guanqu/zhafashuiqing/lishi_lishibiao?_page_size=\" + this.list_input.pagesize + \"&_page=\" + this.list_input.current, {\n        params: obj\n      }).then(function (res) {\n        console.log(res.data.list);\n        _this4.data1 = res.data.list;\n\n        if (res.data.total != 0) {} // this.CZMC = res.data.list[0].STNM;\n        // this.STinfo = res.data.list[0];\n        // this.CZMC = '南岭泄洪闸站';\n\n\n        _this4.list_input.total = res.data.total;\n        _this4.loading = false;\n\n        for (var i = 0; i < _this4.data1.length; i++) {\n          _this4.data1[i].Q = _this4.Z_Filter(_this4.data1[i].Q, 3);\n          _this4.data1[i].UPZ = _this4.Z_Filter(_this4.data1[i].UPZ);\n          _this4.data1[i].DWZ = _this4.Z_Filter(_this4.data1[i].DWZ);\n          _this4.data1[i].TM = _this4.dateFilter(_this4.data1[i].TM);\n        }\n      });\n      this.axios.get(\"/guanqu/zhafashuiqing/lishi_lishibiao?_page=1&_page_size=99999\", {\n        params: obj\n      }).then(function (res) {\n        _this4.data2 = res.data.list.reverse();\n        console.log(_this4.data2);\n\n        for (var i = 0; i < _this4.data2.length; i++) {\n          _this4.data2[i].TM = _this4.dateFilter(_this4.data2[i].TM);\n        }\n\n        _this4.data2 = _this4.transform_ZFSQ_data_into_ehart_data(_this4.data2, 'historyTable'); // console.log(this.transform_ZFSQ_data_into_ehart_data(this.data2,'historyTable'));\n\n        _this4.drawchart();\n      }); // 取预警信息\n\n      this.axios.get('/guanqu/zhafashuiqing/gis').then(function (res) {\n        console.log('++++++++++++', res);\n        _this4.yujingdata = res.data.features;\n      });\n    },\n    indexMethod: function indexMethod(index) {\n      return index + 1 + this.list_input.pagesize * (this.list_input.current - 1);\n    },\n    // 处理页码切换\n    CurrentChange: function CurrentChange(index) {\n      // console.log(index);\n      console.log(this.STinfo.STCD);\n      this.list_input.current = index;\n      this.Reload();\n    },\n    // 处理每页显示条数切换\n    PagesizeChange: function PagesizeChange(pagesize) {\n      // console.log(pagesize)\n      this.list_input.pagesize = pagesize;\n      this.Reload();\n    }\n  },\n  created: function created() {},\n  computed: {\n    balabala: function balabala() {\n      //console.log(this.$store.state.anniu);\n      return this.$store.state.anniu;\n    }\n  },\n  watch: {\n    // 'this.$store.state.anniu': function(){\n    //   console.log(this.$store.state.anniu);\n    // }\n    balabala: function balabala(curVal, oldVal) {\n      console.log(curVal);\n      this.test1(curVal);\n    }\n  }\n};",null]}