{"remainingRequest":"D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\thread-loader\\dist\\cjs.js!D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\babel-loader\\lib\\index.js!D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\huangcaiplace\\zhihuiguanqu\\src\\table\\table-zfkz\\table-sskz\\list.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\huangcaiplace\\zhihuiguanqu\\src\\table\\table-zfkz\\table-sskz\\list.vue","mtime":1577669404088},{"path":"D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _parseFloat from \"D:\\\\huangcaiplace\\\\zhihuiguanqu\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/parse-float\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport _JSON$stringify from \"D:\\\\huangcaiplace\\\\zhihuiguanqu\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/json/stringify\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport FilterMethods from \"@/assets/commonJS/FilterMethods\";\nimport GetDataMethods from \"@/assets/commonJS/GetDataMethods\";\nimport Image from \"@/assets/image/shuizha.jpg\"; //import { setTimeout, setInterval, clearInterval } from \"timers\";\n\nexport default {\n  data: function data() {\n    return {\n      run_button: false,\n      table: {\n        kaidulishi: {\n          Rows: [],\n          loading: false\n        },\n        SSXX: {\n          Rows: [],\n          loading: false\n        }\n      },\n      details: {\n        rowinfo: null,\n        current_OD: 0.5,\n        split: 0.3,\n        Interval: null\n      },\n      // koen\n      kz: {\n        OD: 0,\n        STCD: '',\n        STNM: '',\n        MAX: 10\n      },\n      kz_lishi: [],\n      counter: {\n        total: 0\n      },\n      marks: {\n        0: \"0\",\n        50: {\n          style: {\n            color: \"#1989FA\"\n          },\n          label: this.$createElement(\"strong\", \"1.00\")\n        },\n        100: \"2\"\n      },\n      dialogTableVisible: false,\n      loading: false,\n      activeNames: [],\n      list_input: {\n        total: 100,\n        pagesize: 48,\n        pagesizeopts: [10, 20, 48, 75, 100, 200],\n        current: 1\n      },\n      form: {\n        adressList: [],\n        qudaoList: [],\n        siteList: [{\n          value: \"1\",\n          label: \"闸门\"\n        }, {\n          value: \"2\",\n          label: \"阀门\"\n        }],\n        model_site: [],\n        model_adress: \"\",\n        zdlx: \"\",\n        model_qudao: \"\",\n        model_guanli: \"\",\n        date: \"\",\n        search_str: null,\n        xzqh: \"\",\n        qd: \"\"\n      },\n      timesearch: \"\",\n      data: [],\n      list: [{\n        Image: Image\n      }, {\n        Image: Image\n      }, {\n        Image: Image\n      }, {\n        Image: Image\n      }, {\n        Image: Image\n      }],\n      searchs: \"\",\n      STNMSlength: 0,\n      STNMlength: 0,\n      item: {},\n      video_iframe: ''\n    };\n  },\n  // 引入过滤方法到此组件\n  mixins: [FilterMethods, GetDataMethods],\n  methods: {\n    //绘制闸门图\n    drawchart: function drawchart(Hight, OD) {\n      var achart = this.$echarts.init(document.getElementById(achart));\n      console.log('+++++++++++++++++++', Hight, OD);\n      achart.resize();\n      achart.setOption({\n        xAxis: {\n          type: 'category',\n          data: ['闸门']\n        },\n        yAxis: [{\n          inverse: true,\n          type: 'value',\n          min: 0,\n          max: Hight,\n          axisLabel: {\n            show: false\n          }\n        }, {\n          name: \"闸门高度\",\n          type: 'value',\n          min: 0,\n          max: Hight\n        }],\n        series: [{\n          data: [Hight - OD],\n          type: 'bar'\n        }]\n      });\n    },\n    formatTooltip: function formatTooltip(val) {\n      return val / (100 / 2);\n    },\n    handleChange: function handleChange(val) {\n      console.log(val);\n    },\n    fangda: function fangda(data, index) {\n      // data = data.map(val => {\n      //   // val.url = val.Image;\n      //   return val;\n      // });\n      // console.log(item);\n      this.$App.enlarge_img(data, index);\n    },\n    // 分页过滤\n    pageFilter: function pageFilter(currentPage, pageSizes) {\n      var _currentPage = currentPage || this.table.currentPage;\n\n      var _pageSizes = pageSizes || this.table.pageSizes; // 截取数组\n\n\n      var newList = this.table.Rows_filter.slice((_currentPage - 1) * _pageSizes, _currentPage * _pageSizes);\n      return newList;\n    },\n    gobox: function gobox(item) {\n      console.log(item);\n      var evt = new Object();\n      evt.graphic = new Object();\n      evt.graphic.attributes = item;\n      evt.graphic.attributes.itype = \"tuxiang\";\n      evt.graphic.attributes.rowinfo = JSON.parse(_JSON$stringify(item));\n      evt.graphic.attributes.STNM = evt.graphic.attributes.stnm;\n      evt.graphic.attributes.STCD = evt.graphic.attributes.stcd;\n      evt.graphic.attributes.rowinfo.STNM = evt.graphic.attributes.rowinfo.stnm;\n      evt.graphic.attributes.rowinfo.STCD = evt.graphic.attributes.rowinfo.stcd; // evt.graphic.attributes.rowinfo.tableType = {\n      //   tx: \"historyTable\"\n      // };\n\n      var v = new Object();\n      v.itype = \"tuxiang\";\n      console.log(\"evt\", evt);\n      this.$App.showDrawer(evt, v);\n    },\n    Reload: function Reload() {\n      var _this = this;\n\n      this.loading = true;\n\n      if (this.form.model_adress.length == 0) {\n        this.form.xzqh = \"\";\n      }\n\n      if (this.form.model_adress.length == 1) {\n        var str1 = this.form.model_adress[0];\n        str1 = str1.substring(0, 6);\n        this.form.xzqh = str1;\n      }\n\n      if (this.form.model_adress.length == 2) {\n        var str2 = this.form.model_adress[1];\n        str2 = str2.substring(0, 9);\n        this.form.xzqh = str2;\n      }\n\n      if (this.form.model_adress.length == 3) {\n        var str3 = this.form.model_adress[2];\n        str3 = str3.substring(0, 12);\n        this.form.xzqh = str3;\n      }\n\n      if (this.form.model_qudao.length == 0) {\n        this.form.qd = \"\";\n      }\n\n      if (this.form.model_qudao.length == 1) {\n        // var str4 = this.form.model_qudao[0];\n        // str4 = str4.substring(0, 5);\n        this.form.qd = this.form.model_qudao[0];\n      }\n\n      if (this.form.model_qudao.length == 2) {\n        // var str5 = this.form.model_qudao[1];\n        // str5 = str5.substring(0, 9);\n        this.form.qd = this.form.model_qudao[1];\n      } // this.axios.get('/guanqu/table/ST_JPG_H?_page_size='+this.list_input.pagesize+'&_page='+this.list_input.current+this.searchs,{params:{ADDVCD:this.form.xzqh,Canal_Code:this.form.qd}}).then((res)=>{\n      //     this.loading = false;\n      // });\n\n\n      this.axios.get(\"/guanqu/tuxiang/index?_page_size=\" + this.list_input.pagesize + \"&_page=\" + this.list_input.current + this.searchs, {\n        params: {\n          ADDVCD: this.form.xzqh,\n          Canal_Code: this.form.qd\n        }\n      }).then(function (res) {\n        _this.loading = false;\n        _this.data = res.data.rows;\n        _this.list_input.total = res.data.total;\n\n        for (var i = 0; i < _this.data.length; i++) {\n          _this.data[i].TM = _this.data[i].TM.replace(\".000\", \"\").replace(\"20\", \"\");\n        }\n\n        _this.data.forEach(function (val, index, array) {\n          var Image = \"http://v3.yingmen.vip/guanqu/gis/pic_content?id=\" + val.stcd;\n\n          _this.axios.get(\"/guanqu/tuxiang/details?STCD=\" + val.stcd).then(function (res) {\n            if (res.data.GUANLIAN_YAOSU.length != 0) {\n              val.GUANLIAN_YAOSU = res.data.GUANLIAN_YAOSU;\n            }\n          });\n\n          val.Image = Image;\n        });\n\n        console.log(\"关联要素\", _this.data);\n      });\n      this.axios.get(\"/guanqu/tuxiang/index?_page_size=99999\", {\n        params: {\n          ADDVCD: this.form.xzqh,\n          Canal_Code: this.form.qd\n        }\n      }).then(function (res) {\n        _this.STNMSlength = res.data.total;\n      });\n      this.getTableData_WRP_AD_B(function (data) {\n        _this.form.adressList = data;\n      }); // 获取输排水渠道数据,然后设置渠道选择框选项\n\n      this.getTableData_WRP_IrrBTCanalSystem(function (data) {\n        _this.form.qudaoList = data;\n      });\n    },\n    err: function err() {\n      this.$Message.warning(\"该功能还在开发中...\");\n    },\n    // 处理页码切换\n    CurrentChange: function CurrentChange(index) {\n      // console.log(index);\n      this.list_input.current = index;\n      this.Reload();\n    },\n    // 处理每页显示条数切换\n    PagesizeChange: function PagesizeChange(pagesize) {\n      // console.log(pagesize)\n      this.list_input.pagesize = pagesize;\n      this.Reload();\n    },\n    // 排序\n    sort_change_shuiqing: function sort_change_shuiqing() {},\n    // 执行闸阀控制\n    // koen 2019-8-2\n    run: function run() {\n      var _this2 = this;\n\n      //return;\n      this.run_button = true;\n      this.axios.put(\"/guanqu/zhafakongzhi/shishi\", {\n        KZKD: this.kz.OD,\n        STCD: this.kz.STCD\n      }).then(function (res) {\n        _this2.run_button = false;\n\n        _this2.$message({\n          message: '恭喜你，成功执行',\n          type: 'success'\n        });\n      });\n    },\n    //显示控制窗口\n    //koen 2019-8-2\n    show_details: function show_details(item) {\n      var _this3 = this;\n\n      console.log(item);\n      this.dialogTableVisible = true;\n      this.kz.OD = _parseFloat(item.rowinfo.OD);\n      this.kz.STCD = item.rowinfo.STCD;\n      this.kz.STNM = item.rowinfo.STNM;\n      this.kz.MAX = item.rowinfo.Strobe_Hight;\n      this.reload_h(); // this.shipin(this.kz.STCD);\n\n      this.details.rowinfo = item.rowinfo; // 获取详情数据\n\n      this.axios.get(\"/guanqu/gis/details?ID=\".concat(item.rowinfo.STCD, \"&pk=STCD\")).then(function (res) {\n        var details_data = res.data;\n        _this3.item = res.data;\n\n        if (!details_data.CSTYPE) {}\n\n        if (details_data.CSTYPE == 3) {\n          var video_iframe = document.getElementById(\"video\");\n          video_iframe.src = 'em-playvideo.html?61.187.248.226:8866' + ',' + details_data.PUID + ',' + details_data.IDX + ',' + details_data.STNM;\n        }\n\n        if (details_data.CSTYPE == 1) {\n          var video_iframe = document.getElementById(\"video\"); // details_data.WWWPath\n\n          video_iframe.src = details_data.WWWPath;\n        } //video_iframe.src = 'em-playvideo_detail.html?61.187.248.226:8866'+','+details_data.PUID+','+details_data.IDX+','+details_data.STNM\n\n\n        _this3.boxLoading = false;\n      });\n    },\n    // shipin(STCD){\n    //   this.axios.get('/guanqu/gis/details?ID='+STCD+'&pk=STCD').then(res => {\n    //     this.item = res.data;\n    //   });\n    // },\n    //定时刷新当前闸阀历史表\n    //以便观察控制是否成功\n    reload_h: function reload_h() {\n      var _this4 = this;\n\n      if (!this.dialogTableVisible) return; //var date = this.$App.xPointToNowOfTheDay(-72);\n      //var DTT = this.$FilterData.elDatePicker_Filter(date).split(\",\");\n\n      this.$GetData.Survey_History_ZFZT(\"historyTable\", {\n        STCD: this.kz.STCD,\n        //Time_min: `${DTT[1]}`,\n        //Time_max: `${DTT[2]}`,\n        _orderby: 'TM desc',\n        _page_size: 10\n      }, function (res) {\n        // console.log(res);\n        _this4.kz_lishi = res;\n\n        for (var i = 0; i < _this4.kz_lishi.length; i++) {\n          _this4.kz_lishi[i].UPZ = _this4.Z_Filter(_this4.kz_lishi[i].UPZ);\n          _this4.kz_lishi[i].DWZ = _this4.Z_Filter(_this4.kz_lishi[i].DWZ);\n        }\n\n        _this4.axios.post('/guanqu/zhafazhuangtai/gis', {\n          STCD: _this4.kz.STCD\n        }).then(function (res) {\n          _this4.item = res.data.features[0]; // console.log('++++++++++',this.item,this.kz_lishi[0])\n\n          _this4.drawchart(_this4.item.rowinfo.Strobe_Hight, _this4.kz_lishi[0].OD);\n        });\n      });\n    },\n    kaidulishibiao_init: function kaidulishibiao_init() {\n      var _this5 = this;\n\n      var body = new Object(); // 如果输入框有内容，添加站名过滤字段\n\n      if (this.form.search_str && new String(this.form.search_str).length != 0) {\n        body[\"STNM\"] = \"\".concat(this.form.search_str);\n      } else {} // body[\"STNM\"] = null;\n      // 如果地址选择框有内容，添加行政区划过滤字段\n\n\n      if (this.form.model_adress && this.form.model_adress.length != 0) {\n        body[\"ADDVCD\"] = \"\".concat(this.$App.ADDVCD_Array_Filter(this.form.model_adress));\n      } else {} // body[\"ADDVCD\"] = null;\n      // 如果渠道选择框有内容，添加渠道过滤字段\n\n\n      if (this.form.model_qudao && this.form.model_qudao.length != 0) {\n        body[\"Canal_Code\"] = \"\".concat(this.$App.Canal_Code_Array_Filter(this.form.model_qudao));\n      } else {} // body[\"Canal_Code\"] = null;\n      // 如果站点类型选择框有内容，添加行政区划过滤字段\n\n\n      if (this.form.model_site && this.form.model_site.length != 0) {\n        body[\"CTYPE\"] = this.form.model_site.join(\",\");\n      } else {// body[\"CTYPE\"] = null;\n      }\n\n      console.log(this.form.model_status1); // 如果状态选择框有内容，添加行政区划过滤字段\n\n      if (this.form.model_status1) {\n        body[\"_status\"] = this.form.model_status1.join(\",\");\n      } else {// body[\"_status\"] = null;\n      }\n\n      this.$GetData.getFeatrueLayer(\"zhafazhuangtai\", body, function (res) {\n        var data = res.data.features;\n        data = data.map(function (val) {\n          val.url = \"http://v3.yingmen.vip/guanqu/gis/pic_content?id=\".concat(val.rowinfo.STCD);\n          return val;\n        });\n        console.warn(\"data\", data);\n        _this5.table.SSXX.Rows = data;\n        _this5.counter.total = data.length;\n      });\n    }\n  },\n  destroyed: function destroyed() {\n    clearInterval(this.zk_Interval);\n  },\n  mounted: function mounted() {\n    var _this6 = this;\n\n    //启动定时刷新机制\n    this.zk_Interval = setInterval(function () {\n      _this6.reload_h();\n    }, 5000); // 获取行政区划数据,然后设置地址选择框选项\n\n    this.getTableData_WRP_AD_B(function (data) {\n      _this6.form.adressList = data;\n    }); // 获取输排水渠道数据,然后设置渠道选择框选项\n\n    this.getTableData_WRP_IrrBTCanalSystem(function (data) {\n      _this6.form.qudaoList = data;\n    });\n    this.kaidulishibiao_init();\n  }\n};",null]}