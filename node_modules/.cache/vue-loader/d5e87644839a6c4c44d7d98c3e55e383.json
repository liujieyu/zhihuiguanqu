{"remainingRequest":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work2022\\visualplace\\zhihuiguanqu\\src\\warm\\warm-water\\water-use\\usewater.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\src\\warm\\warm-water\\water-use\\usewater.vue","mtime":1645607966800},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\less-loader\\dist\\cjs.js","mtime":1642129565717},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.switch{\r\n  position: absolute;\r\n  right: 0;\r\n  top: 0;\r\n  height: 55px;\r\n  display: flex;\r\n  align-items: center;\r\n  background: white;\r\n  border-top-left-radius: 5px;\r\n  border-bottom-left-radius: 5px;\r\n  border: #7eb7f0 2px solid;\r\n  border-right: 0;\r\n}\r\n",{"version":3,"sources":["usewater.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"usewater.vue","sourceRoot":"src/warm/warm-water/water-use","sourcesContent":["<template>\r\n  <div>\r\n    <Content :style=\"{padding: '20px', background: '#fff'}\">\r\n      <Row :gutter=\"16\">\r\n        <Col :span=\"span1\">\r\n          <Row :gutter=\"16\" type=\"flex\" justify=\"start\" z style=\"margin-top: 10px;line-height: 32px;\">\r\n            <Col>\r\n              年份:\r\n                <Select v-model=\"form.year\" :clearable=\"false\" @on-change=\"Yearsearch\" style=\"width:100px;margin-left: 5px;margin-right: 20px;\">\r\n                    <Option\r\n                    v-for=\"obj in yearlist\"\r\n                    :key=\"obj.value\"\r\n                    :label=\"obj.label\"\r\n                    :value=\"obj.value\">\r\n                    </Option>\r\n                </Select>\r\n            </Col>\r\n            <Col>\r\n               <Button type=\"primary\" style=\"width: auto;margin-right: 10px;\" @click=\"exportExcel\">导出</Button> \r\n            </Col>\r\n            <Col>\r\n            </Col>\r\n            <Col>\r\n            </Col>\r\n            <Col> \r\n                       \r\n            </Col>\r\n          </Row>\r\n          <div class=\"switch\" @click=\"Menu_toggle\">\r\n            <i class=\"el-icon-d-arrow-left\" v-if=\"Menu.show_Controller\"></i>\r\n            <i class=\"el-icon-d-arrow-right\" v-if=\"!Menu.show_Controller\"></i>\r\n          </div>\r\n          <Divider/>\r\n          <Row>\r\n                <Col style='font-size: 14px;' class=\"borsLine\">支渠名称：{{STinfo.CANAL_NANME}}&nbsp;&nbsp;&nbsp;&nbsp;单位：用水量（万m³）&nbsp;&nbsp;用水率（%）</Col>\r\n           </Row>\r\n          <Row :gutter=\"24\" style=\"display: flex;\">\r\n            <Col style=\"width:100%;\">\r\n              <el-table\r\n              :data=\"data1\"\r\n              border\r\n              height=\"156\"\r\n              v-loading=\"loading\"\r\n              style=\"width: 100%;\">\r\n                <el-table-column v-for=\"(column, index) in columns\" :prop=\"column.value\" :label=\"column.text\" :min-width=\"column.minwidth\" :fixed=\"column.fixed\" :align=\"column.algin\" :key=\"Math.random()\">\r\n                </el-table-column>\r\n              </el-table>\r\n            <div ref=\"achart\" :style=\"{'width': '100%','height': (theight-120)+'px','margin-top':'5px'}\"></div> \r\n            </Col>\r\n          </Row>\r\n        </Col>\r\n        <transition name=\"el-fade-in-linear\">\r\n        <Col :span=\"span2\" v-show=\"show1\">\r\n        <Row>\r\n          <Input search enter-button suffix=\"ios-search\" placeholder=\"请输入站名\" style=\"width: auto;margin-left: 20px;\" @on-search=\"search\" v-model=\"searchmsg\" />    \r\n          </Row>\r\n          <Row style=\"margin-top: 10px;margin-left: 20px;\">\r\n            <Col :style=\"{'height': (theight+125)+'px','overflow-y': 'auto'}\">\r\n              <el-tree\r\n                class=\"filter-tree\"\r\n                :data=\"Treedata\"\r\n                :props=\"defaultProps\"\r\n                highlight-current=\"true\"\r\n                @node-click=\"type_tree\"\r\n                node-key=\"ID\"\r\n               :default-expanded-keys=\"keys\"\r\n                ref=\"tree\">\r\n              </el-tree>\r\n            </Col>\r\n          </Row>\r\n        </Col>\r\n      </transition>\r\n      </Row>\r\n    </Content>\r\n  </div>\r\n</template>\r\n<script type=\"text/javascript\">\r\nimport FilterMethods from \"@/assets/commonJS/FilterMethods\";\r\nexport default {\r\n        data() {\r\n        return {\r\n            loading:false,\r\n            show1:true,\r\n            span1:'19',\r\n            span2:'5',\r\n            theight:window.innerHeight-370,\r\n            searchmsg:'',\r\n            Treedata: [],\r\n            defaultProps: {\r\n                children: 'children',\r\n                label: 'CANAL_NANME'\r\n              },\r\n            keys:[],\r\n            data1: [],\r\n            yearlist:[],\r\n            STinfo:{},\r\n            Menu: { show_Controller: false },\r\n                form:{\r\n                    year:'',\r\n                }, \r\n            columns: [\r\n        {\r\n          text: \"名称\",\r\n          value: \"STNM\",\r\n          minwidth: 100,\r\n          fixed:\"left\",\r\n          algin:\"center\",\r\n        },\r\n        {\r\n          text: \"一月\",\r\n          value: \"ONE\",\r\n          minwidth: 80, \r\n          algin:\"center\",\r\n        },\r\n        {\r\n          text: \"二月\",\r\n          value: \"TWO\",\r\n          minwidth: 80,\r\n          algin:\"center\",\r\n        },\r\n        {\r\n          text: \"三月\",\r\n          value: \"THREE\",\r\n          minwidth: 80,\r\n          algin:\"center\",\r\n        },\r\n        {\r\n          text: \"四月\",\r\n          value: \"FOUR\",\r\n          minwidth: 80,\r\n          algin:\"center\",\r\n        },\r\n        {\r\n          text: \"五月\",\r\n          value: \"FIVE\",\r\n          minwidth: 80,\r\n          algin:\"center\",\r\n        },\r\n        {\r\n          text: \"六月\",\r\n          value: \"SIX\",\r\n          minwidth: 80,\r\n          algin:\"center\",\r\n        },\r\n        {\r\n          text: \"七月\",\r\n          value: \"SEVEN\",\r\n          minwidth: 80,\r\n          algin:\"center\",\r\n        },\r\n        {\r\n          text: \"八月\",\r\n          value: \"EIGHT\",\r\n          minwidth: 80,\r\n          algin:\"center\",\r\n        },\r\n        {\r\n          text: \"九月\",\r\n          value: \"NINE\",\r\n          minwidth: 80,\r\n          algin:\"center\",\r\n        },\r\n        {\r\n          text: \"十月\",\r\n          value: \"TEN\",\r\n          minwidth: 80,\r\n          algin:\"center\",\r\n        },\r\n        {\r\n          text: \"十一月\",\r\n          value: \"ELEVEN\",\r\n          minwidth: 80,\r\n          algin:\"center\",\r\n        },\r\n        {\r\n          text: \"十二月\",\r\n          value: \"TWELVE\",\r\n          minwidth: 80,\r\n          algin:\"center\",\r\n        },\r\n        {\r\n          text: \"年度总计\",\r\n          value: \"SUMW\",\r\n          minwidth: 100,\r\n          fixed:\"right\",\r\n          algin:\"center\",\r\n        },\r\n      ],\r\n      data: []\r\n        };\r\n      },\r\n      // 引入过滤方法到此组件\r\n      mixins: [FilterMethods],\r\n      mounted() {\r\n            //年份\r\n            var now=new Date();\r\n            var year=now.getFullYear();\r\n            for(var i=0;i<10;i++){\r\n                var yobj=new Object();\r\n                yobj.value=year-i;\r\n                yobj.label=(year-i)+'年';\r\n                this.yearlist.push(yobj);\r\n            }\r\n            this.form.year=year;\r\n            this.axios.get('/waterplan/managetree',{params:{canalname:this.searchmsg}}).then(res => {\r\n              debugger;\r\n              var root=res.data.tree;\r\n              var keyarry=[];\r\n              if(root.children.length>0){\r\n              keyarry.push(root.ID,root.children[0].ID,root.children[0].children[0].ID);\r\n              }\r\n              this.Treedata.push(root);\r\n              this.keys=keyarry;\r\n              if(root.children.length>0){\r\n              this.STinfo=root.children[0].children[0];\r\n              }\r\n              this.Reload();\r\n            });\r\n      },\r\n      methods: {\r\n         Menu_toggle() {\r\n          this.Menu.show_Controller = !this.Menu.show_Controller;\r\n          this.show1 = !this.show1;\r\n          if (this.show1 == true ) {\r\n            this.span1 = '19';\r\n            this.span2 = '5';\r\n            this.data2 = {};\r\n          }else{\r\n            this.span1 = '24';\r\n            this.span2 = '0';\r\n            this.data2 = {}\r\n          }\r\n          this.Reload();\r\n        },\r\n          Reload(){\r\n              let obj = {\r\n                  organCode:this.STinfo.CANAL_CODE,\r\n                  year:this.form.year\r\n              };\r\n              this.loading = true;\r\n              this.axios.get('/waterplan/useinfo',{params:obj}).then((res)=>{                \r\n                    this.data1 = res.data;\r\n                    this.loading = false;\r\n                    var echartData = {\r\n                        x: new Object(),\r\n                        y1: new Object(),\r\n                        y2: new Object(),\r\n                        y3: new Object()\r\n                    }\r\n                    var quota=res.data[0];\r\n                    var real=res.data[1];\r\n                    var usel=res.data[2];\r\n                    echartData.x.list=['1月','2月','3月','4月','5月','6月','7月','8月','9月','10月','11月','12月'];\r\n                    echartData.y1.list=[quota[\"ONE\"],quota[\"TWO\"],quota[\"THREE\"],quota[\"FOUR\"],quota[\"FIVE\"],quota[\"SIX\"],quota[\"SEVEN\"],quota[\"EIGHT\"],quota[\"NINE\"],quota[\"TEN\"],quota[\"ELEVEN\"],quota[\"TWELVE\"]];\r\n                    echartData.y2.list=[real[\"ONE\"],real[\"TWO\"],real[\"THREE\"],real[\"FOUR\"],real[\"FIVE\"],real[\"SIX\"],real[\"SEVEN\"],real[\"EIGHT\"],real[\"NINE\"],real[\"TEN\"],real[\"ELEVEN\"],real[\"TWELVE\"]];\r\n                    echartData.y3.list=[parseFloat(usel[\"ONE\"]).toFixed(1),parseFloat(usel[\"TWO\"]).toFixed(1),parseFloat(usel[\"THREE\"]).toFixed(1),parseFloat(usel[\"FOUR\"]).toFixed(1),parseFloat(usel[\"FIVE\"]).toFixed(1),parseFloat(usel[\"SIX\"]).toFixed(1),parseFloat(usel[\"SEVEN\"]).toFixed(1),parseFloat(usel[\"EIGHT\"]).toFixed(1),parseFloat(usel[\"NINE\"]).toFixed(1),parseFloat(usel[\"TEN\"]).toFixed(1),parseFloat(usel[\"ELEVEN\"]).toFixed(1),parseFloat(usel[\"TWELVE\"]).toFixed(1)];\r\n                    var max1=0,max2=100;\r\n                    for(var i=0;i<12;i++){\r\n                      if(echartData.y1.list[i]>max1){\r\n                        max1=echartData.y1.list[i];\r\n                      }\r\n                      if(echartData.y2.list[i]>max1){\r\n                        max1=echartData.y2.list[i];\r\n                      }\r\n                      if(parseFloat(echartData.y3.list[i])>max2){\r\n                        max2=parseFloat(echartData.y3.list[i]);\r\n                      }\r\n                    }\r\n                    let maxint = Math.ceil(max1 / 9.8);\r\n                    echartData.y1.max=maxint * 10;\r\n                    let maxint2=Math.ceil(max2 / 9.8);\r\n                    echartData.y3.max=maxint2*10;\r\n                    this.drawchart(echartData);\r\n                });\r\n          },\r\n          type_tree(data){\r\n            if (data.ID >100) {\r\n              this.STinfo = data;\r\n              this.Reload();             \r\n            }\r\n          },\r\n          search(){\r\n            this.Treedata=[];\r\n            this.axios.get('/waterplan/managetree',{params:{canalname:this.searchmsg}}).then(res => {\r\n              var root=res.data.tree;\r\n              var keyarry=[];\r\n              keyarry.push(root.ID,root.children[0].ID,root.children[0].children[0].ID);\r\n              this.Treedata.push(root);\r\n              this.keys=keyarry;\r\n              this.STinfo=root.children[0].children[0];\r\n              this.Reload();\r\n            });\r\n          },\r\n          exportExcel(){\r\n               var params='year='+this.form.year+'&organCode='+this.STinfo.CANAL_CODE+'&canalname='+this.STinfo.CANAL_NANME;\r\n                window.location.href='/excel/exportusewater?'+params; \r\n          },\r\n          drawchart(echartData) {\r\n            var achart = this.$echarts.init(this.$refs.achart);\r\n            console.log(achart);\r\n            achart.resize();\r\n            achart.setOption({\r\n    tooltip: {\r\n            trigger: \"axis\",\r\n          },\r\n    color:['#FF4000','#2A93FC','#027802'],\r\n    legend: {\r\n        data:['用水定额','实际用水','用水率']\r\n    },\r\n    grid: {  \r\n                left: '1%',   //图表距边框的距离\r\n                right: '1%',\r\n                bottom:'1%',\r\n                containLabel: true\r\n            },\r\n    xAxis: [\r\n        {\r\n            type: 'category',\r\n            data: echartData.x.list,\r\n            axisLabel:{interval:0}\r\n        }\r\n    ],\r\n    yAxis: [\r\n        {\r\n            type: 'value',\r\n            name: ' 用水量(万m³)',\r\n            min: 0,\r\n            max: echartData.y1.max,\r\n            splitNumber: 5,\r\n            interval: echartData.y1.max/5,\r\n\r\n        },\r\n        {\r\n            type: 'value',\r\n            name: '百分比(%)',\r\n            min: 0,\r\n            max: echartData.y3.max,\r\n            splitNumber: 5,\r\n            interval: echartData.y3.max/5,\r\n\r\n        }\r\n    ],\r\n    series: [\r\n        {\r\n            name:'用水定额',\r\n            type:'bar',\r\n            barGap: 0,\r\n            data:echartData.y1.list\r\n        },\r\n        {\r\n            name:'实际用水',\r\n            type:'bar',\r\n            data:echartData.y2.list\r\n        },\r\n        {\r\n            name:'用水率',\r\n            type:'line',\r\n            yAxisIndex: 1,\r\n            data:echartData.y3.list\r\n        }\r\n    ]\r\n});\r\n       },\r\n       },\r\n      components: {   \r\n      }\r\n    }\r\n</script>\r\n<style type=\"text/css\" lang=\"less\">\r\n.switch{\r\n  position: absolute;\r\n  right: 0;\r\n  top: 0;\r\n  height: 55px;\r\n  display: flex;\r\n  align-items: center;\r\n  background: white;\r\n  border-top-left-radius: 5px;\r\n  border-bottom-left-radius: 5px;\r\n  border: #7eb7f0 2px solid;\r\n  border-right: 0;\r\n}\r\n</style>"]}]}