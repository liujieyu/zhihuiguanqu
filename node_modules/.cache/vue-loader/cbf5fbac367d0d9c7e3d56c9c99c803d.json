{"remainingRequest":"D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\huangcaiplace\\zhihuiguanqu\\src\\components\\Details\\Details-tuxiangzhan.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\huangcaiplace\\zhihuiguanqu\\src\\components\\Details\\Details-tuxiangzhan.vue","mtime":1577669404027},{"path":"D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\huangcaiplace\\zhihuiguanqu\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { setTimeout } from \"timers\";\r\nimport FilterMethods from \"../../assets/commonJS/FilterMethods\"; // 过滤方法\r\nimport GetDataMethods from \"../../assets/commonJS/GetDataMethods\"; // 获取数据方法\r\nimport { timingSafeEqual } from \"crypto\";\r\nexport default {\r\n  props: {\r\n    info: {}\r\n  },\r\n  data() {\r\n    return {\r\n      //\r\n      activeName: \"tuxiang\",\r\n      siteInfo: {},\r\n      //   多选框对象\r\n      checkBox: {\r\n        shuiqingList: [\r\n          {\r\n            value: \"historyTable\",\r\n            size: \"large\",\r\n            // iconType: \"logo-facebook\",\r\n            title: \"历史表\"\r\n          },\r\n          {\r\n            value: \"hourTable\",\r\n            size: \"large\",\r\n            // iconType: \"logo-facebook\",\r\n            title: \"小时表\"\r\n          },\r\n          {\r\n            value: \"dayTable\",\r\n            size: \"large\",\r\n            // iconType: \"logo-facebook\",\r\n            title: \"日表\"\r\n          },\r\n          {\r\n            value: \"nightTable\",\r\n            size: \"large\",\r\n            // iconType: \"logo-facebook\",\r\n            title: \"月表\"\r\n          }\r\n        ],\r\n        // 水情多选框绑定值\r\n        shuiqing_social: [\"historyTable\", \"hourTable\", \"dayTable\", \"nightTable\"]\r\n      },\r\n      //   选择框对象\r\n      select: {\r\n        searchList: [\r\n          {\r\n            value: \"quick\",\r\n            label: \"快速查询\"\r\n          },\r\n          {\r\n            value: \"vague\",\r\n            label: \"模糊查询\"\r\n          }\r\n        ]\r\n      },\r\n      // 表格数据\r\n      table: {\r\n        // 图像\r\n        tuxiang: {\r\n          // 日期时间选择器的选项配置\r\n          datePickerOptions: {\r\n            shortcuts: [\r\n              {\r\n                text: \"最近6小时\",\r\n                onClick(picker) {\r\n                  const end = new Date();\r\n                  const start = new Date();\r\n                  start.setTime(start.getTime() - 3600 * 1000 * 6);\r\n                  picker.$emit(\"pick\", [start, end]);\r\n                }\r\n              },\r\n              {\r\n                text: \"最近12小时\",\r\n                onClick(picker) {\r\n                  const end = new Date();\r\n                  const start = new Date();\r\n                  start.setTime(start.getTime() - 3600 * 1000 * 12);\r\n                  picker.$emit(\"pick\", [start, end]);\r\n                }\r\n              },\r\n              {\r\n                text: \"最近24小时\",\r\n                onClick(picker) {\r\n                  const end = new Date();\r\n                  const start = new Date();\r\n                  start.setTime(start.getTime() - 3600 * 1000 * 24);\r\n                  picker.$emit(\"pick\", [start, end]);\r\n                }\r\n              },\r\n              {\r\n                text: \"最近36小时\",\r\n                onClick(picker) {\r\n                  const end = new Date();\r\n                  const start = new Date();\r\n                  start.setTime(start.getTime() - 3600 * 1000 * 36);\r\n                  picker.$emit(\"pick\", [start, end]);\r\n                }\r\n              },\r\n              {\r\n                text: \"最近72小时\",\r\n                onClick(picker) {\r\n                  const end = new Date();\r\n                  const start = new Date();\r\n                  start.setTime(start.getTime() - 3600 * 1000 * 72);\r\n                  picker.$emit(\"pick\", [start, end]);\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          // 日期时间选择器类型\r\n          datePickerType: \"datetimerange\",\r\n          // 日期时间选择器值\r\n          date: null,\r\n          // 表格是否加载中\r\n          loading: false,\r\n          // 当前页\r\n          currentPage: 1,\r\n          // 每页显示数量\r\n          pageSizes: 20,\r\n          // 总条数\r\n          total: true,\r\n          Rows: [\r\n            // {\r\n            //   url: `/guanqu/gis/pic_content?id=${info.STCD}`\r\n            // },\r\n            // {\r\n            //   url: `/guanqu/gis/pic_content?id=${info.STCD}`\r\n            // },\r\n            // {\r\n            //   url: `/guanqu/gis/pic_content?id=${info.STCD}`\r\n            // },\r\n            // {\r\n            //   url: `/guanqu/gis/pic_content?id=${info.STCD}`\r\n            // },\r\n          ]\r\n        }\r\n      },\r\n      //   日期数据\r\n      date: {\r\n        shuiqing: \"\"\r\n      },\r\n      // 输入框对象\r\n      input: {\r\n        // 关系曲线换算的\r\n        huansuan: {\r\n          waterLever: \"\",\r\n          flowLever: \"\"\r\n        }\r\n      },\r\n      //   列表对象\r\n      list: {\r\n        imageList: [\r\n          {\r\n            imgUrl: \"img/shuizha.9d256eb4.jpg\"\r\n          }\r\n        ]\r\n      },\r\n      //   导出按钮加载控制\r\n      outPutLoading: false,\r\n      //   导出确认对话框控制\r\n      outPutModal: false,\r\n      // 区域加载控制\r\n      boxLoading: false\r\n    };\r\n  },\r\n  mixins: [FilterMethods, GetDataMethods],\r\n  methods: {\r\n    handleSizeChange() {},\r\n    handleCurrentChange() {},\r\n    //   导出站点信息\r\n    outPutSiteInfo() {\r\n      //   关闭导出确认对话框\r\n      this.outPutModal = false;\r\n      //   按钮加载\r\n      this.outPutLoading = true;\r\n      setTimeout(() => {\r\n        this.outPutLoading = false;\r\n        this.$Modal.success({\r\n          title: \"关于导出\",\r\n          content: \"站点信息表导出成功\"\r\n        });\r\n      }, 500);\r\n    },\r\n    //   确认导出\r\n    outPutSure() {\r\n      this.outPutSiteInfo();\r\n    },\r\n    // 搜索\r\n    search() {\r\n      // 表格加载中\r\n      this.table.loading = true;\r\n      setTimeout(() => {\r\n        // var newList = this.featrue.Rows.map((val, index) => {\r\n        //   return val.attributes;\r\n        // });\r\n\r\n        // this.table.Rows = newList;\r\n        // 取消表格加载\r\n        this.table.loading = false;\r\n      }, 1000);\r\n    },\r\n    // 加载表格数据\r\n    loadTableData(list, data) {\r\n      this.table[list].Rows = data;\r\n    },\r\n    // 加载站点数据\r\n    loadSiteData(data) {\r\n      this.siteInfo = data;\r\n    },\r\n    // 根据行政区划编码获取行政区划\r\n    getCompartmentByADDVCD(callback) {\r\n      var ADDVCD = this.info.rowinfo.ADDVCD;\r\n      if (ADDVCD && ADDVCD != \"\") {\r\n        this.axios\r\n          .get(`/guanqu/admin/WRP_AD_B`, {\r\n            params: {\r\n              AD_CD: ADDVCD\r\n            }\r\n          })\r\n          .then(res => {\r\n            var data = res.data.rows;\r\n            if (typeof callback == \"function\") {\r\n              callback(data);\r\n            }\r\n          });\r\n      }\r\n    },\r\n    // 查询历史图像数据\r\n    search_tuxiang() {\r\n      this.$TableMethods.tableLoading(this.table.tuxiang);\r\n\r\n      // 传递站码参数\r\n      var body = {\r\n        STCD: this.siteInfo.STCD,\r\n        _page: this.table.tuxiang.currentPage,\r\n        _page_size: this.table.tuxiang.pageSizes,\r\n        _orderby: `TM desc`\r\n      };\r\n\r\n      // 如果有选择日期进行查询，根据表格类型传递参数\r\n      if (this.table.tuxiang.date) {\r\n        var DTT = this.$FilterData\r\n              .elDatePicker_Filter(this.table.tuxiang.date, \"include_seconds\")\r\n              .split(\",\");\r\n            body.Time_min = DTT[1];\r\n            body.Time_max = DTT[2];\r\n      }\r\n\r\n      this.$GetData.Survey_History_TX(body, true, data => {\r\n        this.$TableMethods.setTableTotal(this.table.tuxiang, data.total);\r\n        this.$TableMethods.setTableData(this.table.tuxiang, data.data);\r\n        this.$TableMethods.cancelTableLoading(this.table.tuxiang);\r\n      });\r\n    },\r\n    // 处理页码切换_图像\r\n    handleCurrentChange_tuxiang(index) {\r\n      this.table[\"tuxiang\"].currentPage = index;\r\n      this.search_tuxiang();\r\n    },\r\n    // 处理每页显示条数切换_水情数据\r\n    handleSizeChange_tuxiang(pageSizes) {\r\n      this.table[\"tuxiang\"].pageSizes = pageSizes;\r\n      this.table[\"tuxiang\"].currentPage = 1;\r\n      this.search_tuxiang();\r\n    },\r\n    // 设置图像历史表默认查询日期\r\n    setTableDefaultDate_tuxiang() {\r\n      const end = new Date();\r\n      const start = zeroPointOfTheDay();\r\n      var timeSlot = [start, end];\r\n      this.table.tuxiang.date = timeSlot;\r\n      // this.setTableDate(\"tuxiang\", timeSlot);\r\n\r\n      function zeroPointOfTheDay() {\r\n        var date = new Date();\r\n        date.setHours(0);\r\n        date.setMinutes(0);\r\n        date.setSeconds(0);\r\n        date.setMilliseconds(0);\r\n        return date;\r\n      }\r\n    },\r\n    // 处理日期时间选择器确定事件_图像\r\n    handleDatePickerChange_tuxiang(item) {\r\n      this.table.tuxiang.currentPage = 1;\r\n      this.search_tuxiang();\r\n    },\r\n    // 设置 xx表格 时间选择器值\r\n    setTableDate(tableName, val) {\r\n      this.table[tableName].date = val;\r\n    },\r\n  },\r\n\r\n  mounted() {\r\n    // //设置默认时间\r\n    // var newdate = new Array();\r\n    // var end = new Date();\r\n    // var start = new Date();\r\n    // var Month = start.getMonth()+1;\r\n    // newdate[0] = start.getFullYear()+'-'+Month+'-'+start.getDate()+' 00:00:00.000';\r\n    // newdate[1] = end;\r\n    // this.table.tuxiang.date = newdate;\r\n\r\n    // 区域加载中\r\n    this.boxLoading = true;\r\n    // console.log(\"图像\",this.info)\r\n    this.getCompartmentByADDVCD(data => {\r\n      this.siteInfo.AD_NM = data[0].AD_NM;\r\n    });\r\n\r\n    // 根据河流编码获取河流名\r\n    this.$GetData.Base_R_I(\r\n      {\r\n        RVCD: this.info.rowinfo.RVCD\r\n      },\r\n      true,\r\n      data => {\r\n        this.siteInfo.RVCD = data.data[0].RVNM;\r\n      }\r\n    );\r\n\r\n    // 根据流域编码获取流域名\r\n    this.$GetData.Base_B_I(\r\n      {\r\n        CTCD: this.info.rowinfo.CTCD\r\n      },\r\n      true,\r\n      data => {\r\n        this.siteInfo.CTCD = data.data[0].CTNM;\r\n      }\r\n    );\r\n\r\n\r\n    // 获取详情数据\r\n    this.loadSiteData(this.info);\r\n\r\n    setTimeout(() => {\r\n      this.boxLoading = false;\r\n    }, 500);\r\n\r\n    // 设置图像历史表默认查询日期\r\n    this.setTableDefaultDate_tuxiang();\r\n    // 查询图像历史表数据\r\n    this.search_tuxiang();\r\n    // this.axios.get(`/guanqu/gis/details?ID=${this.info.ID}`).then(res => {\r\n    //   // 加载站点数据\r\n    //   // this.loadSiteData(res.data);\r\n\r\n    //   // 加载取消\r\n    //   this.boxLoading = false;\r\n    // });\r\n  }\r\n};\r\n",null]}