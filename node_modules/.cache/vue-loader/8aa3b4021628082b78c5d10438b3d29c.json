{"remainingRequest":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work2022\\visualplace\\zhihuiguanqu\\src\\warm\\warm-caculate\\metype-caculate\\caculate.vue?vue&type=style&index=0&id=01f8e466&lang=less&scoped=true&","dependencies":[{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\src\\warm\\warm-caculate\\metype-caculate\\caculate.vue","mtime":1646183853903},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\less-loader\\dist\\cjs.js","mtime":1642129565717},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nhtml, body {\r\n    width: 100%;\r\n    height: 100%;\r\n}\r\n.table_show {\r\n font-size: 14px;\r\n border:1px solid #C7CCD6;\r\n border-collapse:collapse; \r\n td {\r\n    height: 45px;\r\n    border-top: none;\r\n    border:1px solid #C7CCD6;\r\n  }\r\n\r\n  .dt_name {\r\n    width: 10%;\r\n    text-align: right;\r\n  }\r\n\r\n  .dt_vale {\r\n    width: 15%;\r\n    text-align: center;\r\n  }\r\n}\r\n",{"version":3,"sources":["caculate.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkhBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"caculate.vue","sourceRoot":"src/warm/warm-caculate/metype-caculate","sourcesContent":["<template>\r\n  <div>\r\n    <Content :style=\"{padding: '20px', background: '#fff'}\">\r\n      <Row :gutter=\"16\">\r\n          <Col span=\"19\">\r\n          <div ref=\"div1\">\r\n              <Row style=\"margin-bottom:20px;\">\r\n              <p style=\"color:#464c5b;font-weight:bold;font-size:15px;width:100%;text-align:center;\">{{STinfo.STNM}}标准断面水位流量计算</p>\r\n              </Row>\r\n              <Row>\r\n                  <table  cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" class=\"table_show\">\r\n                  <tr>\r\n                      <td class=\"dt_name\">所属渠道：</td><td class=\"dt_vale borderright\">{{STinfo.CANAL_NAME}}</td>\r\n                      <td class=\"dt_name\">渠底宽度：</td><td class=\"dt_vale borderright\">{{Titileinfo.B}}</td>\r\n                      <td class=\"dt_name\">边坡系数：</td><td class=\"dt_vale borderright\">{{Titileinfo.M}}</td>\r\n                      <td class=\"dt_name\">底坡：</td><td class=\"dt_vale\">{{Titileinfo.I}}</td>\r\n                  </tr>\r\n                  <tr>\r\n                      <td class=\"dt_name\">断面类型：</td><td class=\"dt_vale borderright\">{{Titileinfo.TYPENAME}}</td>\r\n                      <td class=\"dt_name\">最大水深：</td><td class=\"dt_vale borderright\">{{Titileinfo.MAX_Z}}m</td>\r\n                      <td class=\"dt_name\">最大流量：</td><td class=\"dt_vale borderright\">{{Titileinfo.MAX_Q}}m³/s</td>\r\n                      <td class=\"dt_name\"></td><td class=\"dt_vale\"></td>\r\n                  </tr>\r\n                  </table>\r\n              </Row>\r\n              <Row style=\"margin-top:20px;\">\r\n                  <el-form ref=\"formb\" :model=\"formb\" label-width=\"100px\" size=\"small\" :style=\"{'margin-left':marginleft+'px'}\">\r\n                    <el-form-item label=\"测流年份：\" :rules=\"[{ required: true, message: '测流不能为空'}]\">\r\n                        <el-date-picker\r\n                            style=\"width: 200px;\"\r\n                            v-model=\"formb.tm\"\r\n                            format=\"yyyy年\"\r\n                            value-format=\"yyyy\"\r\n                            type=\"year\"\r\n                            size=\"small\"\r\n                            @change=\"timechange\"\r\n                            :clearable=\"false\"></el-date-picker>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"糙率：\">\r\n                      <Input v-model=\"Titileinfo.N\" :value=\"Titileinfo.N\" clearable style=\"width: 200px;margin-right:5px;\"/>\r\n                      <Button  type=\"primary\"  @click=\"onUpdateCl\" >修改</Button>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"水深：\" :rules=\"[{ required: true, message: '水深不能为空'}]\">\r\n                        <Input v-model=\"formb.z\" :value=\"formb.z\" clearable style=\"width: 200px;\" @on-change=\"clearq(1)\"/>m\r\n                    </el-form-item>\r\n                    <el-form-item label=\"流量：\" :rules=\"[{ required: true, message: '流量不能为空'}]\">\r\n                        <Input v-model=\"formb.q\" :value=\"formb.q\" clearable style=\"width: 200px;\" readonly/>m³/s\r\n                    </el-form-item>\r\n                  <el-form-item >\r\n                    <Button  type=\"primary\"  @click=\"onCaculate(1)\" >计算</Button>\r\n                    <Button  type=\"primary\"  @click=\"onSave(1)\" style=\"margin-left:20px;\" >保存</Button>\r\n                </el-form-item>\r\n                 </el-form>\r\n              </Row>\r\n          </div>\r\n          <div ref=\"div2\" style=\"display:none;\">\r\n            <Row style=\"margin-bottom:20px;\">\r\n              <p style=\"color:#464c5b;font-weight:bold;font-size:15px;width:100%;text-align:center;\">{{STinfo.STNM}}巴歇尔槽水位流量计算</p>\r\n              </Row>\r\n              <Row>\r\n                  <table  cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" class=\"table_show\">\r\n                  <tr>\r\n                      <td class=\"dt_name\">所属渠道：</td><td class=\"dt_vale borderright\">{{STinfo.CANAL_NAME}}</td>\r\n                      <td class=\"dt_name\" style=\"width:15%;\">巴歇尔槽型号：</td><td class=\"dt_vale borderright\" style=\"width:10%;\">{{Titileinfo.MODEL}}号</td>\r\n                      <td class=\"dt_name\">最大水深：</td><td class=\"dt_vale borderright\">{{Titileinfo.MAX_Z}}</td>\r\n                      <td class=\"dt_name\">最大测流：</td><td class=\"dt_vale\">{{Titileinfo.MAX_Q}}</td>\r\n                  </tr>\r\n                  </table>\r\n              </Row>\r\n              <Row style=\"margin-top:20px;\">\r\n                  <el-form ref=\"formx\" :model=\"formx\" label-width=\"100px\" size=\"small\" :style=\"{'margin-left':marginleft+'px'}\">\r\n                    <el-form-item label=\"测流年份：\" :rules=\"[{ required: true, message: '测流不能为空'}]\">\r\n                        <el-date-picker\r\n                            style=\"width: 200px;\"\r\n                            v-model=\"formx.tm\"\r\n                            type=\"year\"\r\n                            format=\"yyyy年\"\r\n                            value-format=\"yyyy\"\r\n                            size=\"small\"\r\n                            :clearable=\"false\"></el-date-picker>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"水深：\" :rules=\"[{ required: true, message: '水深不能为空'}]\">\r\n                        <Input v-model=\"formx.z\" :value=\"formx.z\" clearable style=\"width: 200px;\" @on-change=\"clearq(2)\"/>m\r\n                    </el-form-item>\r\n                    <el-form-item label=\"流量：\" :rules=\"[{ required: true, message: '流量不能为空'}]\">\r\n                        <Input v-model=\"formx.q\" :value=\"formx.q\" clearable style=\"width: 200px;\" readonly/>m³/s\r\n                    </el-form-item>\r\n                  <el-form-item >\r\n                    <Button  type=\"primary\"  @click=\"onCaculate(2)\" >计算</Button>\r\n                    <Button  type=\"primary\"  @click=\"onSave(2)\" style=\"margin-left:20px;\" >保存</Button>\r\n                </el-form-item>\r\n                 </el-form>\r\n              </Row>\r\n          </div>\r\n          <div ref=\"div3\" style=\"display:none;\">\r\n            <Row style=\"margin-bottom:20px;\">\r\n              <p style=\"color:#464c5b;font-weight:bold;font-size:15px;width:100%;text-align:center;\">{{STinfo.STNM}}水闸水位流量计算</p>\r\n              </Row>\r\n              <Row>\r\n                  <table cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" class=\"table_show\">\r\n                  <tr>\r\n                      <td class=\"dt_name\">所属渠道：</td><td class=\"dt_vale borderright\">{{STinfo.CANAL_NAME}}</td>\r\n                      <td class=\"dt_name\">水闸类型：</td><td class=\"dt_vale borderright\">{{Titileinfo.SLTP}}</td>\r\n                      <td class=\"dt_name\">水闸宽度：</td><td class=\"dt_vale borderright\">{{Titileinfo.GTHLNTWD}}</td>\r\n                      <td class=\"dt_name\">最大开度：</td><td class=\"dt_vale\">{{Titileinfo.GATE_HI}}</td>\r\n                  </tr>\r\n                  <tr>\r\n                      <td class=\"dt_name\">闸前最大水深：</td><td class=\"dt_vale borderright\">{{Titileinfo.Z_MAX_F}}m</td>\r\n                      <td class=\"dt_name\">闸前最大流量：</td><td class=\"dt_vale borderright\">{{Titileinfo.Q_MAX_F}}m³/s</td>\r\n                      <td class=\"dt_name\">闸后最大水深：</td><td class=\"dt_vale borderright\">{{Titileinfo.Z_MAX_B}}m</td>\r\n                      <td class=\"dt_name\">闸后最大流量：</td><td class=\"dt_vale\">{{Titileinfo.Q_MAX_B}}m³/s</td>\r\n                  </tr>\r\n                  </table>\r\n              </Row>\r\n              <Row style=\"margin-top:20px;\">\r\n                  <el-form ref=\"forms\" :model=\"forms\" label-width=\"100px\" size=\"small\" :style=\"{'margin-left':marginleft+'px'}\">\r\n                    <el-form-item label=\"测流年份：\" :rules=\"[{ required: true, message: '测流不能为空'}]\" >\r\n                        <el-date-picker\r\n                            style=\"width: 200px;\"\r\n                            v-model=\"forms.tm\"\r\n                            value-format=\"yyyy\"\r\n                            type=\"year\"\r\n                            format=\"yyyy年\"\r\n                            size=\"small\"\r\n                            :clearable=\"false\"></el-date-picker>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"闸前水深：\" :rules=\"[{ required: true, message: '闸前水深不能为空'}]\">\r\n                        <Input v-model=\"forms.fz\" :value=\"forms.fz\" clearable style=\"width: 200px;\" @on-change=\"clearq(3)\"/>m\r\n                    </el-form-item>\r\n                    <el-form-item label=\"闸后水深：\" :rules=\"[{ required: true, message: '闸后水深不能为空'}]\">\r\n                        <Input v-model=\"forms.bz\" :value=\"forms.bz\" clearable style=\"width: 200px;\" @on-change=\"clearq(3)\"/>m\r\n                    </el-form-item>\r\n                    <el-form-item label=\"闸门开度：\" :rules=\"[{ required: true, message: '闸门开度不能为空'}]\">\r\n                        <Input v-model=\"forms.hi\" :value=\"forms.hi\" clearable style=\"width: 200px;\"/>m\r\n                    </el-form-item>\r\n                    <el-form-item label=\"流量：\" :rules=\"[{ required: true, message: '流量不能为空'}]\">\r\n                        <Input v-model=\"forms.q\" :value=\"forms.q\" clearable style=\"width: 200px;\" readonly/>m³/s\r\n                    </el-form-item>\r\n                  <el-form-item >\r\n                    <Button  type=\"primary\"  @click=\"onCaculate(3)\" >计算</Button>\r\n                    <Button  type=\"primary\"  @click=\"onSave(3)\" style=\"margin-left:20px;\" >保存</Button>\r\n                </el-form-item>\r\n                 </el-form>\r\n              </Row>\r\n          </div>\r\n          </Col>\r\n          <Col span=\"5\">\r\n          <Row>\r\n          <Input search enter-button suffix=\"ios-search\" placeholder=\"请输入站名\" style=\"width: auto;margin-left: 20px;\" @on-search=\"search\" v-model=\"searchmsg\" />    \r\n          </Row>\r\n          <Row style=\"margin-top:10px;margin-left: 20px;\">\r\n            <Col :style=\"{'height': (theight+90)+'px','overflow-y': 'auto'}\">\r\n              <el-tree\r\n                class=\"filter-tree\"\r\n                :data=\"Treedata\"\r\n                :props=\"defaultProps\"\r\n                highlight-current=\"true\"\r\n                @node-click=\"type_tree\"\r\n                node-key=\"STCD\"\r\n               :default-expanded-keys=\"keys\"\r\n                ref=\"tree\">\r\n              </el-tree>\r\n            </Col>\r\n          </Row>\r\n          </Col>\r\n      </Row>\r\n    </Content>\r\n  </div>\r\n</template>\r\n<script type=\"text/javascript\">\r\nimport FilterMethods from \"@/assets/commonJS/FilterMethods\";\r\nimport GetDataMethods from \"@/assets/commonJS/GetDataMethods\";\r\nimport App from \"@/App.vue\";\r\nexport default {\r\n  data() {\r\n    return {\r\n        theight:window.innerHeight-350,\r\n        searchmsg:'',\r\n        marginleft:(window.innerWidth-200)*19/24*0.5-150,\r\n        Treedata: [],\r\n      defaultProps: {\r\n          children: 'children',\r\n          label: 'STNM'\r\n        },\r\n      keys:[],\r\n      STinfo:{},\r\n      Titileinfo:{},\r\n      formb:{\r\n        tm:'',\r\n        z:'',\r\n        q:''\r\n      },\r\n      formx:{\r\n        tm:'',\r\n        z:'',\r\n        q:''\r\n      },\r\n      forms:{\r\n        tm:'',\r\n        z:'',\r\n        q:''  \r\n      }\r\n    }\r\n  },\r\n    mounted() {\r\n        var dateformat=this.getNowDate();\r\n        this.formb.tm = dateformat;\r\n        this.formx.tm = dateformat;\r\n        this.forms.tm = dateformat;\r\n        this.axios.get('/ldresult/typesite').then(res => {\r\n      var root=new Object();\r\n      root[\"STNM\"]=\"类型\";root[\"ZD_SIGN\"]=0;root[\"STCD\"]=\"0\";\r\n      var typelist=new Array();\r\n      var type1=new Object();\r\n      type1[\"STNM\"]=\"标准断面\";type1[\"ME_TYPE\"]=1;type1[\"ZD_SIGN\"]=0;type1[\"STCD\"]=\"1\";typelist.push(type1);\r\n      var type2=new Object();\r\n      type2[\"STNM\"]=\"巴歇尔槽\";type2[\"ME_TYPE\"]=2;type2[\"ZD_SIGN\"]=0;type2[\"STCD\"]=\"2\";typelist.push(type2);\r\n      var type3=new Object();\r\n      type3[\"STNM\"]=\"水闸\";type3[\"ME_TYPE\"]=3;type3[\"ZD_SIGN\"]=0;type3[\"STCD\"]=\"3\";typelist.push(type3);\r\n      //var type4=new Object();\r\n      //type4[\"STNM\"]=\"管道\";type4[\"ME_TYPE\"]=4;type4[\"ZD_SIGN\"]=0;type4[\"STCD\"]=\"4\";typelist.push(type4);\r\n      root.children=typelist;\r\n      var keyarry=[\"0\",\"1\"];\r\n      var datalist=res.data;\r\n      typelist.map(val => {\r\n                val.children = getChildrenList(val.ME_TYPE, datalist);\r\n                return val;\r\n            });\r\n      function getChildrenList(me_type, data) {\r\n                var newList;\r\n                newList = data.filter((val, index) => {\r\n                    if (val.ME_TYPE == me_type) {\r\n                        return true;\r\n                    }\r\n                })\r\n                return newList;\r\n            }\r\n      keyarry.push(typelist[0].children[0].STCD);\r\n      this.Treedata.push(root);\r\n      this.keys=keyarry;\r\n      this.STinfo=typelist[0].children[0];\r\n      var infoobj=this.STinfo;\r\n      this.axios.get('/ldresult/maxinfo',{params: {metype:this.STinfo.ME_TYPE,stcd:this.STinfo.STCD,year:this.formb.tm}}).then(res1 => {\r\n            var maxobj=res1.data;\r\n            this.loadTData(maxobj);\r\n          });\r\n      });\r\n    },\r\n    methods: {\r\n      //加载表格数据\r\n        loadTData(maxobj){\r\n            this.Titileinfo=maxobj;\r\n            if(maxobj.TYPES){\r\n                if(maxobj.TYPES==1){\r\n                    this.Titileinfo.TYPENAME='矩形';\r\n                }else if(maxobj.TYPES==2){\r\n                    this.Titileinfo.TYPENAME='梯形';\r\n                }else if(maxobj.TYPES==3){\r\n                    this.Titileinfo.TYPENAME='U形';\r\n                }\r\n            }\r\n            \r\n        },\r\n        //站点名称查询\r\n        search(){\r\n          this.Treedata=new Array();\r\n            var tt=this.STinfo;\r\n            this.axios.get('/ldresult/typesite',{params:{stnm:this.searchmsg}}).then(res => {\r\n      var root=new Object();\r\n      root[\"STNM\"]=\"类型\";root[\"ZD_SIGN\"]=0;root[\"STCD\"]=\"0\";\r\n      var typelist=new Array();\r\n      var type1=new Object();\r\n      type1[\"STNM\"]=\"标准断面\";type1[\"ME_TYPE\"]=1;type1[\"ZD_SIGN\"]=0;type1[\"STCD\"]=\"1\";typelist.push(type1);\r\n      var type2=new Object();\r\n      type2[\"STNM\"]=\"巴歇尔槽\";type2[\"ME_TYPE\"]=2;type2[\"ZD_SIGN\"]=0;type2[\"STCD\"]=\"2\";typelist.push(type2);\r\n      var type3=new Object();\r\n      type3[\"STNM\"]=\"水闸\";type3[\"ME_TYPE\"]=3;type3[\"ZD_SIGN\"]=0;type3[\"STCD\"]=\"3\";typelist.push(type3);\r\n      //var type4=new Object();\r\n      //type4[\"STNM\"]=\"管道\";type4[\"ME_TYPE\"]=4;type4[\"ZD_SIGN\"]=0;type4[\"STCD\"]=\"4\";typelist.push(type4);\r\n      var keyarry=[\"0\"];\r\n      var datalist=res.data;\r\n      typelist.map(val => {\r\n                val.children = getChildrenList(val.ME_TYPE, datalist);\r\n                return val;\r\n            });\r\n      function getChildrenList(me_type, data) {\r\n                var newList;\r\n                newList = data.filter((val, index) => {\r\n                    if (val.ME_TYPE == me_type) {\r\n                        return true;\r\n                    }\r\n                })\r\n                return newList;\r\n            }\r\n      for(var i=typelist.length-1;i>=0;i--){\r\n          var typeobj=typelist[i];\r\n          if(typeobj.children==null || typeobj.children.length==0){\r\n              typelist.splice(i,1);\r\n          }\r\n      }\r\n      keyarry.push(typelist[0].ME_TYPE);\r\n      keyarry.push(typelist[0].children[0].STCD);\r\n      root.children=typelist;\r\n      this.Treedata.push(root);\r\n      this.keys=keyarry;\r\n      this.STinfo=typelist[0].children[0];\r\n      this.axios.get('/ldresult/maxinfo',{params: {metype:this.STinfo.ME_TYPE,stcd:this.STinfo.STCD,year:this.formb.tm}}).then(res => {\r\n            var maxobj=res.data;\r\n            this.loadTData(maxobj); \r\n            if(this.STinfo.ME_TYPE==1){\r\n              this.$refs['div1'].style.display=\"\";\r\n              this.$refs['div2'].style.display=\"none\";   \r\n              this.$refs['div3'].style.display=\"none\";      \r\n            }else if(this.STinfo.ME_TYPE==2){\r\n              this.$refs['div1'].style.display=\"none\";\r\n              this.$refs['div2'].style.display=\"\";   \r\n              this.$refs['div3'].style.display=\"none\"; \r\n            }else if(this.STinfo.ME_TYPE==3){\r\n              this.$refs['div1'].style.display=\"none\";\r\n              this.$refs['div2'].style.display=\"none\";   \r\n              this.$refs['div3'].style.display=\"\";\r\n            }\r\n            this.InitData();\r\n          });\r\n      });\r\n     },\r\n     //点击站点叶节点事件\r\n     type_tree(data){\r\n      if (data.ZD_SIGN == 1) {\r\n        this.STinfo = data;\r\n        if(data.ME_TYPE==1 || data.ME_TYPE==2 || data.ME_TYPE==3){\r\n          this.axios.get('/ldresult/maxinfo',{params: {metype:data.ME_TYPE,stcd:data.STCD,year:this.formb.tm}}).then(res => {\r\n            var maxobj=res.data;\r\n            this.loadTData(maxobj);\r\n            if(this.STinfo.ME_TYPE==1){\r\n              this.$refs['div1'].style.display=\"\";\r\n              this.$refs['div2'].style.display=\"none\";   \r\n              this.$refs['div3'].style.display=\"none\";      \r\n            }else if(this.STinfo.ME_TYPE==2){\r\n              this.$refs['div1'].style.display=\"none\";\r\n              this.$refs['div2'].style.display=\"\";   \r\n              this.$refs['div3'].style.display=\"none\"; \r\n            }else if(this.STinfo.ME_TYPE==3){\r\n              this.$refs['div1'].style.display=\"none\";\r\n              this.$refs['div2'].style.display=\"none\";   \r\n              this.$refs['div3'].style.display=\"\";\r\n            }\r\n            this.InitData();\r\n          });\r\n        }\r\n        \r\n      }\r\n    },\r\n    //重置表单\r\n    InitData(){\r\n            var dateformat=this.getNowDate();\r\n            this.formb.tm = dateformat;\r\n            this.formx.tm = dateformat;\r\n            this.forms.tm = dateformat;\r\n            this.formb.z='';\r\n            this.formx.z='';\r\n            this.forms.fz='';\r\n            this.forms.bz='';\r\n            this.forms.hi='';\r\n            this.formb.q='';\r\n            this.formx.q='';\r\n            this.forms.q='';\r\n    },\r\n    //计算\r\n    onCaculate(meType){\r\n       var regPos = /^\\d+(\\.\\d+)?$/;\r\n        var p_obj=new Object();\r\n            p_obj.metype=this.STinfo.ME_TYPE;\r\n        if(meType==1){\r\n            if(this.formb.z==''){\r\n               this.$message({message:'请输入水深！',type:'warning'});\r\n               return;\r\n            }\r\n            if(!regPos.test(this.formb.z)){\r\n              this.$message({message:'水深为数字！',type:'warning'});\r\n              return;\r\n            }\r\n            p_obj.b=this.Titileinfo.B;\r\n            p_obj.m=this.Titileinfo.M;\r\n            p_obj.n=this.Titileinfo.N;\r\n            p_obj.i=this.Titileinfo.I;\r\n            p_obj.z=this.formb.z;\r\n            p_obj.types=this.Titileinfo.TYPES;\r\n            if(this.Titileinfo==\"\"){\r\n              this.$message({message:this.STinfo.STNM+this.formb.tm+'年标准断面参数不存在！',type:'warning'});\r\n              return;\r\n            }\r\n        }else if(meType==2){\r\n            if(this.formx.z==''){\r\n               this.$message({message:'请输入水深！',type:'warning'});\r\n               return;\r\n            }\r\n            if(!regPos.test(this.formx.z)){\r\n              this.$message({message:'水深为数字！',type:'warning'});\r\n              return;\r\n            }\r\n            p_obj.model=this.Titileinfo.MODEL;\r\n            p_obj.z=this.formx.z;\r\n        }else{\r\n            if(this.forms.fz==''){\r\n               this.$message({message:'请输入闸前水深！',type:'warning'});\r\n               return;\r\n            }\r\n            if(!regPos.test(this.forms.fz)){\r\n              this.$message({message:'闸前水深为数字！',type:'warning'});\r\n              return;\r\n            }\r\n            if(this.forms.bz==''){\r\n               this.$message({message:'请输入闸后水深！',type:'warning'});\r\n               return;\r\n            }\r\n            if(!regPos.test(this.forms.bz)){\r\n              this.$message({message:'闸后水深为数字！',type:'warning'});\r\n              return;\r\n            }\r\n            if(this.forms.hi==''){\r\n               this.$message({message:'请输入闸门开度！',type:'warning'});\r\n               return;\r\n            }\r\n            if(!regPos.test(this.forms.hi)){\r\n              this.$message({message:'闸门开度为数字！',type:'warning'});\r\n              return;\r\n            }\r\n            p_obj.gthlntwd=this.Titileinfo.GTHLNTWD;\r\n            p_obj.hi=this.forms.hi;\r\n            p_obj.fz=this.forms.fz;\r\n            p_obj.bz=this.forms.bz;\r\n        }\r\n        this.axios.post('/ldresult/getq',p_obj).then((res)=>{\r\n          var q=res.data;\r\n            if(q!=-1 && q!=\"NaN\"){\r\n              if(meType==1){\r\n                this.formb.q=parseFloat(q).toFixed(3);\r\n              }else if(meType==2){\r\n                this.formx.q=parseFloat(q).toFixed(3);\r\n              }else{\r\n                this.forms.q=parseFloat(q).toFixed(3);\r\n              }\r\n            }else{\r\n                this.$message({message:'数据输入有误，请核对相关数据!',type:'warning'});\r\n            }                   \r\n        });\r\n    },\r\n    //获取当前日期\r\n    getNowDate(){\r\n       var date = new Date();\r\n        return date.getFullYear().toString();\r\n    },\r\n    //水深改吧，流量清零\r\n    clearq(sign){\r\n      if(sign==1){\r\n        this.formb.q='';\r\n      }else if(sign==2){\r\n        this.formx.q='';\r\n      }else{\r\n        this.forms.q='';\r\n      }\r\n    },\r\n    //根据年份修改标准断面参数信息\r\n    timechange(date){\r\n      this.axios.get('/ldresult/maxinfo',{params: {metype:this.STinfo.ME_TYPE,stcd:this.STinfo.STCD,year:date}}).then(res => {\r\n            var maxobj=res.data;\r\n            this.loadTData(maxobj);\r\n          });\r\n      },\r\n    //修改糙率\r\n    onUpdateCl(){\r\n      var u_obj=new Object();\r\n      u_obj.stcd=this.STinfo.STCD;\r\n      u_obj.n=this.Titileinfo.N;\r\n      u_obj.year=this.formb.tm;\r\n      this.axios.get('/ldresult/modifycl',{params: u_obj}).then(res => {\r\n          if(res.data==\"ok\"){\r\n            this.$message({message:'糙率修改成功！',type:'success'});\r\n          }else{\r\n            this.$message({message:this.formb.tm+'年无糙率数据！',type:'warm'});\r\n          }\r\n      });\r\n    },\r\n    //保存到率定结果表\r\n    onSave(meType){\r\n      var s_obj=new Object();\r\n      s_obj.stcd=this.STinfo.STCD;\r\n      s_obj.stnm=this.STinfo.STNM;\r\n      if(meType==1){\r\n        if(this.formb.q==''){\r\n          this.$message({message:'请先计算流量!',type:'warning'});\r\n          return;\r\n        }\r\n        s_obj.year=this.formb.tm;\r\n        s_obj.z=this.formb.z;\r\n        s_obj.q=this.formb.q;\r\n      }else if(meType==2){\r\n          if(this.formx.q==''){\r\n          this.$message({message:'请先计算流量!',type:'warning'});\r\n          return;\r\n        } \r\n        s_obj.year=this.formx.tm;\r\n        s_obj.z=this.formx.z;\r\n        s_obj.q=this.formx.q;\r\n      }else{\r\n        if(this.forms.q==''){\r\n          this.$message({message:'请先计算流量!',type:'warning'});\r\n          return;\r\n        }\r\n        s_obj.year=this.forms.tm;\r\n        s_obj.z=this.forms.fz;\r\n        s_obj.q=this.forms.q;\r\n      }\r\n      this.axios.get('/ldresult/existresult',{params: s_obj}).then(res => {\r\n          if(res.data==0){\r\n            this.axios.post('/ldresult/addeqrl',s_obj).then((res)=>{\r\n            if(res.data==\"ok\"){\r\n                this.$message({message:s_obj.stnm+'水位流量数据保存成功！',type:'success'});\r\n            }                   \r\n        });\r\n          }else{\r\n            this.$message({message:s_obj.stnm+s_obj.year+'年水深为'+s_obj.z+'m的数据已存在!',type:'warning'});\r\n          }\r\n      });\r\n    },  \r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\nhtml, body {\r\n    width: 100%;\r\n    height: 100%;\r\n}\r\n.table_show {\r\n font-size: 14px;\r\n border:1px solid #C7CCD6;\r\n border-collapse:collapse; \r\n td {\r\n    height: 45px;\r\n    border-top: none;\r\n    border:1px solid #C7CCD6;\r\n  }\r\n\r\n  .dt_name {\r\n    width: 10%;\r\n    text-align: right;\r\n  }\r\n\r\n  .dt_vale {\r\n    width: 15%;\r\n    text-align: center;\r\n  }\r\n}\r\n</style>"]}]}