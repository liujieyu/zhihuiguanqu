{"remainingRequest":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work2022\\visualplace\\zhihuiguanqu\\src\\table\\table-zfkz\\table-sskz\\list.vue?vue&type=style&index=0&id=aa6b89f8&lang=less&scoped=true&","dependencies":[{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\src\\table\\table-zfkz\\table-sskz\\list.vue","mtime":1577669404088},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\less-loader\\dist\\cjs.js","mtime":1642129565717},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nheader {\r\n  background: #52a7fe;\r\n  line-height: 2rem;\r\n  padding-left: 1rem;\r\n  color: white;\r\n  font-size: 20px;\r\n}\r\n",{"version":3,"sources":["list.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsmBA;AACA;AACA;AACA;AACA;AACA;AACA","file":"list.vue","sourceRoot":"src/table/table-zfkz/table-sskz","sourcesContent":["<template>\r\n  <div>\r\n    <Breadcrumb :style=\"{margin: '0 0 24px 0'}\">\r\n      <BreadcrumbItem>闸阀控制</BreadcrumbItem>\r\n      <BreadcrumbItem>实时控制</BreadcrumbItem>\r\n    </Breadcrumb>\r\n\r\n    <div>\r\n      <Content :style=\"{padding: '24px', background: '#fff'}\">\r\n        <!-- 查询栏 -->\r\n        <div>\r\n          <Row type=\"flex\" :gutter=\"16\" justify=\"start\">\r\n            <Col>\r\n              行政区划:\r\n              <el-cascader clearable size=\"small\" style=\"width: 160px\" placeholder=\"请选择地址\" :options=\"form.adressList\" v-model=\"form.model_adress\" @change=\"kaidulishibiao_init\" change-on-select></el-cascader>\r\n            </Col>\r\n            <Col>\r\n              渠道:\r\n              <el-cascader clearable size=\"small\" style=\"width: 160px\" placeholder=\"请选择渠道\" :options=\"form.qudaoList\" v-model=\"form.model_qudao\" @change=\"kaidulishibiao_init\" change-on-select></el-cascader>\r\n            </Col>\r\n            <Col>\r\n              管理机构:\r\n              <el-cascader clearable size=\"small\" style=\"width: 160px\" placeholder=\"请选择管理机构\" :options=\"form.guanliList\" v-model=\"form.model_guanli\" @change=\"kaidulishibiao_init\" change-on-select></el-cascader>\r\n            </Col>\r\n            <Col>\r\n              站点类型:\r\n              <el-select v-model=\"form.model_site\" style=\"width: 160px\" multiple collapse-tags clearable size=\"small\" @change=\"kaidulishibiao_init\" placeholder=\"站点类型\">\r\n                  <el-option v-for=\"item in form.siteList\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\"></el-option>\r\n              </el-select>\r\n            </Col>\r\n            <Col>\r\n              <!-- 站名模糊搜索 -->\r\n              <Input search enter-button suffix=\"ios-search\" placeholder=\"请输入站名\" style=\"width: auto;margin-right: 20px;\" @on-search=\"kaidulishibiao_init\" v-model=\"form.search_str\"/>\r\n            </Col>\r\n            <Col>\r\n              <Button type=\"primary\" style=\"width: auto;\" @click=\"err\">导出</Button>\r\n            </Col>\r\n          </Row>\r\n        </div>\r\n\r\n        <Divider />\r\n        <!-- 统计栏 -->\r\n        <Row style=\"font-size: 16px;\">\r\n          <Col class=\"borsLine\">\r\n            共{{counter.total}}个站点\r\n          </Col>\r\n        </Row>\r\n\r\n        <Divider style=\"margin-top: 0;\" />\r\n        <!-- 图块数据展示栏 -->\r\n        <div>\r\n          <Row type=\"flex\" style=\"flex-wrap:wrap;\" :gutter=\"24\" v-loading=\"loading\">\r\n            <Col span=\"6\" v-for=\"(item,index) in table.SSXX.Rows\" style=\"margin-top: 20px;\">\r\n              <Card>\r\n                <div slot=\"title\">\r\n                  <img\r\n                    class=\"kaidulishi_img\"\r\n                    :src=\"`/guanqu/gis/pic_content?id=${item.rowinfo.STCD}`\"\r\n                    style=\"width: 100%;cursor:pointer\"\r\n                    @click=\"fangda(table.kaidulishi.Rows,index)\"\r\n                  />\r\n                </div>\r\n                <Row>\r\n                  <Col span=\"6\">站名:</Col>\r\n                  <Col span=\"6\">\r\n                    <span class=\"site_name\" @click=\"show_details(item)\">{{ item.rowinfo.STNM }}</span>\r\n                  </Col>\r\n                  <Col span=\"6\">当前开度:</Col>\r\n                  <Col span=\"6\">{{ item.rowinfo.OD }}</Col>\r\n                </Row>\r\n                <Row>\r\n                  <Col span=\"6\">当前状态:</Col>\r\n                  <Col>{{ item.rowinfo.state }}</Col>\r\n                </Row>\r\n                <Row>\r\n                  <Col span=\"6\">闸前水深:</Col>\r\n                  <Col span=\"6\">{{ $FilterData.Float_Filter(item.rowinfo.upz) + \"m\" }}</Col>\r\n                  <Col span=\"6\">闸后水深:</Col>\r\n                  <Col span=\"6\">{{ $FilterData.Float_Filter(item.rowinfo.dwz) + \"m\" }}</Col>\r\n                </Row>\r\n                <Row>\r\n                  <Col span=\"6\">过闸流量:</Col>\r\n                  <Col>{{ $FilterData.Float_Filter(item.rowinfo.q, 3) + \"m³/s\" }}</Col>\r\n                </Row>\r\n                <Row>\r\n                  <Col span=\"6\">闸门开度:</Col>\r\n                  <Col>{{ item.rowinfo.OD }}</Col>\r\n                </Row>\r\n                <Row>\r\n                  <Col span=\"6\">所在渠道:</Col>\r\n                  <Col></Col>\r\n                </Row>\r\n              </Card>\r\n            </Col>\r\n          </Row>\r\n        </div>\r\n\r\n\r\n\r\n        <!-- 控制窗口 -->\r\n        <el-dialog :title=\"'执行控制： '+kz.STNM\" :visible.sync=\"dialogTableVisible\" width=\"1350px\" :fullscreen=\"false\" :close-on-click-modal=\"false\">\r\n          <div v-if=\"dialogTableVisible\" id=\"dialog_congzhi\">\r\n            <Row type=\"flex\" justify=\"center\" align=\"middle\" :gutter=\"20\" style=\"margin: 0 0 20px 0;\">\r\n              <Col span=\"12\">\r\n                <div>\r\n                      <el-table :data=\"kz_lishi\" height=\"480\" border>\r\n                        <el-table-column prop=\"TM\" label=\"时间\" width=\"140\"></el-table-column>\r\n                        <el-table-column prop=\"OD\" label=\"开度(m)\" width=\"\"></el-table-column>\r\n                        <el-table-column prop=\"UPZ\" label=\"闸前水深(m)\" width=\"\"></el-table-column>\r\n                        <el-table-column prop=\"DWZ\" label=\"闸后水深(m)\" width=\"\"></el-table-column>\r\n                        <el-table-column prop=\"Q\" label=\"过闸流量(m³/s)\" width=\"\"></el-table-column>\r\n                      </el-table>\r\n                </div>\r\n              </Col>\r\n              <Col span=\"12\">\r\n                <div style=\"margin: 10px auto;  width: 640px; height:480px; padding: 0; \">\r\n                  <iframe style=\"width: 640px; height:480px; border: 0px solid red; border: 1px solid black;\" id=\"video\" :src=\"video_iframe\"></iframe>\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n\r\n            <Row style=\"margin:10px 10px\" :gutter=\"20\">\r\n              <div style=\"text-align: center;\"> <header>开度: {{ kz.OD }} m (最大允许： {{ kz.MAX }} m)</header> </div>\r\n            </Row>\r\n\r\n            <el-row style=\"text-align: center;\">\r\n              <div style=\"margin: 10px\">\r\n                <el-slider v-model=\"kz.OD\" :min=\"0\" :step=\"0.01\" :max=\"kz.MAX\"></el-slider>\r\n              </div>\r\n              <div style=\"margin: 10px\">\r\n                  <el-button type=\"danger\" @click=\"run\" :loading=\"run_button\">执行</el-button>\r\n                  <el-button type=\"\" @click=\"dialogTableVisible=false\">关闭窗口</el-button>\r\n              </div>\r\n            </el-row>\r\n          </div>\r\n        </el-dialog>\r\n\r\n\r\n\r\n\r\n\r\n\r\n      </Content>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script type=\"text/javascript\">\r\nimport FilterMethods from \"@/assets/commonJS/FilterMethods\";\r\nimport GetDataMethods from \"@/assets/commonJS/GetDataMethods\";\r\nimport Image from \"@/assets/image/shuizha.jpg\";\r\n//import { setTimeout, setInterval, clearInterval } from \"timers\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      run_button:false,\r\n      table: {\r\n        kaidulishi: {\r\n          Rows: [],\r\n          loading: false\r\n        },\r\n        SSXX: {\r\n          Rows: [],\r\n          loading: false\r\n        }\r\n      },\r\n      details: {\r\n        rowinfo: null,\r\n        current_OD: 0.5,\r\n        split: 0.3,\r\n        Interval: null\r\n      },\r\n\r\n      // koen\r\n      kz:{\r\n          OD:0,\r\n          STCD:'',\r\n          STNM:'',\r\n          MAX:10,\r\n      },\r\n      kz_lishi: [],\r\n      counter: {total:0 },\r\n\r\n\r\n      marks: {\r\n        0: \"0\",\r\n        50: {\r\n          style: {\r\n            color: \"#1989FA\"\r\n          },\r\n          label: this.$createElement(\"strong\", \"1.00\")\r\n        },\r\n        100: \"2\"\r\n      },\r\n      dialogTableVisible: false,\r\n      loading: false,\r\n      activeNames: [],\r\n      list_input: {\r\n        total: 100,\r\n        pagesize: 48,\r\n        pagesizeopts: [10, 20, 48, 75, 100, 200],\r\n        current: 1\r\n      },\r\n      form: {\r\n        adressList: [],\r\n        qudaoList: [],\r\n        siteList: [\r\n          {\r\n            value: \"1\",\r\n            label: \"闸门\"\r\n          },\r\n          {\r\n            value: \"2\",\r\n            label: \"阀门\"\r\n          }\r\n        ],\r\n        model_site: [],\r\n        model_adress: \"\",\r\n        zdlx: \"\",\r\n        model_qudao: \"\",\r\n        model_guanli: \"\",\r\n        date: \"\",\r\n        search_str: null,\r\n        xzqh: \"\",\r\n        qd: \"\"\r\n      },\r\n      timesearch: \"\",\r\n      data: [],\r\n      list: [\r\n        {\r\n          Image: Image\r\n        },\r\n        {\r\n          Image: Image\r\n        },\r\n        {\r\n          Image: Image\r\n        },\r\n        {\r\n          Image: Image\r\n        },\r\n        {\r\n          Image: Image\r\n        }\r\n      ],\r\n      searchs: \"\",\r\n      STNMSlength: 0,\r\n      STNMlength: 0,\r\n      item:{},\r\n      video_iframe:'',\r\n    };\r\n  },\r\n  // 引入过滤方法到此组件\r\n  mixins: [FilterMethods, GetDataMethods],\r\n\r\n\r\n\r\n  methods: {\r\n    //绘制闸门图\r\n    drawchart(Hight,OD) {\r\n      var achart = this.$echarts.init(document.getElementById(achart));\r\n      console.log('+++++++++++++++++++',Hight,OD);\r\n      achart.resize();\r\n      achart.setOption({\r\n        xAxis: {\r\n          type: 'category',\r\n          data: ['闸门']\r\n      },\r\n      yAxis: [\r\n      {\r\n          inverse: true,\r\n          type: 'value',\r\n          min:0,\r\n          max:Hight,\r\n          axisLabel:{\r\n            show:false,\r\n          }\r\n      },\r\n      {\r\n          name: \"闸门高度\",\r\n          type: 'value',\r\n          min:0,\r\n          max:Hight,\r\n      }\r\n      ],\r\n      series: [{\r\n          data: [Hight-OD],\r\n          type: 'bar'\r\n      }]\r\n      });\r\n    },\r\n    formatTooltip(val) {\r\n      return val / (100 / 2);\r\n    },\r\n    handleChange(val) {\r\n      console.log(val);\r\n    },\r\n    fangda(data, index) {\r\n      // data = data.map(val => {\r\n      //   // val.url = val.Image;\r\n      //   return val;\r\n      // });\r\n      // console.log(item);\r\n      this.$App.enlarge_img(data, index);\r\n    },\r\n    // 分页过滤\r\n    pageFilter(currentPage, pageSizes) {\r\n      var _currentPage = currentPage || this.table.currentPage;\r\n      var _pageSizes = pageSizes || this.table.pageSizes;\r\n      // 截取数组\r\n      var newList = this.table.Rows_filter.slice(\r\n        (_currentPage - 1) * _pageSizes,\r\n        _currentPage * _pageSizes\r\n      );\r\n\r\n      return newList;\r\n    },\r\n    gobox(item) {\r\n      console.log(item);\r\n      var evt = new Object();\r\n      evt.graphic = new Object();\r\n      evt.graphic.attributes = item;\r\n      evt.graphic.attributes.itype = \"tuxiang\";\r\n      evt.graphic.attributes.rowinfo = JSON.parse(JSON.stringify(item));\r\n      evt.graphic.attributes.STNM = evt.graphic.attributes.stnm;\r\n      evt.graphic.attributes.STCD = evt.graphic.attributes.stcd;\r\n      evt.graphic.attributes.rowinfo.STNM = evt.graphic.attributes.rowinfo.stnm;\r\n      evt.graphic.attributes.rowinfo.STCD = evt.graphic.attributes.rowinfo.stcd;\r\n      // evt.graphic.attributes.rowinfo.tableType = {\r\n      //   tx: \"historyTable\"\r\n      // };\r\n      var v = new Object();\r\n      v.itype = \"tuxiang\";\r\n      console.log(\"evt\", evt);\r\n      this.$App.showDrawer(evt, v);\r\n    },\r\n    Reload() {\r\n      this.loading = true;\r\n      if (this.form.model_adress.length == 0) {\r\n        this.form.xzqh = \"\";\r\n      }\r\n      if (this.form.model_adress.length == 1) {\r\n        var str1 = this.form.model_adress[0];\r\n        str1 = str1.substring(0, 6);\r\n        this.form.xzqh = str1;\r\n      }\r\n      if (this.form.model_adress.length == 2) {\r\n        var str2 = this.form.model_adress[1];\r\n        str2 = str2.substring(0, 9);\r\n        this.form.xzqh = str2;\r\n      }\r\n      if (this.form.model_adress.length == 3) {\r\n        var str3 = this.form.model_adress[2];\r\n        str3 = str3.substring(0, 12);\r\n        this.form.xzqh = str3;\r\n      }\r\n      if (this.form.model_qudao.length == 0) {\r\n        this.form.qd = \"\";\r\n      }\r\n      if (this.form.model_qudao.length == 1) {\r\n                    // var str4 = this.form.model_qudao[0];\r\n                    // str4 = str4.substring(0, 5);\r\n                    this.form.qd = this.form.model_qudao[0];\r\n                }\r\n                if (this.form.model_qudao.length == 2) {\r\n                    // var str5 = this.form.model_qudao[1];\r\n                    // str5 = str5.substring(0, 9);\r\n                    this.form.qd = this.form.model_qudao[1];\r\n                }\r\n      // this.axios.get('/guanqu/table/ST_JPG_H?_page_size='+this.list_input.pagesize+'&_page='+this.list_input.current+this.searchs,{params:{ADDVCD:this.form.xzqh,Canal_Code:this.form.qd}}).then((res)=>{\r\n      //     this.loading = false;\r\n      // });\r\n      this.axios\r\n        .get(\r\n          \"/guanqu/tuxiang/index?_page_size=\" +\r\n            this.list_input.pagesize +\r\n            \"&_page=\" +\r\n            this.list_input.current +\r\n            this.searchs,\r\n          { params: { ADDVCD: this.form.xzqh, Canal_Code: this.form.qd } }\r\n        )\r\n        .then(res => {\r\n          this.loading = false;\r\n          this.data = res.data.rows;\r\n          this.list_input.total = res.data.total;\r\n          for (var i = 0; i < this.data.length; i++) {\r\n            this.data[i].TM = this.data[i].TM.replace(\".000\", \"\").replace(\r\n              \"20\",\r\n              \"\"\r\n            );\r\n          }\r\n          this.data.forEach((val, index, array) => {\r\n            var Image =\r\n              \"http://v3.yingmen.vip/guanqu/gis/pic_content?id=\" + val.stcd;\r\n            this.axios\r\n              .get(\"/guanqu/tuxiang/details?STCD=\" + val.stcd)\r\n              .then(res => {\r\n                if (res.data.GUANLIAN_YAOSU.length != 0) {\r\n                  val.GUANLIAN_YAOSU = res.data.GUANLIAN_YAOSU;\r\n                }\r\n              });\r\n            val.Image = Image;\r\n          });\r\n          console.log(\"关联要素\", this.data);\r\n        });\r\n      this.axios\r\n        .get(\"/guanqu/tuxiang/index?_page_size=99999\", {\r\n          params: { ADDVCD: this.form.xzqh, Canal_Code: this.form.qd }\r\n        })\r\n        .then(res => {\r\n          this.STNMSlength = res.data.total;\r\n        });\r\n      this.getTableData_WRP_AD_B(data => {\r\n        this.form.adressList = data;\r\n      });\r\n      // 获取输排水渠道数据,然后设置渠道选择框选项\r\n      this.getTableData_WRP_IrrBTCanalSystem(data => {\r\n        this.form.qudaoList = data;\r\n      });\r\n    },\r\n    err() {\r\n      this.$Message.warning(\"该功能还在开发中...\");\r\n    },\r\n    // 处理页码切换\r\n    CurrentChange(index) {\r\n      // console.log(index);\r\n      this.list_input.current = index;\r\n      this.Reload();\r\n    },\r\n    // 处理每页显示条数切换\r\n    PagesizeChange(pagesize) {\r\n      // console.log(pagesize)\r\n      this.list_input.pagesize = pagesize;\r\n      this.Reload();\r\n    },\r\n    // 排序\r\n    sort_change_shuiqing() {},\r\n\r\n\r\n\r\n    // 执行闸阀控制\r\n    // koen 2019-8-2\r\n    run() {\r\n      //return;\r\n      this.run_button = true;\r\n\r\n      this.axios.put(\"/guanqu/zhafakongzhi/shishi\",{ KZKD: this.kz.OD, STCD: this.kz.STCD }).then(res => {\r\n        this.run_button = false;\r\n        this.$message({ message: '恭喜你，成功执行', type: 'success' });\r\n      });\r\n    },\r\n\r\n\r\n\r\n    //显示控制窗口\r\n    //koen 2019-8-2\r\n    show_details(item) {\r\n      console.log(item);\r\n\r\n      this.dialogTableVisible = true;\r\n      this.kz.OD = parseFloat(item.rowinfo.OD);\r\n      this.kz.STCD = item.rowinfo.STCD;\r\n      this.kz.STNM = item.rowinfo.STNM;\r\n      this.kz.MAX = item.rowinfo.Strobe_Hight;\r\n\r\n      this.reload_h();\r\n      // this.shipin(this.kz.STCD);\r\n      this.details.rowinfo = item.rowinfo;\r\n\r\n      // 获取详情数据\r\n      this.axios.get(`/guanqu/gis/details?ID=${item.rowinfo.STCD}&pk=STCD`).then(res => {\r\n         var details_data = res.data;\r\n         this.item = res.data;\r\n         if (!details_data.CSTYPE) {\r\n\r\n         }\r\n        if (details_data.CSTYPE==3) {\r\n          var video_iframe = document.getElementById(\"video\");\r\n          video_iframe.src = 'em-playvideo.html?61.187.248.226:8866'+','+details_data.PUID+','+details_data.IDX+','+details_data.STNM\r\n        }\r\n        if (details_data.CSTYPE==1) {\r\n          var video_iframe = document.getElementById(\"video\");\r\n          // details_data.WWWPath\r\n          video_iframe.src = details_data.WWWPath;\r\n        }\r\n         //video_iframe.src = 'em-playvideo_detail.html?61.187.248.226:8866'+','+details_data.PUID+','+details_data.IDX+','+details_data.STNM\r\n         this.boxLoading = false;\r\n      });\r\n    },\r\n\r\n\r\n    // shipin(STCD){\r\n    //   this.axios.get('/guanqu/gis/details?ID='+STCD+'&pk=STCD').then(res => {\r\n    //     this.item = res.data;\r\n    //   });\r\n    // },\r\n\r\n\r\n    //定时刷新当前闸阀历史表\r\n    //以便观察控制是否成功\r\n    reload_h(){\r\n      if (!this.dialogTableVisible) return;\r\n\r\n      //var date = this.$App.xPointToNowOfTheDay(-72);\r\n      //var DTT = this.$FilterData.elDatePicker_Filter(date).split(\",\");\r\n      this.$GetData.Survey_History_ZFZT(\"historyTable\", {\r\n          STCD: this.kz.STCD,\r\n          //Time_min: `${DTT[1]}`,\r\n          //Time_max: `${DTT[2]}`,\r\n          _orderby: 'TM desc',\r\n          _page_size: 10,\r\n      },res => {\r\n          // console.log(res);\r\n          this.kz_lishi = res;\r\n          for (var i = 0;i<this.kz_lishi.length ; i++) {\r\n            this.kz_lishi[i].UPZ = this.Z_Filter(this.kz_lishi[i].UPZ);\r\n            this.kz_lishi[i].DWZ = this.Z_Filter(this.kz_lishi[i].DWZ);\r\n          }\r\n          this.axios.post('/guanqu/zhafazhuangtai/gis',{STCD:this.kz.STCD}).then(res => {\r\n             this.item = res.data.features[0];\r\n             // console.log('++++++++++',this.item,this.kz_lishi[0])\r\n             this.drawchart(this.item.rowinfo.Strobe_Hight,this.kz_lishi[0].OD);\r\n          });\r\n        });\r\n    },\r\n\r\n\r\n\r\n\r\n\r\n    kaidulishibiao_init() {\r\n      let body = new Object();\r\n\r\n      // 如果输入框有内容，添加站名过滤字段\r\n      if (this.form.search_str && new String(this.form.search_str).length != 0) {\r\n        body[\"STNM\"] = `${this.form.search_str}`;\r\n      } else {\r\n        // body[\"STNM\"] = null;\r\n      }\r\n      // 如果地址选择框有内容，添加行政区划过滤字段\r\n      if (this.form.model_adress && this.form.model_adress.length != 0) {\r\n        body[\"ADDVCD\"] = `${this.$App.ADDVCD_Array_Filter(\r\n          this.form.model_adress\r\n        )}`;\r\n      } else {\r\n        // body[\"ADDVCD\"] = null;\r\n      }\r\n      // 如果渠道选择框有内容，添加渠道过滤字段\r\n      if (this.form.model_qudao && this.form.model_qudao.length != 0) {\r\n        body[\"Canal_Code\"] = `${this.$App.Canal_Code_Array_Filter(\r\n          this.form.model_qudao\r\n        )}`;\r\n      } else {\r\n        // body[\"Canal_Code\"] = null;\r\n      }\r\n      // 如果站点类型选择框有内容，添加行政区划过滤字段\r\n      if (this.form.model_site && this.form.model_site.length != 0) {\r\n        body[\"CTYPE\"] = this.form.model_site.join(\",\");\r\n      } else {\r\n        // body[\"CTYPE\"] = null;\r\n      }\r\n      console.log(this.form.model_status1);\r\n      // 如果状态选择框有内容，添加行政区划过滤字段\r\n      if (this.form.model_status1) {\r\n        body[\"_status\"] = this.form.model_status1.join(\",\");\r\n      } else {\r\n        // body[\"_status\"] = null;\r\n      }\r\n\r\n      this.$GetData.getFeatrueLayer(\"zhafazhuangtai\", body, res => {\r\n        var data = res.data.features;\r\n        data = data.map(val => {\r\n          val.url = `http://v3.yingmen.vip/guanqu/gis/pic_content?id=${val.rowinfo.STCD}`;\r\n          return val;\r\n        });\r\n        console.warn(\"data\", data);\r\n        this.table.SSXX.Rows = data;\r\n\r\n\r\n        this.counter.total = data.length;\r\n      });\r\n    }\r\n  },\r\n\r\n  destroyed() {\r\n    clearInterval(this.zk_Interval);\r\n  },\r\n\r\n\r\n  mounted() {\r\n    //启动定时刷新机制\r\n    this.zk_Interval = setInterval(()=>{ this.reload_h(); }, 5000);\r\n\r\n\r\n    // 获取行政区划数据,然后设置地址选择框选项\r\n      this.getTableData_WRP_AD_B(data => {\r\n        this.form.adressList = data;\r\n      });\r\n\r\n    // 获取输排水渠道数据,然后设置渠道选择框选项\r\n      this.getTableData_WRP_IrrBTCanalSystem(data => {\r\n        this.form.qudaoList = data;\r\n      });\r\n\r\n    this.kaidulishibiao_init();\r\n  }\r\n};\r\n</script>\r\n\r\n\r\n\r\n\r\n\r\n<style lang=\"less\" scoped>\r\nheader {\r\n  background: #52a7fe;\r\n  line-height: 2rem;\r\n  padding-left: 1rem;\r\n  color: white;\r\n  font-size: 20px;\r\n}\r\n</style>\r\n\r\n<style type=\"text/css\" lang=\"less\" >\r\n.kaidulishi_img {\r\n  width: 235px;\r\n  height: 176px;\r\n}\r\n\r\n.site_name {\r\n  cursor: pointer;\r\n  color: rgb(82, 167, 254);\r\n  white-space: nowrap;\r\n  text-overflow: ellipsis;\r\n  overflow: hidden;\r\n  width: 83px;\r\n  display: inline-block;\r\n}\r\n\r\n.el-dialog__body {\r\n  height: 80%;\r\n  #dialog_congzhi {\r\n    height: 100%;\r\n    border: 0px solid rgb(200, 200, 200);\r\n    .ivu-split-wrapper {\r\n      height: 80%;\r\n    }\r\n\r\n    // 单位栏\r\n    .company {\r\n      text-align: center;\r\n      span {\r\n        line-height: 2rem;\r\n      }\r\n    }\r\n\r\n    #table_kaidulishi {\r\n      position: absolute;\r\n      top: 4rem;\r\n      left: 0;\r\n      bottom: 0;\r\n      right: 0;\r\n    }\r\n\r\n    // 开度历史表\r\n    .ivu-table-wrapper {\r\n      height: 100%;\r\n      // 开度历史表主体\r\n      .ivu-table-body {\r\n        position: absolute;\r\n        top: 32px;\r\n        left: 0;\r\n        bottom: 0;\r\n        right: 0;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}