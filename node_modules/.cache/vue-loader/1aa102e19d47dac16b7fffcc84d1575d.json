{"remainingRequest":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work2022\\visualplace\\zhihuiguanqu\\src\\table\\table-sksq\\table-history.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\src\\table\\table-sksq\\table-history.vue","mtime":1671782204249},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport FilterMethods from \"@/assets/commonJS/FilterMethods\";\nimport GetDataMethods from \"@/assets/commonJS/GetDataMethods\";\nimport App from \"@/App.vue\";\n\nexport default {\n    data() {\n        return {\n            loading: false,\n            theight:window.innerHeight-330,\n            chartheight:(window.innerHeight-310)>600?600:(window.innerHeight-310),\n            qudao: true,\n            xingzhengquhua: false,\n            show1: true,\n            Menu: {show_Controller: false},\n            span1: '19',\n            span2: '5',\n            select:{\n                // 日期选择器绑定值\n                shuiqing_datePicker: null,\n                // 水位数据历史表\n                shuiqingList: [\n                {\n                    value: \"historyTable\",\n                    size: \"small\",\n                    label: \"历史水情\"\n                },\n                {\n                    value: \"hourTable\",\n                    size: \"small\",\n                    label: \"小时水情\"\n                },\n                {\n                    value: \"dayTable\",\n                    size: \"small\",\n                    label: \"日水情\"\n                },\n                {\n                    value: \"monthTable\",\n                    size: \"small\",\n                    label: \"月水情\"\n                }\n                ],\n                // 水位数据历史表绑定值\n                shuiqing_select: \"historyTable\",\n            },\n            table:{\n                // 水情\n                shuiqing: {\n                // 表头设置\n                columns: {\n                    // 历史表\n                historyTable: [\n                {\n                    title: \"时间\",\n                    key: \"tm\",\n                    width: 135,\n                    align: \"center\",\n                    sortable: \"custom\"\n                },\n                {\n                    title: \"库水位\",\n                    width: 90,\n                    key: \"RZ\",\n                    align: \"center\",\n                    sortable: \"custom\"\n                },                   \n                {\n                    width: 90,\n                    title: \"库容\",\n                    key: \"W\",\n                    align: \"center\",\n                    sortable: \"custom\"\n                },\n                {\n                    width: 105,\n                    title: \"入库流量\",\n                    key: \"INQ\",\n                    align: \"center\",\n                    sortable: \"custom\"\n                },\n                {\n                    width: 105,\n                    title: \"出库流量\",\n                    key: \"OTQ\",\n                    align: \"center\",\n                    sortable: \"custom\"\n                },\n                ],\n                // 小时表\n                hourTable: [\n                {\n                    title: \"时间\",\n                    key: \"dt\",\n                    width: 135,\n                    align: \"center\",\n                    sortable: \"custom\"\n                },\n                {\n                    title: \"库水位\",\n                    width: 90,\n                    key: \"RZ\",\n                    align: \"center\",\n                    sortable: \"custom\"\n                },\n                {\n                    width: 90,\n                    title: \"库容\",\n                    key: \"HW\",\n                    align: \"center\",\n                    sortable: \"custom\"\n                },\n                // {\n                //   title: \"库下水位(m)\",\n                //   width: 150,\n                //   key: \"BLRZ\",\n                //   align: \"center\",\n                //   sortable: \"custom\"\n                // },\n                {\n                    width: 105,\n                    title: \"入库流量\",\n                    key: \"INQ\",\n                    align: \"center\",\n                    sortable: \"custom\"\n                },\n                {\n                    width: 110,\n                    title: \"出库流量\",\n                    key: \"OTQ\",\n                    align: \"center\",\n                    sortable: \"custom\"\n                }\n                ],\n                // 日表\n                dayTable: [\n                {\n                    title: \"时间\",\n                    key: \"tm\",\n                    width: 120,\n                    align: \"center\",\n                    sortable: \"custom\"\n                },\n                {\n                    title: \"库水位\",\n                    width: 90,\n                    key: \"RZ\",\n                    align: \"center\",\n                    sortable: \"custom\"\n                },\n                {\n                    width: 90,\n                    title: \"库容\",\n                    key: \"DW\",\n                    align: \"center\",\n                    sortable: \"custom\"\n                },\n                // {\n                //   title: \"库下水位(m)\",\n                //   width: 150,\n                //   key: \"BLRZ\",\n                //   align: \"center\",\n                //   sortable: \"custom\"\n                // },\n                {\n                    width: 105,\n                    title: \"入库流量\",\n                    key: \"INQ\",\n                    align: \"center\",\n                    sortable: \"custom\"\n                },\n                {\n                    width: 105,\n                    title: \"出库流量\",\n                    key: \"OTQ\",\n                    align: \"center\",\n                    sortable: \"custom\"\n                }\n                ],\n                // 月表\n                monthTable: [\n                {\n                    title: \"时间\",\n                    key: \"dt\",\n                    width: 100,\n                    align: \"center\",\n                    sortable: \"custom\"\n                },\n                {\n                    title: \"库水位\",\n                    width: 90,\n                    key: \"RZ\",\n                    align: \"center\",\n                    sortable: \"custom\"\n                },\n                {\n                    width: 90,\n                    title: \"库容\",\n                    key: \"MW\",\n                    align: \"center\",\n                    sortable: \"custom\"\n                },\n                // {\n                //   title: \"库下水位(m)\",\n                //   width: 150,\n                //   key: \"BLRZ\",\n                //   align: \"center\",\n                //   sortable: \"custom\"\n                // },\n                {\n                    width: 105,\n                    title: \"入库流量\",\n                    key: \"INQ\",\n                    align: \"center\",\n                    sortable: \"custom\"\n                },\n                {\n                    width: 105,\n                    title: \"出库流量\",\n                    key: \"OTQ\",\n                    align: \"center\",\n                    sortable: \"custom\"\n                }\n                ]\n            },\n            // 正在激活的表头\n            activeColumns: [],\n            // 表体内容\n            Rows: [],\n            // 过滤后的表体内容\n            Rows_filter: [],\n            // 日期时间选择器的选项配置\n            datePickerOptions: {\n                historyTable: {\n                shortcuts: [\n                    {\n                    text: \"最近6小时\",\n                    onClick(picker) {\n                        const end = new Date();\n                        const start = new Date();\n                        start.setTime(start.getTime() - 3600 * 1000 * 6);\n                        picker.$emit(\"pick\", [start, end]);\n                    }\n                    },\n                    {\n                    text: \"最近12小时\",\n                    onClick(picker) {\n                        const end = new Date();\n                        const start = new Date();\n                        start.setTime(start.getTime() - 3600 * 1000 * 12);\n                        picker.$emit(\"pick\", [start, end]);\n                    }\n                    },\n                    {\n                    text: \"最近24小时\",\n                    onClick(picker) {\n                        const end = new Date();\n                        const start = new Date();\n                        start.setTime(start.getTime() - 3600 * 1000 * 24);\n                        picker.$emit(\"pick\", [start, end]);\n                    }\n                    },\n                    {\n                    text: \"最近36小时\",\n                    onClick(picker) {\n                        const end = new Date();\n                        const start = new Date();\n                        start.setTime(start.getTime() - 3600 * 1000 * 36);\n                        picker.$emit(\"pick\", [start, end]);\n                    }\n                    },\n                    {\n                    text: \"最近72小时\",\n                    onClick(picker) {\n                        const end = new Date();\n                        const start = new Date();\n                        start.setTime(start.getTime() - 3600 * 1000 * 72);\n                        picker.$emit(\"pick\", [start, end]);\n                    }\n                    }\n                ]\n                },\n                hourTable: {\n                shortcuts: [\n                    {\n                    text: \"最近6小时\",\n                    onClick(picker) {\n                        const end = new Date();\n                        const start = new Date();\n                        start.setTime(start.getTime() - 3600 * 1000 * 6);\n                        picker.$emit(\"pick\", [start, end]);\n                    }\n                    },\n                    {\n                    text: \"最近12小时\",\n                    onClick(picker) {\n                        const end = new Date();\n                        const start = new Date();\n                        start.setTime(start.getTime() - 3600 * 1000 * 12);\n                        picker.$emit(\"pick\", [start, end]);\n                    }\n                    },\n                    {\n                    text: \"最近24小时\",\n                    onClick(picker) {\n                        const end = new Date();\n                        const start = new Date();\n                        start.setTime(start.getTime() - 3600 * 1000 * 24);\n                        picker.$emit(\"pick\", [start, end]);\n                    }\n                    },\n                    {\n                    text: \"最近36小时\",\n                    onClick(picker) {\n                        const end = new Date();\n                        const start = new Date();\n                        start.setTime(start.getTime() - 3600 * 1000 * 36);\n                        picker.$emit(\"pick\", [start, end]);\n                    }\n                    },\n                    {\n                    text: \"最近72小时\",\n                    onClick(picker) {\n                        const end = new Date();\n                        const start = new Date();\n                        start.setTime(start.getTime() - 3600 * 1000 * 72);\n                        picker.$emit(\"pick\", [start, end]);\n                    }\n                    }\n                ]\n                },\n                dayTable: {\n                shortcuts: [\n                    {\n                    text: \"最近10天\",\n                    onClick(picker) {\n                        const end = new Date();\n                        const start = new Date();\n                        start.setTime(start.getTime() - 3600 * 1000 * 24 * 10);\n                        picker.$emit(\"pick\", [start, end]);\n                    }\n                    },\n                    {\n                    text: \"最近15天\",\n                    onClick(picker) {\n                        const end = new Date();\n                        const start = new Date();\n                        start.setTime(start.getTime() - 3600 * 1000 * 24 * 15);\n                        picker.$emit(\"pick\", [start, end]);\n                    }\n                    },\n                    {\n                    text: \"最近30天\",\n                    onClick(picker) {\n                        const end = new Date();\n                        const start = new Date();\n                        start.setTime(start.getTime() - 3600 * 1000 * 24 * 30);\n                        picker.$emit(\"pick\", [start, end]);\n                    }\n                    },\n                    {\n                    text: \"最近60天\",\n                    onClick(picker) {\n                        const end = new Date();\n                        const start = new Date();\n                        start.setTime(start.getTime() - 3600 * 1000 * 24 * 60);\n                        picker.$emit(\"pick\", [start, end]);\n                    }\n                    },\n                    {\n                    text: \"最近90天\",\n                    onClick(picker) {\n                        const end = new Date();\n                        const start = new Date();\n                        start.setTime(start.getTime() - 3600 * 1000 * 24 * 90);\n                        picker.$emit(\"pick\", [start, end]);\n                    }\n                    }\n                ]\n                },\n                monthTable: {\n                shortcuts: []\n                }\n            },\n            // 日期时间选择器类型\n            datePickerType: \"date\",\n            // 日期时间选择器值\n            date: null,\n            // 排序\n            sort: null,\n            // 表格是否加载中\n            loading: false,\n            // 总条数\n            total: 0,\n            // 当前页\n            currentPage: 1,\n            // 每页显示数量\n            pageSizes: 20,\n            // 表格高度\n            height: 430\n            },\n            },\n            Treedata: [],\n            expandedarray:[],\n            filterTreeData:[],\n            GD: '',\n            data1: [],\n            data2: [],\n            date: '',\n            STinfo: {},\n            searchs:\"\",\n            siteno:'',\n            timesearch: '',\n            CZMC: '',\n            echarts: {\n                TM: [],\n                Q: [],\n                UPZ: [],\n                DWZ: [],\n            },\n            form: {\n                searchmsg: '',\n                date: '',\n                field: '',\n            },\n            searchmsg: '',\n            MaxY1: 0,\n            MaxY2: 0,\n            MinY1: 0,\n            MinY2: 0,\n            list_input: {\n                total: 100,\n                pagesize: 50,\n                pagesizeopts: [10, 20, 50, 75, 100, 200],\n                current: 1\n            },\n            yujingdata: {\n                A_ZCFWL: '',\n                A_XXFWL: '',\n            }\n        };\n    },\n    // 引入过滤方法到此组件\n    mixins: [FilterMethods, GetDataMethods],\n    // watch: {\n    //   searchmsg(val) {\n    //     this.$refs.tree.filter(val);\n    //   }\n    // },\n    mounted() {\n        //获取行政区划树\n        this.axios.get(\"/guanqu/info/xzqhtree?TYPE=6\").then(res => {\n            this.Treedata = res.data;\n            this.expandedarray.push(this.Treedata[0].id);\n            this.expandedarray.push(this.Treedata[0].children[0].id);\n            var stcd=this.Treedata[0].children[0].children[0].value;\n            this.searchs = stcd;    \n            this.siteno = this.Treedata[0].children[0].children[0].label;\n            this.table[\"shuiqing\"].currentPage = 1;\n            this.table[\"shuiqing\"].date = null;\n            this.table[\"shuiqing\"].sort = null;\n            this.setDatePickerType_shuiqing(this.select.shuiqing_select); // 设置日期时间选择器的类型\n            this.setActiveColumns_shuiqing(this.select.shuiqing_select); // 设置水情历史数据表 当前激活的表头\n            this.table.shuiqing.loading = true; // 表格加载中\n            if (this[`setTableDefaultDate_shuiqing_${this.select.shuiqing_select}`]) {\n                this[`setTableDefaultDate_shuiqing_${this.select.shuiqing_select}`]();\n            }\n            this.set_SKSQ_alarmInfo(this.searchs,data=>{\n                this.Reload();\n            });           \n        });\n    },\n    methods: {\n        // 设置 xx表格 时间选择器值\n        setTableDate(tableName, val) {\n        this.table[tableName].date = val;\n        },\n        sort_change(column) {\n            console.log(column);\n            if (column.order == 'ascending') {\n                this.form.field = column.prop;\n                this.ReloadBysort();\n            }\n            if (column.order == 'descending') {\n                this.form.field = column.prop + ' desc';\n                this.ReloadBysort();\n            }\n            if (column.order == null) {\n                this.form.field = '';\n                this.ReloadBysort();\n            }\n        },\n        Menu_toggle() {\n            this.Menu.show_Controller = !this.Menu.show_Controller;\n            this.show1 = !this.show1;\n            if (this.show1 == true) {\n                this.span1 = '19';\n                this.span2 = '5';\n                this.data2 = {};\n                this.Reload();\n            } else {\n                this.span1 = '24';\n                this.span2 = '0';\n                this.data2 = {};\n                this.Reload();\n            }\n        },\n\n        // 监听动态参数事件处理函数\n        test1(agmt) {\n            this.Menu.show_Controller = !agmt;\n            // this.show1 = agmt;\n            if (agmt) {\n                if(this.span1 == '24'){\n                    this.span2 = '0';\n                    this.asyncExecute();\n                    return\n                }\n                this.span1 = '19';\n                this.span2 = '5';\n                this.data2 = {};\n                this.asyncExecute()\n            } else {\n                if(this.span1 == '24'){\n                    this.span2 = '0';\n                    this.asyncExecute();\n                    return;\n                }\n                this.span1 = '19';\n                this.span2 = '5';\n                this.data2 = {};\n                this.asyncExecute()\n            }\n        },\n        // 异步刷新，重新绘图\n        asyncExecute(){\n            setTimeout(this.Reload, 100)\n        },\n        filterNode(value, Treedata, node) {  \n            if (!value){\n                this.filterTreeData.push(Treedata);\n                return true;\n            } \n            if(Treedata.label.indexOf(value) !== -1){\n                this.filterTreeData.push(Treedata);\n                return true;\n            }else{\n                if(this.filterTreeData.length==0){\n                return false;\n                }else{\n                var nodedata=this.filterTreeData[this.filterTreeData.length-1];\n                if(nodedata.level==3){\n                    return false;\n                }else{\n                    if(nodedata.level>=Treedata.level){\n                    return false;\n                    }else{\n                    var parent=Treedata.parent;\n                        if(parent.indexOf(nodedata.value)>-1){\n                        return true;\n                        }else{\n                        return false;\n                        }     \n                    }\n                }\n                \n                }\n                \n            }                \n            },\n        xzqh_tree(data){\n            console.log(data);\n            if (data.level==3) {\n                debugger;\n                this.searchs = data.value;\n                this.siteno=data.label;\n                this.set_SKSQ_alarmInfo(this.searchs,data=>{\n                    this.Reload();\n                });\n            }\n            },\n        search() {\n            this.filterTreeData = [];\n            this.$refs.tree.filter(this.searchmsg);\n            if (this.searchmsg != '') {\n                this.filterTreeData.some((val, index) => {\n                if(index==0 && val.level==1){\n                this.expandedarray=[val.id,val.children[0].id];\n                this.searchs=val.children[0].children[0].value;\n                this.siteno=val.children[0].children[0].label;\n                return true;\n                }else if(index==0 && val.level==2){\n                this.expandedarray=[val.id];\n                this.searchs=val.children[0].value;\n                this.siteno=val.children[0].label;\n                return true;\n                }else if(index==0 && val.level==3){\n                this.searchs = val.value;\n                this.siteno=val.label;\n                return true;\n                }\n            });\n                this.set_SKSQ_alarmInfo(this.searchs,data=>{\n                    this.Reload();\n                });\n            }else{\n                this.$refs.tree.root.childNodes.forEach((e)=>{\n                    e.expanded=false;\n                }); \n                this.expandedarray=[this.Treedata[0].id,this.Treedata[0].children[0].id];\n                this.searchs = this.Treedata[0].children[0].children[0].value;   \n                this.siteno= this.Treedata[0].children[0].children[0].label;    \n                this.set_SKSQ_alarmInfo(this.searchs,data=>{\n                    this.Reload();\n                });\n            }\n        },\n        handleDatePickerChange(){\n            this.table.shuiqing.currentPage = 1;\n            this.Reload();\n        },\n        timechange() {\n            console.log(this.form.date);\n            this.Reload();\n        },\n        cellclick() {\n            console.log(JSON.stringify(this.STinfo));\n            if (JSON.stringify(this.STinfo) == \"{}\") {\n                this.$Message.warning('请先选择站点');\n            } else {\n                if(this.STinfo.bj) this.STinfo.STCD = this.STinfo.canal_code;\n                var evt = new Object();\n                evt.graphic = new Object();\n                evt.graphic.attributes = this.STinfo;\n                evt.graphic.attributes.STNM = this.CZMC;\n                evt.graphic.attributes.itype = \"shuikushuiqing\";\n                evt.graphic.attributes.rowinfo = JSON.parse(JSON.stringify(this.STinfo));\n                evt.graphic.attributes.rowinfo.tableType = {\n                    sksq: \"historyTable\"\n                };\n                var v = new Object;\n                v.itype = \"shuikushuiqing\";\n                console.log(\"evt\", evt);\n                this.$App.showDrawer(evt, v);\n            }\n            // var evt = new Object();\n            // evt.graphic = new Object();\n            // evt.graphic.attributes = this.data1[0];\n            // evt.graphic.attributes.itype = \"zhafashuiqing\";\n            // evt.graphic.attributes.rowinfo = JSON.parse(JSON.stringify(this.data1[0]))\n            // evt.graphic.attributes.rowinfo.tableType = {\n            //   qdsq: \"historyTable\"\n            // };\n            // var v = new Object;\n            // v.itype = \"zhafashuiqing\";\n            // console.log(\"evt\",evt);\n            // this.$App.showDrawer(evt, v);\n        },\n        drawchart() {\n            var achart = this.$echarts.init(this.$refs.achart);\n            console.log(achart);\n            achart.resize();\n            achart.setOption({\n                title: {text: this.data2.chartName},\n                tooltip: {\n                    trigger: \"axis\"\n                },\n                legend: {\n                    data: [\"库水位\",\"库容\"],\n                    bottom:-5\n                },\n                toolbox: {\n                    show: true,\n                    feature: {\n                    mark: { show: true },\n                    magicType: { show: true, type: [\"line\", \"bar\"] },\n                    saveAsImage: { show: true }\n                    }\n                },\n                axisPointer: {\n                    link: {xAxisIndex: 'all'}\n                },\n                grid: [{\n                    left: 38,\n                    right: this.data2.right,\n                    height: '34%'\n                    }, {\n                    left: 38,\n                    right: this.data2.right,\n                    top: '59%',\n                    height: '34%'\n                }],\n                xAxis: [\n                    {\n                        boundaryGap: false,\n                        data: this.data2.x.list,\n                    },\n                    {\n                        gridIndex: 1,\n                        boundaryGap: false,\n                        data: this.data2.x.list,\n                        position: 'bottom'\n                    }\n                ],\n                yAxis: [\n                    {\n                        name: '库水位(m)',\n                        type: \"value\",\n                        minInterval:1, \n                        min:this.data2.y1.min,\n                        max:this.data2.y1.max\n                    },\n                    {\n                        gridIndex: 1,\n                        name: this.data2.y4.name+'(万m³)',\n                        type: \"value\",\n                        minInterval:1, \n                        min:200,\n                        max:1000\n                    }\n                ],\n                series: [\n                    {\n                        name: \"库水位\",\n                        type: \"line\",\n                        yAxisIndex: 0,\n                        data:this.data2.y1.list,\n                        showSymbol: false,\n                        smooth: true,\n                        itemStyle : {  \n                            normal : {  \n                                color:'#6C84CE'  \n                            }  \n                        },  \n                        areaStyle: {},\n                        markLine : {\n                            symbol:'none',\n                            itemStyle : {  \n                                            normal : {  \n                                                lineStyle:{  \n                                                type:'solid',\n                                                    color:'red',\n                                                }  \n                                            }  \n                                        },\n                            data : this.data2.markdata,\n                        },\n                    },\n                    {\n                        name: this.data2.y4.name,\n                        type: \"line\",\n                        xAxisIndex: 1,\n                        yAxisIndex: 1,\n                        data:this.data2.y4.list,\n                        showSymbol: false,\n                        smooth: true,\n                        itemStyle : {  \n                            normal : {  \n                                color:'#91CC75'  \n                            }  \n                        },  \n                        areaStyle: {},\n                        markLine: {\n                        symbol:'none',\n                            itemStyle : {  \n                                            normal : {  \n                                                lineStyle:{ \n                                                    type:'solid', \n                                                    color:'red',\n                                                }  \n                                            }  \n                                        },\n                        data: [{name:\"防洪库容820.50\",\n                                yAxis: 820.5,\n                                label: {\n                                formatter: '{b}',\n                                position: 'middle'\n                                }}],\n                    }\n                    }\n                ]\n            });\n        },\n        err() {\n            this.$Message.warning('该功能还在开发中...');\n        },\n        // 设置水库水情预警信息\n        set_SKSQ_alarmInfo(STCD,callback) {\n        this.$GetData.Survey_History_SKSQ(\n            \"alarmTable\",\n            {\n            STCD: STCD,\n            },\n            true,\n            data => {\n            var yujingdata = data.data[0];\n            this.yujingdata.FWL = yujingdata.FWL;\n            this.yujingdata.FWL79 = yujingdata.FWL79;\n            this.yujingdata.SJWL = yujingdata.SJWL;\n            this.yujingdata.JYWL = yujingdata.JYWL;\n            this.yujingdata.XHWL=yujingdata.XHWL;\n            this.yujingdata.ZCWL=yujingdata.ZCWL;\n            callback(yujingdata);\n            }\n        );\n        },\n        // 切换 水情历史数据表类型\n        tableTypeOnChange_shuiqing(tableType) {\n        this.table[\"shuiqing\"].currentPage = 1;\n        this.table[\"shuiqing\"].sort = null;\n        this.table[\"shuiqing\"].date = null;\n        this.setDatePickerType_shuiqing(tableType); // 设置日期时间选择器的类型\n        this.setActiveColumns_shuiqing(tableType); // 设置水情历史数据表 当前激活的表头\n        if (this[`setTableDefaultDate_shuiqing_${tableType}`]) {\n                this[`setTableDefaultDate_shuiqing_${tableType}`]();\n            }\n        // 获取对应水情历史数据表的数据\n        this.Reload();\n        },\n        // 水情历史数据表 当前正在激活的表头\n        setActiveColumns_shuiqing(tableType) {\n        this.table.shuiqing.activeColumns = this.table.shuiqing.columns[tableType];\n        this.select.shuiqing_select = tableType;\n        },\n        // 设置水位数据历史表默认查询日期\n        setTableDefaultDate_shuiqing_historyTable() {\n        const end = new Date();\n        const start = zeroPointOfTheDay();\n\n        var timeSlot = [start, end];\n\n        this.setTableDate(\"shuiqing\", timeSlot);\n\n        function zeroPointOfTheDay() {\n            var date = new Date();\n            date.setHours(0);\n            date.setMinutes(0);\n            date.setSeconds(0);\n            date.setMilliseconds(0);\n            return date;\n        }\n        },\n        // 设置水位数据小时表默认查询日期\n        setTableDefaultDate_shuiqing_hourTable() {\n        const end = new Date();\n        const start = zeroPointOfTheDay();\n\n        var timeSlot = [start, end];\n\n        this.setTableDate(\"shuiqing\", timeSlot);\n\n        function zeroPointOfTheDay() {\n            var date = new Date();\n            date.setHours(0);\n            date.setMinutes(0);\n            date.setSeconds(0);\n            date.setMilliseconds(0);\n            return date;\n        }\n        },\n        // 设置水位数据日表默认查询日期\n        setTableDefaultDate_shuiqing_dayTable() {\n        const end = new Date();\n        const start = new Date();\n        start.setTime(start.getTime() - 3600 * 1000 * 24 * 7);\n\n        var timeSlot = [start, end];\n\n        this.setTableDate(\"shuiqing\", timeSlot);\n\n        function zeroPointOfTheDay() {\n            var date = new Date();\n            date.setHours(0);\n            date.setMinutes(0);\n            date.setSeconds(0);\n            date.setMilliseconds(0);\n            return date;\n        }\n        },\n        // 设置水位数据月表默认查询日期\n        setTableDefaultDate_shuiqing_monthTable() {\n        const end = new Date();\n        const start = new Date();\n        start.setTime(start.getTime() - 3600 * 1000 * 24 * 160);\n\n        var timeSlot = [start, end];\n\n        this.setTableDate(\"shuiqing\", timeSlot);\n\n        function zeroPointOfTheDay() {\n            var date = new Date();\n            date.setHours(0);\n            date.setMinutes(0);\n            date.setSeconds(0);\n            date.setMilliseconds(0);\n            return date;\n        }\n        },\n        // 设置日期时间选择器的类型\n        setDatePickerType_shuiqing(tableType) {\n        var datePickerType;\n        switch (tableType) {\n            case \"historyTable\":\n            datePickerType = \"datetimerange\";\n            break;\n            case \"hourTable\":\n            datePickerType = \"datetimerange\";\n            break;\n            case \"dayTable\":\n            datePickerType = \"daterange\";\n            break;\n            case \"monthTable\":\n            datePickerType = \"monthrange\";\n            break;\n        }\n        this.table[\"shuiqing\"].datePickerType = datePickerType;\n        },\n        // 表格加载中\n        letTableLoading(tableName) {\n            this.table[tableName].loading = true;\n        },\n        // 取消表格加载\n        cancelTableLoading(tableName) {\n            this.table[tableName].loading = false;\n        },\n        ReloadBysort(){\n            var tableType = this.select.shuiqing_select;\n            this.letTableLoading(\"shuiqing\"); // 表格加载中\n            console.log('+++++++++++++'+tableType);\n            // 传递参数\n            var body = {\n                STCD: this.searchs,\n                _page: this.list_input.current,\n                _page_size: this.list_input.pagesize\n            };\n\n            // 如果有选择排序，则传递排序参数\n            if (this.form.field!=null && this.form.field!='') {\n                body._orderby = this.form.field;\n            }\n            // 如果有选择日期进行查询，根据表格类型传递参数\n            if (this.table.shuiqing.date) {\n                switch (tableType) {\n                case \"historyTable\":\n                    var DTT = this.$FilterData\n                    .elDatePicker_Filter(this.table.shuiqing.date)\n                    .split(\",\");\n                    body.Time_min = DTT[1];\n                    body.Time_max = DTT[2];\n                    break;\n                case \"dayTable\":\n                    var DTT = this.$FilterData\n                    .elDatePicker_Filter(this.table.shuiqing.date)\n                    .split(\",\");\n                    body.Time_min = DTT[1].substr(0,10);\n                    body.Time_max = DTT[2].substr(0,10);\n                    break;\n                case \"hourTable\":\n                    console.log('~~~~~~~~~~~~~~~~~~~~~~~'+tableType);\n                    var DTT = this.$FilterData\n                    .elDatePicker_Filter(this.table.shuiqing.date)\n                    .split(\",\");\n                    body.Time_min = DTT[1];\n                    body.Time_max = DTT[2];\n                    break;\n                case \"monthTable\":\n                    var DTT = this.$FilterData.elDatePicker_Filter(this.table.shuiqing.date,\"monthTable\").split(\",\");\n                    body.Time_min = DTT[1].substring(0,7);\n                    body.Time_max = DTT[2].substring(0,7);\n                    break;\n                }\n            }\n\n            // 获取水库水情历史数据\n            this.$GetData.Survey_History_SKSQ(\n                tableType,\n                body,\n                {\n                default: true,\n                myFilter: data => {\n                    data.map(val => {\n                    val.currentPage = body._page;\n                    val.pageSizes = body._page_size;\n                    return val;\n                    });\n                    return data;\n                }\n                },\n                data => {\n                this.table.shuiqing.Rows_filter = data.data;\n                this.list_input.total = data.total;\n                }\n            );\n        },\n        Reload() {\n            var tableType = this.select.shuiqing_select;\n            this.letTableLoading(\"shuiqing\"); // 表格加载中\n            console.log('+++++++++++++'+tableType);\n            // 传递参数\n            var body = {\n                STCD: this.searchs,\n                _page: this.list_input.current,\n                _page_size: this.list_input.pagesize\n            };\n\n            // 如果有选择排序，则传递排序参数\n            if (this.form.field!=null && this.form.field!='') {\n                body._orderby = _this.form.field;\n            }\n            // 如果有选择日期进行查询，根据表格类型传递参数\n            if (this.table.shuiqing.date) {\n                switch (tableType) {\n                case \"historyTable\":\n                    var DTT = this.$FilterData\n                    .elDatePicker_Filter(this.table.shuiqing.date)\n                    .split(\",\");\n                    body.Time_min = DTT[1];\n                    body.Time_max = DTT[2];\n                    break;\n                case \"dayTable\":\n                    var DTT = this.$FilterData\n                    .elDatePicker_Filter(this.table.shuiqing.date)\n                    .split(\",\");\n                    body.Time_min = DTT[1].substr(0,10);\n                    body.Time_max = DTT[2].substr(0,10);\n                    break;\n                case \"hourTable\":\n                    console.log('~~~~~~~~~~~~~~~~~~~~~~~'+tableType);\n                    var DTT = this.$FilterData\n                    .elDatePicker_Filter(this.table.shuiqing.date)\n                    .split(\",\");\n                    body.Time_min = DTT[1];\n                    body.Time_max = DTT[2];\n                    break;\n                case \"monthTable\":\n                    var DTT = this.$FilterData.elDatePicker_Filter(this.table.shuiqing.date,\"monthTable\").split(\",\");\n                    body.Time_min = DTT[1].substring(0,7);\n                    body.Time_max = DTT[2].substring(0,7);\n                    break;\n                }\n            }\n\n            // 获取水库水情历史数据\n            this.$GetData.Survey_History_SKSQ(\n                tableType,\n                body,\n                {\n                default: true,\n                myFilter: data => {\n                    data.map(val => {\n                    val.currentPage = body._page;\n                    val.pageSizes = body._page_size;\n                    return val;\n                    });\n                    return data;\n                }\n                },\n                data => {\n                this.table.shuiqing.Rows_filter = data.data;\n                this.list_input.total = data.total;\n                body._page_size = 999999999;\n                body._page = 1;\n                this.$GetData.Survey_History_SKSQ(\n                    tableType,\n                    body,\n                    {\n                    default: true,\n                    myFilter: data => {\n                        data.map(val => {\n                        val.currentPage = body._page;\n                        val.pageSizes = body._page_size;\n                        return val;\n                        });\n                        return data;\n                    }\n                    },\n                    chartData => {\n                      this.data2=chartData.data;\n                        if(this.data2==null || this.data2.length==0){\n                         return;\n                        }\n                        this.data2 = this.$App.transform_SKSQ_data_into_ehart_data(this.data2,tableType,true); // 水库水情历史统计表数据 转 ehart图形用数据 返回一个对象, 对象里分别装 Y1轴对象 Y2轴对象 X轴对象\n    console.log(this.data2);\n    this.data2.markdata=[];\n    var y1max = Math.ceil(parseFloat(this.yujingdata.XHWL)),\n        y1min = Math.floor(FilterMethods.methods.get_echart_min(this.data2.y1.list));\n    this.data2.y1.max=y1max;\n    this.data2.y1.min=y1min;\n    var mintime=this.data2.x.list[0].slice(0, 10),maxtime=this.data2.x.list[this.data2.x.list.length-1].slice(0, 10);\n    var minmonth=mintime.split(\"-\")[1],maxmonth=maxtime.split(\"-\")[1];\n      this.data2.y1.markval2=this.yujingdata.XHWL;\n    if((parseInt(minmonth)>=7 && parseInt(minmonth)<=9) || (parseInt(maxmonth)>=7 && parseInt(maxmonth)<=9)){\n      this.data2.y1.markval=this.yujingdata.FWL79;\n    }else{\n      this.data2.y1.markval=this.yujingdata.FWL;\n    }\n    //设置markLine\n                var jhsw=new Object();\n                jhsw.name='校核水位 '+this.data2.y1.markval2;\n                jhsw.yAxis=parseFloat(this.yujingdata.XHWL);\n                jhsw.label={\n                       formatter: '{b}',\n                       position: 'middle',\n                }\n                this.data2.markdata.push(jhsw);\n                var zcsw=new Object();\n                zcsw.name='汛限水位 '+this.data2.y1.markval;\n                zcsw.yAxis=parseFloat(this.data2.y1.markval);\n                zcsw.label={\n                       formatter: '{b}',\n                       position: 'middle',\n                }\n                this.data2.markdata.push(zcsw);\n    if(this.data2.y1.min>parseFloat(this.yujingdata.SWL)){\n      this.data2.y1.min=parseFloat(this.yujingdata.SWL);\n    }else{\n      var ssw=new Object();\n                  ssw.name='死水位 '+this.yujingdata.SWL;\n                  ssw.yAxis=parseFloat(this.yujingdata.SWL);\n                  ssw.label={\n                       formatter: '{b}',\n                       position: 'middle',\n                }\n                  this.data2.markdata.push(ssw);\n    }\n    var nowDate=new Date();\n    var now=this.getNowDayString(nowDate);\n    console.log(now);\n    this.data2.right=24;\n    if(mintime==now && maxtime==now && tableType=='historyTable'){\n        this.data2.chartName = \"今日水情图\";\n        //this.data2.right=10;\n        for(var i=0;i<this.data2.x.list.length;i++){\n          var time = this.data2.x.list[i].split(\" \");\n          this.data2.x.list[i]=time[1];\n        }\n    }else if(mintime.slice(0,4)==maxtime.slice(0,4) && maxtime.slice(0,4)==nowDate.getFullYear()){\n        for(var i=0;i<this.data2.x.list.length;i++){\n          var time = this.data2.x.list[i].substr(5);\n          this.data2.x.list[i]=time;\n        }\n    }\n    // y4轴\n                this.data2.y4.name = \"库容\"; // Y2轴名字\n                var y4max = Math.ceil(FilterMethods.methods.get_echart_max(this.data2.y4.list)),\n                    y4min = Math.floor(FilterMethods.methods.get_echart_min(this.data2.y4.list));\n                this.data2.y4.max = y4max; // y4最大值\n                this.data2.y4.min = y4min < 0 ? 0 : y4min; // y4最小值                    \n                var datalist1=[];\n                var datalist2=[];\n                for(var i=0;i<this.data2.x.list.length;i++){\n                  var obj_data1=[this.data2.x.list[i],this.data2.y1.list[i]];\n                  datalist1.push(obj_data1);\n                  var obj_data2=[this.data2.x.list[i],this.data2.y4.list[i]];\n                  datalist2.push(obj_data2);\n                }\n                this.data2.y1.list=datalist1;\n                this.data2.y4.list=datalist2;\n    switch (this.data2.chartName) {\n            case \"历史表\":\n                this.data2.chartName=\"历史水情图\";\n                break;\n            case \"小时表\":\n                this.data2.chartName=\"小时水情图\";\n                break;\n            case \"日表\":\n                this.data2.chartName=\"日水情图\";\n                break;\n            case \"月表\":\n                this.data2.chartName=\"月水情图\";\n                break;\n            case \"年表\":\n                this.data2.chartName=\"年水情图\";\n                break;\n            }\n            this.drawchart();\n                     }                        \n                );\n\n                this.cancelTableLoading(\"shuiqing\"); // 取消表格加载\n                }\n            );\n        },\n        //返回日期\ngetNowDayString(now){\n  return now.getFullYear()+\"-\"+((now.getMonth()+1)<10?\"0\"+(now.getMonth()+1):(now.getMonth()+1))+\"-\"+(now.getDate()<10?\"0\"+now.getDate():now.getDate());\n},\n        indexMethod(index) {\n            return index + 1 + (this.list_input.pagesize * (this.list_input.current - 1));\n        },\n        // 处理页码切换\n        CurrentChange(index) {\n            // console.log(index);\n            this.list_input.current = index;\n            this.ReloadBysort();\n        },\n        // 处理每页显示条数切换\n        PagesizeChange(pagesize) {\n            // console.log(pagesize)\n            this.list_input.pagesize = pagesize;\n            this.ReloadBysort();\n        }\n    },\n    created() {\n    },\n    computed: {\n        balabala() {\n            //console.log(this.$store.state.anniu);\n            return this.$store.state.anniu\n        }\n    },\n    watch: {\n        // 'this.$store.state.anniu': function(){\n        //   console.log(this.$store.state.anniu);\n        // }\n        balabala(curVal, oldVal) {\n            console.log(curVal);\n            this.test1(curVal)\n        }\n    },\n};\n",{"version":3,"sources":["table-history.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwIA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"table-history.vue","sourceRoot":"src/table/table-sksq","sourcesContent":["<template>\r\n    <div>\r\n        <Content :style=\"{padding: '12px 24px 24px 24px', background: '#fff'}\">\r\n            <Row :gutter=\"16\">\r\n                <Col :span=\"span1\">\r\n                    <Row :gutter=\"16\" type=\"flex\" justify=\"start\" z style=\"margin: 10px;line-height: 32px;\">\r\n                        <Col>时间:</Col>\r\n                        <Col>\r\n                            <!-- 开始到结束时间选择 -->\r\n                                <Col span=\"19\">\r\n                                    <el-date-picker\r\n                                    v-model=\"table.shuiqing.date\"\r\n                                    range-separator=\"至\"\r\n                                    start-placeholder=\"开始日期\"\r\n                                    end-placeholder=\"结束日期\"\r\n                                    @change=\"handleDatePickerChange\"\r\n                                    :picker-options=\"table.shuiqing.datePickerOptions[select.shuiqing_select]\"\r\n                                    unlink-panels\r\n                                    :type=\"table.shuiqing.datePickerType\"\r\n                                    size=\"mini\"\r\n                                    style=\"min-width: 360px\"\r\n                                    ></el-date-picker>\r\n                                </Col>\r\n                        </Col>\r\n                        <Col>\r\n                        时段类别：\r\n                        <Select v-model=\"select.shuiqing_select\" @on-change=\"tableTypeOnChange_shuiqing\" style=\"width:130px;margin-right: 20px;\" >\r\n                            <Option v-for=\"item in select.shuiqingList\" :value=\"item.value\" :key=\"item.value\">{{ item.label }}</Option>\r\n                        </Select>\r\n                        </Col>\r\n                        <!-- \r\n                        <Col>\r\n                            <Button type=\"primary\" style=\"width: auto;margin-right: 10px;;\"\r\n                                    @click=\"cellclick\">站点详情\r\n                            </Button>\r\n\r\n                            <Button type=\"primary\" style=\"width: auto;margin-right: 0px;margin-left: 10px;\" @click=\"test1\">显示/隐藏树形</Button>\r\n                        </Col>\r\n                        <Col>\r\n                            <Button type=\"primary\" style=\"width: auto;margin-right: 20px;margin-left: 10px;\"\r\n                                    @click=\"err\">导出\r\n                            </Button>\r\n                        </Col>\r\n                         -->\r\n                    </Row>\r\n                    <div class=\"switch\" @click=\"Menu_toggle\">\r\n                        <i class=\"el-icon-d-arrow-left\" v-if=\"Menu.show_Controller\"></i>\r\n                        <i class=\"el-icon-d-arrow-right\" v-if=\"!Menu.show_Controller\"></i>\r\n                    </div>\r\n                    <Divider/>\r\n                    <Row>\r\n                        <!-- <Col style=\"text-align: center;margin: 0 0 10px 0;\">\r\n                            监测站名：{{CZMC}}\r\n                        </Col> -->\r\n                        <Col style='font-size: 14px;' class=\"borsLine\">站名：{{siteno}}&nbsp;\r\n                        单位：水位 m，流量 10m³/s，库容 万m³&nbsp;&nbsp;4-6月汛限水位：{{yujingdata.FWL}}m&nbsp;7-9月汛限水位：{{yujingdata.FWL79}}m&nbsp;校核洪水位：{{yujingdata.XHWL}}m</Col>\r\n                    </Row>\r\n                    <Row :gutter=\"24\" style=\"display: flex\">\r\n                        <Col style=\"width: 520px;\">\r\n                            <el-table\r\n                                    :data=\"table.shuiqing.Rows_filter\"\r\n                                    border\r\n                                    :height=\"theight\"\r\n                                    :loading=\"table.shuiqing.loading\"\r\n                                    @sort-change=\"sort_change\"\r\n                                    style=\"width: 520px\">\r\n                                <el-table-column\r\n                                        label=\" \"\r\n                                        type=\"index\"\r\n                                        align=\"center\"\r\n                                        width=\"55\"\r\n                                        :index=\"indexMethod\">\r\n                                </el-table-column>\r\n                                <el-table-column\r\n                                        v-for=\"(item,index) in table.shuiqing.activeColumns\"\r\n                                        :prop=\"item.key\"\r\n                                        :align=\"item.align\"\r\n                                        :label=\"item.title\"\r\n                                        :min-width=\"item.width\"\r\n                                        :sortable=\"item.sortable\"\r\n                                        :show-overflow-tooltip=\"true\"\r\n                                ></el-table-column>\r\n                            </el-table>\r\n                            <div style=\"margin: 10px;overflow: hidden\">\r\n                                <div style=\"float: right;\">\r\n                                    <Page\r\n                                            :total=\"list_input.total\"\r\n                                            :current=\"list_input.current\"\r\n                                            show-sizer\r\n                                            :page-size=\"list_input.pagesize\"\r\n                                            :page-size-opts=\"list_input.pagesizeopts\"\r\n                                            @on-change=\"CurrentChange\"\r\n                                            @on-page-size-change=\"PagesizeChange\"\r\n                                            size=\"small\"\r\n                                            show-total\r\n                                            show-elevator\r\n                                    ></Page>\r\n                                </div>\r\n                            </div>\r\n                        </Col>\r\n                        <Col span=\"13\">\r\n                            <div ref=\"achart\" v-show=\"table.shuiqing.Rows_filter.length>0\"  :style=\"{'width': '100%','height': chartheight+'px','margin-top': '1%'}\"></div>\r\n                            <div ref=\"noachart\" v-show=\"table.shuiqing.Rows_filter.length==0\"  :style=\"{'width': '100%','height': chartheight+'px',margin: 'auto', display:'flex', alignItems:'center', justifyContent: 'center','margin-top': '1%'}\">暂无水情图数据</div>\r\n                        </Col>\r\n                    </Row>\r\n                </Col>\r\n                <transition name=\"el-fade-in-linear\">\r\n                    <Col :span=\"span2\" v-show=\"show1\">\r\n                        <Row style=\"margin-top: 10px;line-height: 32px;\">\r\n                            <Col>\r\n                                <Input search enter-button suffix=\"ios-search\" placeholder=\"请输入行政区划或者站点名称\" style=\"width: 250px;margin-right: 20px;\" @on-search=\"search\" v-model=\"searchmsg\" />\r\n                            </Col>\r\n                        </Row>\r\n                        <Row style=\"margin-top: 30px;margin-left: 20px;\">\r\n                            <Col :style=\"{'overflow-y': 'auto', height: (theight+30)+'px'}\">\r\n                            <el-tree\r\n                            \r\n                                class=\"filter-tree\"\r\n                                :data=\"Treedata\"\r\n                                highlight-current=\"true\"\r\n                                node-key=\"id\"\r\n                                :default-expanded-keys=\"expandedarray\"\r\n                                :filter-node-method=\"filterNode\"\r\n                                @node-click=\"xzqh_tree\"\r\n                                ref=\"tree\">\r\n                            </el-tree>\r\n                            </Col>\r\n                        </Row>\r\n                    </Col>\r\n                </transition>\r\n            </Row>\r\n        </Content>\r\n    </div>\r\n</template>\r\n\r\n<script type=\"text/javascript\">\r\n    import FilterMethods from \"@/assets/commonJS/FilterMethods\";\r\n    import GetDataMethods from \"@/assets/commonJS/GetDataMethods\";\r\n    import App from \"@/App.vue\";\r\n\r\n    export default {\r\n        data() {\r\n            return {\r\n                loading: false,\r\n                theight:window.innerHeight-330,\r\n                chartheight:(window.innerHeight-310)>600?600:(window.innerHeight-310),\r\n                qudao: true,\r\n                xingzhengquhua: false,\r\n                show1: true,\r\n                Menu: {show_Controller: false},\r\n                span1: '19',\r\n                span2: '5',\r\n                select:{\r\n                    // 日期选择器绑定值\r\n                    shuiqing_datePicker: null,\r\n                    // 水位数据历史表\r\n                    shuiqingList: [\r\n                    {\r\n                        value: \"historyTable\",\r\n                        size: \"small\",\r\n                        label: \"历史水情\"\r\n                    },\r\n                    {\r\n                        value: \"hourTable\",\r\n                        size: \"small\",\r\n                        label: \"小时水情\"\r\n                    },\r\n                    {\r\n                        value: \"dayTable\",\r\n                        size: \"small\",\r\n                        label: \"日水情\"\r\n                    },\r\n                    {\r\n                        value: \"monthTable\",\r\n                        size: \"small\",\r\n                        label: \"月水情\"\r\n                    }\r\n                    ],\r\n                    // 水位数据历史表绑定值\r\n                    shuiqing_select: \"historyTable\",\r\n                },\r\n                table:{\r\n                    // 水情\r\n                    shuiqing: {\r\n                    // 表头设置\r\n                    columns: {\r\n                        // 历史表\r\n                    historyTable: [\r\n                    {\r\n                        title: \"时间\",\r\n                        key: \"tm\",\r\n                        width: 135,\r\n                        align: \"center\",\r\n                        sortable: \"custom\"\r\n                    },\r\n                    {\r\n                        title: \"库水位\",\r\n                        width: 90,\r\n                        key: \"RZ\",\r\n                        align: \"center\",\r\n                        sortable: \"custom\"\r\n                    },                   \r\n                    {\r\n                        width: 90,\r\n                        title: \"库容\",\r\n                        key: \"W\",\r\n                        align: \"center\",\r\n                        sortable: \"custom\"\r\n                    },\r\n                    {\r\n                        width: 105,\r\n                        title: \"入库流量\",\r\n                        key: \"INQ\",\r\n                        align: \"center\",\r\n                        sortable: \"custom\"\r\n                    },\r\n                    {\r\n                        width: 105,\r\n                        title: \"出库流量\",\r\n                        key: \"OTQ\",\r\n                        align: \"center\",\r\n                        sortable: \"custom\"\r\n                    },\r\n                    ],\r\n                    // 小时表\r\n                    hourTable: [\r\n                    {\r\n                        title: \"时间\",\r\n                        key: \"dt\",\r\n                        width: 135,\r\n                        align: \"center\",\r\n                        sortable: \"custom\"\r\n                    },\r\n                    {\r\n                        title: \"库水位\",\r\n                        width: 90,\r\n                        key: \"RZ\",\r\n                        align: \"center\",\r\n                        sortable: \"custom\"\r\n                    },\r\n                    {\r\n                        width: 90,\r\n                        title: \"库容\",\r\n                        key: \"HW\",\r\n                        align: \"center\",\r\n                        sortable: \"custom\"\r\n                    },\r\n                    // {\r\n                    //   title: \"库下水位(m)\",\r\n                    //   width: 150,\r\n                    //   key: \"BLRZ\",\r\n                    //   align: \"center\",\r\n                    //   sortable: \"custom\"\r\n                    // },\r\n                    {\r\n                        width: 105,\r\n                        title: \"入库流量\",\r\n                        key: \"INQ\",\r\n                        align: \"center\",\r\n                        sortable: \"custom\"\r\n                    },\r\n                    {\r\n                        width: 110,\r\n                        title: \"出库流量\",\r\n                        key: \"OTQ\",\r\n                        align: \"center\",\r\n                        sortable: \"custom\"\r\n                    }\r\n                    ],\r\n                    // 日表\r\n                    dayTable: [\r\n                    {\r\n                        title: \"时间\",\r\n                        key: \"tm\",\r\n                        width: 120,\r\n                        align: \"center\",\r\n                        sortable: \"custom\"\r\n                    },\r\n                    {\r\n                        title: \"库水位\",\r\n                        width: 90,\r\n                        key: \"RZ\",\r\n                        align: \"center\",\r\n                        sortable: \"custom\"\r\n                    },\r\n                    {\r\n                        width: 90,\r\n                        title: \"库容\",\r\n                        key: \"DW\",\r\n                        align: \"center\",\r\n                        sortable: \"custom\"\r\n                    },\r\n                    // {\r\n                    //   title: \"库下水位(m)\",\r\n                    //   width: 150,\r\n                    //   key: \"BLRZ\",\r\n                    //   align: \"center\",\r\n                    //   sortable: \"custom\"\r\n                    // },\r\n                    {\r\n                        width: 105,\r\n                        title: \"入库流量\",\r\n                        key: \"INQ\",\r\n                        align: \"center\",\r\n                        sortable: \"custom\"\r\n                    },\r\n                    {\r\n                        width: 105,\r\n                        title: \"出库流量\",\r\n                        key: \"OTQ\",\r\n                        align: \"center\",\r\n                        sortable: \"custom\"\r\n                    }\r\n                    ],\r\n                    // 月表\r\n                    monthTable: [\r\n                    {\r\n                        title: \"时间\",\r\n                        key: \"dt\",\r\n                        width: 100,\r\n                        align: \"center\",\r\n                        sortable: \"custom\"\r\n                    },\r\n                    {\r\n                        title: \"库水位\",\r\n                        width: 90,\r\n                        key: \"RZ\",\r\n                        align: \"center\",\r\n                        sortable: \"custom\"\r\n                    },\r\n                    {\r\n                        width: 90,\r\n                        title: \"库容\",\r\n                        key: \"MW\",\r\n                        align: \"center\",\r\n                        sortable: \"custom\"\r\n                    },\r\n                    // {\r\n                    //   title: \"库下水位(m)\",\r\n                    //   width: 150,\r\n                    //   key: \"BLRZ\",\r\n                    //   align: \"center\",\r\n                    //   sortable: \"custom\"\r\n                    // },\r\n                    {\r\n                        width: 105,\r\n                        title: \"入库流量\",\r\n                        key: \"INQ\",\r\n                        align: \"center\",\r\n                        sortable: \"custom\"\r\n                    },\r\n                    {\r\n                        width: 105,\r\n                        title: \"出库流量\",\r\n                        key: \"OTQ\",\r\n                        align: \"center\",\r\n                        sortable: \"custom\"\r\n                    }\r\n                    ]\r\n                },\r\n                // 正在激活的表头\r\n                activeColumns: [],\r\n                // 表体内容\r\n                Rows: [],\r\n                // 过滤后的表体内容\r\n                Rows_filter: [],\r\n                // 日期时间选择器的选项配置\r\n                datePickerOptions: {\r\n                    historyTable: {\r\n                    shortcuts: [\r\n                        {\r\n                        text: \"最近6小时\",\r\n                        onClick(picker) {\r\n                            const end = new Date();\r\n                            const start = new Date();\r\n                            start.setTime(start.getTime() - 3600 * 1000 * 6);\r\n                            picker.$emit(\"pick\", [start, end]);\r\n                        }\r\n                        },\r\n                        {\r\n                        text: \"最近12小时\",\r\n                        onClick(picker) {\r\n                            const end = new Date();\r\n                            const start = new Date();\r\n                            start.setTime(start.getTime() - 3600 * 1000 * 12);\r\n                            picker.$emit(\"pick\", [start, end]);\r\n                        }\r\n                        },\r\n                        {\r\n                        text: \"最近24小时\",\r\n                        onClick(picker) {\r\n                            const end = new Date();\r\n                            const start = new Date();\r\n                            start.setTime(start.getTime() - 3600 * 1000 * 24);\r\n                            picker.$emit(\"pick\", [start, end]);\r\n                        }\r\n                        },\r\n                        {\r\n                        text: \"最近36小时\",\r\n                        onClick(picker) {\r\n                            const end = new Date();\r\n                            const start = new Date();\r\n                            start.setTime(start.getTime() - 3600 * 1000 * 36);\r\n                            picker.$emit(\"pick\", [start, end]);\r\n                        }\r\n                        },\r\n                        {\r\n                        text: \"最近72小时\",\r\n                        onClick(picker) {\r\n                            const end = new Date();\r\n                            const start = new Date();\r\n                            start.setTime(start.getTime() - 3600 * 1000 * 72);\r\n                            picker.$emit(\"pick\", [start, end]);\r\n                        }\r\n                        }\r\n                    ]\r\n                    },\r\n                    hourTable: {\r\n                    shortcuts: [\r\n                        {\r\n                        text: \"最近6小时\",\r\n                        onClick(picker) {\r\n                            const end = new Date();\r\n                            const start = new Date();\r\n                            start.setTime(start.getTime() - 3600 * 1000 * 6);\r\n                            picker.$emit(\"pick\", [start, end]);\r\n                        }\r\n                        },\r\n                        {\r\n                        text: \"最近12小时\",\r\n                        onClick(picker) {\r\n                            const end = new Date();\r\n                            const start = new Date();\r\n                            start.setTime(start.getTime() - 3600 * 1000 * 12);\r\n                            picker.$emit(\"pick\", [start, end]);\r\n                        }\r\n                        },\r\n                        {\r\n                        text: \"最近24小时\",\r\n                        onClick(picker) {\r\n                            const end = new Date();\r\n                            const start = new Date();\r\n                            start.setTime(start.getTime() - 3600 * 1000 * 24);\r\n                            picker.$emit(\"pick\", [start, end]);\r\n                        }\r\n                        },\r\n                        {\r\n                        text: \"最近36小时\",\r\n                        onClick(picker) {\r\n                            const end = new Date();\r\n                            const start = new Date();\r\n                            start.setTime(start.getTime() - 3600 * 1000 * 36);\r\n                            picker.$emit(\"pick\", [start, end]);\r\n                        }\r\n                        },\r\n                        {\r\n                        text: \"最近72小时\",\r\n                        onClick(picker) {\r\n                            const end = new Date();\r\n                            const start = new Date();\r\n                            start.setTime(start.getTime() - 3600 * 1000 * 72);\r\n                            picker.$emit(\"pick\", [start, end]);\r\n                        }\r\n                        }\r\n                    ]\r\n                    },\r\n                    dayTable: {\r\n                    shortcuts: [\r\n                        {\r\n                        text: \"最近10天\",\r\n                        onClick(picker) {\r\n                            const end = new Date();\r\n                            const start = new Date();\r\n                            start.setTime(start.getTime() - 3600 * 1000 * 24 * 10);\r\n                            picker.$emit(\"pick\", [start, end]);\r\n                        }\r\n                        },\r\n                        {\r\n                        text: \"最近15天\",\r\n                        onClick(picker) {\r\n                            const end = new Date();\r\n                            const start = new Date();\r\n                            start.setTime(start.getTime() - 3600 * 1000 * 24 * 15);\r\n                            picker.$emit(\"pick\", [start, end]);\r\n                        }\r\n                        },\r\n                        {\r\n                        text: \"最近30天\",\r\n                        onClick(picker) {\r\n                            const end = new Date();\r\n                            const start = new Date();\r\n                            start.setTime(start.getTime() - 3600 * 1000 * 24 * 30);\r\n                            picker.$emit(\"pick\", [start, end]);\r\n                        }\r\n                        },\r\n                        {\r\n                        text: \"最近60天\",\r\n                        onClick(picker) {\r\n                            const end = new Date();\r\n                            const start = new Date();\r\n                            start.setTime(start.getTime() - 3600 * 1000 * 24 * 60);\r\n                            picker.$emit(\"pick\", [start, end]);\r\n                        }\r\n                        },\r\n                        {\r\n                        text: \"最近90天\",\r\n                        onClick(picker) {\r\n                            const end = new Date();\r\n                            const start = new Date();\r\n                            start.setTime(start.getTime() - 3600 * 1000 * 24 * 90);\r\n                            picker.$emit(\"pick\", [start, end]);\r\n                        }\r\n                        }\r\n                    ]\r\n                    },\r\n                    monthTable: {\r\n                    shortcuts: []\r\n                    }\r\n                },\r\n                // 日期时间选择器类型\r\n                datePickerType: \"date\",\r\n                // 日期时间选择器值\r\n                date: null,\r\n                // 排序\r\n                sort: null,\r\n                // 表格是否加载中\r\n                loading: false,\r\n                // 总条数\r\n                total: 0,\r\n                // 当前页\r\n                currentPage: 1,\r\n                // 每页显示数量\r\n                pageSizes: 20,\r\n                // 表格高度\r\n                height: 430\r\n                },\r\n                },\r\n                Treedata: [],\r\n                expandedarray:[],\r\n                filterTreeData:[],\r\n                GD: '',\r\n                data1: [],\r\n                data2: [],\r\n                date: '',\r\n                STinfo: {},\r\n                searchs:\"\",\r\n                siteno:'',\r\n                timesearch: '',\r\n                CZMC: '',\r\n                echarts: {\r\n                    TM: [],\r\n                    Q: [],\r\n                    UPZ: [],\r\n                    DWZ: [],\r\n                },\r\n                form: {\r\n                    searchmsg: '',\r\n                    date: '',\r\n                    field: '',\r\n                },\r\n                searchmsg: '',\r\n                MaxY1: 0,\r\n                MaxY2: 0,\r\n                MinY1: 0,\r\n                MinY2: 0,\r\n                list_input: {\r\n                    total: 100,\r\n                    pagesize: 50,\r\n                    pagesizeopts: [10, 20, 50, 75, 100, 200],\r\n                    current: 1\r\n                },\r\n                yujingdata: {\r\n                    A_ZCFWL: '',\r\n                    A_XXFWL: '',\r\n                }\r\n            };\r\n        },\r\n        // 引入过滤方法到此组件\r\n        mixins: [FilterMethods, GetDataMethods],\r\n        // watch: {\r\n        //   searchmsg(val) {\r\n        //     this.$refs.tree.filter(val);\r\n        //   }\r\n        // },\r\n        mounted() {\r\n            //获取行政区划树\r\n            this.axios.get(\"/guanqu/info/xzqhtree?TYPE=6\").then(res => {\r\n                this.Treedata = res.data;\r\n                this.expandedarray.push(this.Treedata[0].id);\r\n                this.expandedarray.push(this.Treedata[0].children[0].id);\r\n                var stcd=this.Treedata[0].children[0].children[0].value;\r\n                this.searchs = stcd;    \r\n                this.siteno = this.Treedata[0].children[0].children[0].label;\r\n                this.table[\"shuiqing\"].currentPage = 1;\r\n                this.table[\"shuiqing\"].date = null;\r\n                this.table[\"shuiqing\"].sort = null;\r\n                this.setDatePickerType_shuiqing(this.select.shuiqing_select); // 设置日期时间选择器的类型\r\n                this.setActiveColumns_shuiqing(this.select.shuiqing_select); // 设置水情历史数据表 当前激活的表头\r\n                this.table.shuiqing.loading = true; // 表格加载中\r\n                if (this[`setTableDefaultDate_shuiqing_${this.select.shuiqing_select}`]) {\r\n                    this[`setTableDefaultDate_shuiqing_${this.select.shuiqing_select}`]();\r\n                }\r\n                this.set_SKSQ_alarmInfo(this.searchs,data=>{\r\n                    this.Reload();\r\n                });           \r\n            });\r\n        },\r\n        methods: {\r\n            // 设置 xx表格 时间选择器值\r\n            setTableDate(tableName, val) {\r\n            this.table[tableName].date = val;\r\n            },\r\n            sort_change(column) {\r\n                console.log(column);\r\n                if (column.order == 'ascending') {\r\n                    this.form.field = column.prop;\r\n                    this.ReloadBysort();\r\n                }\r\n                if (column.order == 'descending') {\r\n                    this.form.field = column.prop + ' desc';\r\n                    this.ReloadBysort();\r\n                }\r\n                if (column.order == null) {\r\n                    this.form.field = '';\r\n                    this.ReloadBysort();\r\n                }\r\n            },\r\n            Menu_toggle() {\r\n                this.Menu.show_Controller = !this.Menu.show_Controller;\r\n                this.show1 = !this.show1;\r\n                if (this.show1 == true) {\r\n                    this.span1 = '19';\r\n                    this.span2 = '5';\r\n                    this.data2 = {};\r\n                    this.Reload();\r\n                } else {\r\n                    this.span1 = '24';\r\n                    this.span2 = '0';\r\n                    this.data2 = {};\r\n                    this.Reload();\r\n                }\r\n            },\r\n\r\n            // 监听动态参数事件处理函数\r\n            test1(agmt) {\r\n                this.Menu.show_Controller = !agmt;\r\n                // this.show1 = agmt;\r\n                if (agmt) {\r\n                    if(this.span1 == '24'){\r\n                        this.span2 = '0';\r\n                        this.asyncExecute();\r\n                        return\r\n                    }\r\n                    this.span1 = '19';\r\n                    this.span2 = '5';\r\n                    this.data2 = {};\r\n                    this.asyncExecute()\r\n                } else {\r\n                    if(this.span1 == '24'){\r\n                        this.span2 = '0';\r\n                        this.asyncExecute();\r\n                        return;\r\n                    }\r\n                    this.span1 = '19';\r\n                    this.span2 = '5';\r\n                    this.data2 = {};\r\n                    this.asyncExecute()\r\n                }\r\n            },\r\n            // 异步刷新，重新绘图\r\n            asyncExecute(){\r\n                setTimeout(this.Reload, 100)\r\n            },\r\n            filterNode(value, Treedata, node) {  \r\n                if (!value){\r\n                    this.filterTreeData.push(Treedata);\r\n                    return true;\r\n                } \r\n                if(Treedata.label.indexOf(value) !== -1){\r\n                    this.filterTreeData.push(Treedata);\r\n                    return true;\r\n                }else{\r\n                    if(this.filterTreeData.length==0){\r\n                    return false;\r\n                    }else{\r\n                    var nodedata=this.filterTreeData[this.filterTreeData.length-1];\r\n                    if(nodedata.level==3){\r\n                        return false;\r\n                    }else{\r\n                        if(nodedata.level>=Treedata.level){\r\n                        return false;\r\n                        }else{\r\n                        var parent=Treedata.parent;\r\n                            if(parent.indexOf(nodedata.value)>-1){\r\n                            return true;\r\n                            }else{\r\n                            return false;\r\n                            }     \r\n                        }\r\n                    }\r\n                    \r\n                    }\r\n                    \r\n                }                \r\n                },\r\n            xzqh_tree(data){\r\n                console.log(data);\r\n                if (data.level==3) {\r\n                    debugger;\r\n                    this.searchs = data.value;\r\n                    this.siteno=data.label;\r\n                    this.set_SKSQ_alarmInfo(this.searchs,data=>{\r\n                        this.Reload();\r\n                    });\r\n                }\r\n                },\r\n            search() {\r\n                this.filterTreeData = [];\r\n                this.$refs.tree.filter(this.searchmsg);\r\n                if (this.searchmsg != '') {\r\n                    this.filterTreeData.some((val, index) => {\r\n                    if(index==0 && val.level==1){\r\n                    this.expandedarray=[val.id,val.children[0].id];\r\n                    this.searchs=val.children[0].children[0].value;\r\n                    this.siteno=val.children[0].children[0].label;\r\n                    return true;\r\n                    }else if(index==0 && val.level==2){\r\n                    this.expandedarray=[val.id];\r\n                    this.searchs=val.children[0].value;\r\n                    this.siteno=val.children[0].label;\r\n                    return true;\r\n                    }else if(index==0 && val.level==3){\r\n                    this.searchs = val.value;\r\n                    this.siteno=val.label;\r\n                    return true;\r\n                    }\r\n                });\r\n                    this.set_SKSQ_alarmInfo(this.searchs,data=>{\r\n                        this.Reload();\r\n                    });\r\n                }else{\r\n                    this.$refs.tree.root.childNodes.forEach((e)=>{\r\n                        e.expanded=false;\r\n                    }); \r\n                    this.expandedarray=[this.Treedata[0].id,this.Treedata[0].children[0].id];\r\n                    this.searchs = this.Treedata[0].children[0].children[0].value;   \r\n                    this.siteno= this.Treedata[0].children[0].children[0].label;    \r\n                    this.set_SKSQ_alarmInfo(this.searchs,data=>{\r\n                        this.Reload();\r\n                    });\r\n                }\r\n            },\r\n            handleDatePickerChange(){\r\n                this.table.shuiqing.currentPage = 1;\r\n                this.Reload();\r\n            },\r\n            timechange() {\r\n                console.log(this.form.date);\r\n                this.Reload();\r\n            },\r\n            cellclick() {\r\n                console.log(JSON.stringify(this.STinfo));\r\n                if (JSON.stringify(this.STinfo) == \"{}\") {\r\n                    this.$Message.warning('请先选择站点');\r\n                } else {\r\n                    if(this.STinfo.bj) this.STinfo.STCD = this.STinfo.canal_code;\r\n                    var evt = new Object();\r\n                    evt.graphic = new Object();\r\n                    evt.graphic.attributes = this.STinfo;\r\n                    evt.graphic.attributes.STNM = this.CZMC;\r\n                    evt.graphic.attributes.itype = \"shuikushuiqing\";\r\n                    evt.graphic.attributes.rowinfo = JSON.parse(JSON.stringify(this.STinfo));\r\n                    evt.graphic.attributes.rowinfo.tableType = {\r\n                        sksq: \"historyTable\"\r\n                    };\r\n                    var v = new Object;\r\n                    v.itype = \"shuikushuiqing\";\r\n                    console.log(\"evt\", evt);\r\n                    this.$App.showDrawer(evt, v);\r\n                }\r\n                // var evt = new Object();\r\n                // evt.graphic = new Object();\r\n                // evt.graphic.attributes = this.data1[0];\r\n                // evt.graphic.attributes.itype = \"zhafashuiqing\";\r\n                // evt.graphic.attributes.rowinfo = JSON.parse(JSON.stringify(this.data1[0]))\r\n                // evt.graphic.attributes.rowinfo.tableType = {\r\n                //   qdsq: \"historyTable\"\r\n                // };\r\n                // var v = new Object;\r\n                // v.itype = \"zhafashuiqing\";\r\n                // console.log(\"evt\",evt);\r\n                // this.$App.showDrawer(evt, v);\r\n            },\r\n            drawchart() {\r\n                var achart = this.$echarts.init(this.$refs.achart);\r\n                console.log(achart);\r\n                achart.resize();\r\n                achart.setOption({\r\n                    title: {text: this.data2.chartName},\r\n                    tooltip: {\r\n                        trigger: \"axis\"\r\n                    },\r\n                    legend: {\r\n                        data: [\"库水位\",\"库容\"],\r\n                        bottom:-5\r\n                    },\r\n                    toolbox: {\r\n                        show: true,\r\n                        feature: {\r\n                        mark: { show: true },\r\n                        magicType: { show: true, type: [\"line\", \"bar\"] },\r\n                        saveAsImage: { show: true }\r\n                        }\r\n                    },\r\n                    axisPointer: {\r\n                        link: {xAxisIndex: 'all'}\r\n                    },\r\n                    grid: [{\r\n                        left: 38,\r\n                        right: this.data2.right,\r\n                        height: '34%'\r\n                        }, {\r\n                        left: 38,\r\n                        right: this.data2.right,\r\n                        top: '59%',\r\n                        height: '34%'\r\n                    }],\r\n                    xAxis: [\r\n                        {\r\n                            boundaryGap: false,\r\n                            data: this.data2.x.list,\r\n                        },\r\n                        {\r\n                            gridIndex: 1,\r\n                            boundaryGap: false,\r\n                            data: this.data2.x.list,\r\n                            position: 'bottom'\r\n                        }\r\n                    ],\r\n                    yAxis: [\r\n                        {\r\n                            name: '库水位(m)',\r\n                            type: \"value\",\r\n                            minInterval:1, \r\n                            min:this.data2.y1.min,\r\n                            max:this.data2.y1.max\r\n                        },\r\n                        {\r\n                            gridIndex: 1,\r\n                            name: this.data2.y4.name+'(万m³)',\r\n                            type: \"value\",\r\n                            minInterval:1, \r\n                            min:200,\r\n                            max:1000\r\n                        }\r\n                    ],\r\n                    series: [\r\n                        {\r\n                            name: \"库水位\",\r\n                            type: \"line\",\r\n                            yAxisIndex: 0,\r\n                            data:this.data2.y1.list,\r\n                            showSymbol: false,\r\n                            smooth: true,\r\n                            itemStyle : {  \r\n                                normal : {  \r\n                                    color:'#6C84CE'  \r\n                                }  \r\n                            },  \r\n                            areaStyle: {},\r\n                            markLine : {\r\n                                symbol:'none',\r\n                                itemStyle : {  \r\n                                                normal : {  \r\n                                                    lineStyle:{  \r\n                                                    type:'solid',\r\n                                                        color:'red',\r\n                                                    }  \r\n                                                }  \r\n                                            },\r\n                                data : this.data2.markdata,\r\n                            },\r\n                        },\r\n                        {\r\n                            name: this.data2.y4.name,\r\n                            type: \"line\",\r\n                            xAxisIndex: 1,\r\n                            yAxisIndex: 1,\r\n                            data:this.data2.y4.list,\r\n                            showSymbol: false,\r\n                            smooth: true,\r\n                            itemStyle : {  \r\n                                normal : {  \r\n                                    color:'#91CC75'  \r\n                                }  \r\n                            },  \r\n                            areaStyle: {},\r\n                            markLine: {\r\n                            symbol:'none',\r\n                                itemStyle : {  \r\n                                                normal : {  \r\n                                                    lineStyle:{ \r\n                                                        type:'solid', \r\n                                                        color:'red',\r\n                                                    }  \r\n                                                }  \r\n                                            },\r\n                            data: [{name:\"防洪库容820.50\",\r\n                                    yAxis: 820.5,\r\n                                    label: {\r\n                                    formatter: '{b}',\r\n                                    position: 'middle'\r\n                                    }}],\r\n                        }\r\n                        }\r\n                    ]\r\n                });\r\n            },\r\n            err() {\r\n                this.$Message.warning('该功能还在开发中...');\r\n            },\r\n            // 设置水库水情预警信息\r\n            set_SKSQ_alarmInfo(STCD,callback) {\r\n            this.$GetData.Survey_History_SKSQ(\r\n                \"alarmTable\",\r\n                {\r\n                STCD: STCD,\r\n                },\r\n                true,\r\n                data => {\r\n                var yujingdata = data.data[0];\r\n                this.yujingdata.FWL = yujingdata.FWL;\r\n                this.yujingdata.FWL79 = yujingdata.FWL79;\r\n                this.yujingdata.SJWL = yujingdata.SJWL;\r\n                this.yujingdata.JYWL = yujingdata.JYWL;\r\n                this.yujingdata.XHWL=yujingdata.XHWL;\r\n                this.yujingdata.ZCWL=yujingdata.ZCWL;\r\n                callback(yujingdata);\r\n                }\r\n            );\r\n            },\r\n            // 切换 水情历史数据表类型\r\n            tableTypeOnChange_shuiqing(tableType) {\r\n            this.table[\"shuiqing\"].currentPage = 1;\r\n            this.table[\"shuiqing\"].sort = null;\r\n            this.table[\"shuiqing\"].date = null;\r\n            this.setDatePickerType_shuiqing(tableType); // 设置日期时间选择器的类型\r\n            this.setActiveColumns_shuiqing(tableType); // 设置水情历史数据表 当前激活的表头\r\n            if (this[`setTableDefaultDate_shuiqing_${tableType}`]) {\r\n                    this[`setTableDefaultDate_shuiqing_${tableType}`]();\r\n                }\r\n            // 获取对应水情历史数据表的数据\r\n            this.Reload();\r\n            },\r\n            // 水情历史数据表 当前正在激活的表头\r\n            setActiveColumns_shuiqing(tableType) {\r\n            this.table.shuiqing.activeColumns = this.table.shuiqing.columns[tableType];\r\n            this.select.shuiqing_select = tableType;\r\n            },\r\n            // 设置水位数据历史表默认查询日期\r\n            setTableDefaultDate_shuiqing_historyTable() {\r\n            const end = new Date();\r\n            const start = zeroPointOfTheDay();\r\n\r\n            var timeSlot = [start, end];\r\n\r\n            this.setTableDate(\"shuiqing\", timeSlot);\r\n\r\n            function zeroPointOfTheDay() {\r\n                var date = new Date();\r\n                date.setHours(0);\r\n                date.setMinutes(0);\r\n                date.setSeconds(0);\r\n                date.setMilliseconds(0);\r\n                return date;\r\n            }\r\n            },\r\n            // 设置水位数据小时表默认查询日期\r\n            setTableDefaultDate_shuiqing_hourTable() {\r\n            const end = new Date();\r\n            const start = zeroPointOfTheDay();\r\n\r\n            var timeSlot = [start, end];\r\n\r\n            this.setTableDate(\"shuiqing\", timeSlot);\r\n\r\n            function zeroPointOfTheDay() {\r\n                var date = new Date();\r\n                date.setHours(0);\r\n                date.setMinutes(0);\r\n                date.setSeconds(0);\r\n                date.setMilliseconds(0);\r\n                return date;\r\n            }\r\n            },\r\n            // 设置水位数据日表默认查询日期\r\n            setTableDefaultDate_shuiqing_dayTable() {\r\n            const end = new Date();\r\n            const start = new Date();\r\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 7);\r\n\r\n            var timeSlot = [start, end];\r\n\r\n            this.setTableDate(\"shuiqing\", timeSlot);\r\n\r\n            function zeroPointOfTheDay() {\r\n                var date = new Date();\r\n                date.setHours(0);\r\n                date.setMinutes(0);\r\n                date.setSeconds(0);\r\n                date.setMilliseconds(0);\r\n                return date;\r\n            }\r\n            },\r\n            // 设置水位数据月表默认查询日期\r\n            setTableDefaultDate_shuiqing_monthTable() {\r\n            const end = new Date();\r\n            const start = new Date();\r\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 160);\r\n\r\n            var timeSlot = [start, end];\r\n\r\n            this.setTableDate(\"shuiqing\", timeSlot);\r\n\r\n            function zeroPointOfTheDay() {\r\n                var date = new Date();\r\n                date.setHours(0);\r\n                date.setMinutes(0);\r\n                date.setSeconds(0);\r\n                date.setMilliseconds(0);\r\n                return date;\r\n            }\r\n            },\r\n            // 设置日期时间选择器的类型\r\n            setDatePickerType_shuiqing(tableType) {\r\n            var datePickerType;\r\n            switch (tableType) {\r\n                case \"historyTable\":\r\n                datePickerType = \"datetimerange\";\r\n                break;\r\n                case \"hourTable\":\r\n                datePickerType = \"datetimerange\";\r\n                break;\r\n                case \"dayTable\":\r\n                datePickerType = \"daterange\";\r\n                break;\r\n                case \"monthTable\":\r\n                datePickerType = \"monthrange\";\r\n                break;\r\n            }\r\n            this.table[\"shuiqing\"].datePickerType = datePickerType;\r\n            },\r\n            // 表格加载中\r\n            letTableLoading(tableName) {\r\n                this.table[tableName].loading = true;\r\n            },\r\n            // 取消表格加载\r\n            cancelTableLoading(tableName) {\r\n                this.table[tableName].loading = false;\r\n            },\r\n            ReloadBysort(){\r\n                var tableType = this.select.shuiqing_select;\r\n                this.letTableLoading(\"shuiqing\"); // 表格加载中\r\n                console.log('+++++++++++++'+tableType);\r\n                // 传递参数\r\n                var body = {\r\n                    STCD: this.searchs,\r\n                    _page: this.list_input.current,\r\n                    _page_size: this.list_input.pagesize\r\n                };\r\n\r\n                // 如果有选择排序，则传递排序参数\r\n                if (this.form.field!=null && this.form.field!='') {\r\n                    body._orderby = this.form.field;\r\n                }\r\n                // 如果有选择日期进行查询，根据表格类型传递参数\r\n                if (this.table.shuiqing.date) {\r\n                    switch (tableType) {\r\n                    case \"historyTable\":\r\n                        var DTT = this.$FilterData\r\n                        .elDatePicker_Filter(this.table.shuiqing.date)\r\n                        .split(\",\");\r\n                        body.Time_min = DTT[1];\r\n                        body.Time_max = DTT[2];\r\n                        break;\r\n                    case \"dayTable\":\r\n                        var DTT = this.$FilterData\r\n                        .elDatePicker_Filter(this.table.shuiqing.date)\r\n                        .split(\",\");\r\n                        body.Time_min = DTT[1].substr(0,10);\r\n                        body.Time_max = DTT[2].substr(0,10);\r\n                        break;\r\n                    case \"hourTable\":\r\n                        console.log('~~~~~~~~~~~~~~~~~~~~~~~'+tableType);\r\n                        var DTT = this.$FilterData\r\n                        .elDatePicker_Filter(this.table.shuiqing.date)\r\n                        .split(\",\");\r\n                        body.Time_min = DTT[1];\r\n                        body.Time_max = DTT[2];\r\n                        break;\r\n                    case \"monthTable\":\r\n                        var DTT = this.$FilterData.elDatePicker_Filter(this.table.shuiqing.date,\"monthTable\").split(\",\");\r\n                        body.Time_min = DTT[1].substring(0,7);\r\n                        body.Time_max = DTT[2].substring(0,7);\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                // 获取水库水情历史数据\r\n                this.$GetData.Survey_History_SKSQ(\r\n                    tableType,\r\n                    body,\r\n                    {\r\n                    default: true,\r\n                    myFilter: data => {\r\n                        data.map(val => {\r\n                        val.currentPage = body._page;\r\n                        val.pageSizes = body._page_size;\r\n                        return val;\r\n                        });\r\n                        return data;\r\n                    }\r\n                    },\r\n                    data => {\r\n                    this.table.shuiqing.Rows_filter = data.data;\r\n                    this.list_input.total = data.total;\r\n                    }\r\n                );\r\n            },\r\n            Reload() {\r\n                var tableType = this.select.shuiqing_select;\r\n                this.letTableLoading(\"shuiqing\"); // 表格加载中\r\n                console.log('+++++++++++++'+tableType);\r\n                // 传递参数\r\n                var body = {\r\n                    STCD: this.searchs,\r\n                    _page: this.list_input.current,\r\n                    _page_size: this.list_input.pagesize\r\n                };\r\n\r\n                // 如果有选择排序，则传递排序参数\r\n                if (this.form.field!=null && this.form.field!='') {\r\n                    body._orderby = _this.form.field;\r\n                }\r\n                // 如果有选择日期进行查询，根据表格类型传递参数\r\n                if (this.table.shuiqing.date) {\r\n                    switch (tableType) {\r\n                    case \"historyTable\":\r\n                        var DTT = this.$FilterData\r\n                        .elDatePicker_Filter(this.table.shuiqing.date)\r\n                        .split(\",\");\r\n                        body.Time_min = DTT[1];\r\n                        body.Time_max = DTT[2];\r\n                        break;\r\n                    case \"dayTable\":\r\n                        var DTT = this.$FilterData\r\n                        .elDatePicker_Filter(this.table.shuiqing.date)\r\n                        .split(\",\");\r\n                        body.Time_min = DTT[1].substr(0,10);\r\n                        body.Time_max = DTT[2].substr(0,10);\r\n                        break;\r\n                    case \"hourTable\":\r\n                        console.log('~~~~~~~~~~~~~~~~~~~~~~~'+tableType);\r\n                        var DTT = this.$FilterData\r\n                        .elDatePicker_Filter(this.table.shuiqing.date)\r\n                        .split(\",\");\r\n                        body.Time_min = DTT[1];\r\n                        body.Time_max = DTT[2];\r\n                        break;\r\n                    case \"monthTable\":\r\n                        var DTT = this.$FilterData.elDatePicker_Filter(this.table.shuiqing.date,\"monthTable\").split(\",\");\r\n                        body.Time_min = DTT[1].substring(0,7);\r\n                        body.Time_max = DTT[2].substring(0,7);\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                // 获取水库水情历史数据\r\n                this.$GetData.Survey_History_SKSQ(\r\n                    tableType,\r\n                    body,\r\n                    {\r\n                    default: true,\r\n                    myFilter: data => {\r\n                        data.map(val => {\r\n                        val.currentPage = body._page;\r\n                        val.pageSizes = body._page_size;\r\n                        return val;\r\n                        });\r\n                        return data;\r\n                    }\r\n                    },\r\n                    data => {\r\n                    this.table.shuiqing.Rows_filter = data.data;\r\n                    this.list_input.total = data.total;\r\n                    body._page_size = 999999999;\r\n                    body._page = 1;\r\n                    this.$GetData.Survey_History_SKSQ(\r\n                        tableType,\r\n                        body,\r\n                        {\r\n                        default: true,\r\n                        myFilter: data => {\r\n                            data.map(val => {\r\n                            val.currentPage = body._page;\r\n                            val.pageSizes = body._page_size;\r\n                            return val;\r\n                            });\r\n                            return data;\r\n                        }\r\n                        },\r\n                        chartData => {\r\n                          this.data2=chartData.data;\r\n                            if(this.data2==null || this.data2.length==0){\r\n                             return;\r\n                            }\r\n                            this.data2 = this.$App.transform_SKSQ_data_into_ehart_data(this.data2,tableType,true); // 水库水情历史统计表数据 转 ehart图形用数据 返回一个对象, 对象里分别装 Y1轴对象 Y2轴对象 X轴对象\r\n        console.log(this.data2);\r\n        this.data2.markdata=[];\r\n        var y1max = Math.ceil(parseFloat(this.yujingdata.XHWL)),\r\n            y1min = Math.floor(FilterMethods.methods.get_echart_min(this.data2.y1.list));\r\n        this.data2.y1.max=y1max;\r\n        this.data2.y1.min=y1min;\r\n        var mintime=this.data2.x.list[0].slice(0, 10),maxtime=this.data2.x.list[this.data2.x.list.length-1].slice(0, 10);\r\n        var minmonth=mintime.split(\"-\")[1],maxmonth=maxtime.split(\"-\")[1];\r\n          this.data2.y1.markval2=this.yujingdata.XHWL;\r\n        if((parseInt(minmonth)>=7 && parseInt(minmonth)<=9) || (parseInt(maxmonth)>=7 && parseInt(maxmonth)<=9)){\r\n          this.data2.y1.markval=this.yujingdata.FWL79;\r\n        }else{\r\n          this.data2.y1.markval=this.yujingdata.FWL;\r\n        }\r\n        //设置markLine\r\n                    var jhsw=new Object();\r\n                    jhsw.name='校核水位 '+this.data2.y1.markval2;\r\n                    jhsw.yAxis=parseFloat(this.yujingdata.XHWL);\r\n                    jhsw.label={\r\n                           formatter: '{b}',\r\n                           position: 'middle',\r\n                    }\r\n                    this.data2.markdata.push(jhsw);\r\n                    var zcsw=new Object();\r\n                    zcsw.name='汛限水位 '+this.data2.y1.markval;\r\n                    zcsw.yAxis=parseFloat(this.data2.y1.markval);\r\n                    zcsw.label={\r\n                           formatter: '{b}',\r\n                           position: 'middle',\r\n                    }\r\n                    this.data2.markdata.push(zcsw);\r\n        if(this.data2.y1.min>parseFloat(this.yujingdata.SWL)){\r\n          this.data2.y1.min=parseFloat(this.yujingdata.SWL);\r\n        }else{\r\n          var ssw=new Object();\r\n                      ssw.name='死水位 '+this.yujingdata.SWL;\r\n                      ssw.yAxis=parseFloat(this.yujingdata.SWL);\r\n                      ssw.label={\r\n                           formatter: '{b}',\r\n                           position: 'middle',\r\n                    }\r\n                      this.data2.markdata.push(ssw);\r\n        }\r\n        var nowDate=new Date();\r\n        var now=this.getNowDayString(nowDate);\r\n        console.log(now);\r\n        this.data2.right=24;\r\n        if(mintime==now && maxtime==now && tableType=='historyTable'){\r\n            this.data2.chartName = \"今日水情图\";\r\n            //this.data2.right=10;\r\n            for(var i=0;i<this.data2.x.list.length;i++){\r\n              var time = this.data2.x.list[i].split(\" \");\r\n              this.data2.x.list[i]=time[1];\r\n            }\r\n        }else if(mintime.slice(0,4)==maxtime.slice(0,4) && maxtime.slice(0,4)==nowDate.getFullYear()){\r\n            for(var i=0;i<this.data2.x.list.length;i++){\r\n              var time = this.data2.x.list[i].substr(5);\r\n              this.data2.x.list[i]=time;\r\n            }\r\n        }\r\n        // y4轴\r\n                    this.data2.y4.name = \"库容\"; // Y2轴名字\r\n                    var y4max = Math.ceil(FilterMethods.methods.get_echart_max(this.data2.y4.list)),\r\n                        y4min = Math.floor(FilterMethods.methods.get_echart_min(this.data2.y4.list));\r\n                    this.data2.y4.max = y4max; // y4最大值\r\n                    this.data2.y4.min = y4min < 0 ? 0 : y4min; // y4最小值                    \r\n                    var datalist1=[];\r\n                    var datalist2=[];\r\n                    for(var i=0;i<this.data2.x.list.length;i++){\r\n                      var obj_data1=[this.data2.x.list[i],this.data2.y1.list[i]];\r\n                      datalist1.push(obj_data1);\r\n                      var obj_data2=[this.data2.x.list[i],this.data2.y4.list[i]];\r\n                      datalist2.push(obj_data2);\r\n                    }\r\n                    this.data2.y1.list=datalist1;\r\n                    this.data2.y4.list=datalist2;\r\n        switch (this.data2.chartName) {\r\n                case \"历史表\":\r\n                    this.data2.chartName=\"历史水情图\";\r\n                    break;\r\n                case \"小时表\":\r\n                    this.data2.chartName=\"小时水情图\";\r\n                    break;\r\n                case \"日表\":\r\n                    this.data2.chartName=\"日水情图\";\r\n                    break;\r\n                case \"月表\":\r\n                    this.data2.chartName=\"月水情图\";\r\n                    break;\r\n                case \"年表\":\r\n                    this.data2.chartName=\"年水情图\";\r\n                    break;\r\n                }\r\n                this.drawchart();\r\n                         }                        \r\n                    );\r\n\r\n                    this.cancelTableLoading(\"shuiqing\"); // 取消表格加载\r\n                    }\r\n                );\r\n            },\r\n            //返回日期\r\n    getNowDayString(now){\r\n      return now.getFullYear()+\"-\"+((now.getMonth()+1)<10?\"0\"+(now.getMonth()+1):(now.getMonth()+1))+\"-\"+(now.getDate()<10?\"0\"+now.getDate():now.getDate());\r\n    },\r\n            indexMethod(index) {\r\n                return index + 1 + (this.list_input.pagesize * (this.list_input.current - 1));\r\n            },\r\n            // 处理页码切换\r\n            CurrentChange(index) {\r\n                // console.log(index);\r\n                this.list_input.current = index;\r\n                this.ReloadBysort();\r\n            },\r\n            // 处理每页显示条数切换\r\n            PagesizeChange(pagesize) {\r\n                // console.log(pagesize)\r\n                this.list_input.pagesize = pagesize;\r\n                this.ReloadBysort();\r\n            }\r\n        },\r\n        created() {\r\n        },\r\n        computed: {\r\n            balabala() {\r\n                //console.log(this.$store.state.anniu);\r\n                return this.$store.state.anniu\r\n            }\r\n        },\r\n        watch: {\r\n            // 'this.$store.state.anniu': function(){\r\n            //   console.log(this.$store.state.anniu);\r\n            // }\r\n            balabala(curVal, oldVal) {\r\n                console.log(curVal);\r\n                this.test1(curVal)\r\n            }\r\n        },\r\n    };\r\n</script>\r\n\r\n<style type=\"text/css\" lang=\"less\">\r\n    .switch {\r\n        position: absolute;\r\n        right: 0;\r\n        top: 0;\r\n        height: 55px;\r\n        display: flex;\r\n        align-items: center;\r\n        background: white;\r\n        border-top-left-radius: 5px;\r\n        border-bottom-left-radius: 5px;\r\n        border: #7eb7f0 2px solid;\r\n        border-right: 0;\r\n    }\r\n\r\n    .el-table th {\r\n        padding: 0 !important;\r\n    }\r\n</style>\r\n"]}]}