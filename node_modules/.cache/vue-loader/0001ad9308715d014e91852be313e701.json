{"remainingRequest":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work2022\\visualplace\\zhihuiguanqu\\src\\warm\\yixiang-chart\\wschart.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\src\\warm\\yixiang-chart\\wschart.vue","mtime":1645514326256},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\work2022\\visualplace\\zhihuiguanqu\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport FilterMethods from \"@/assets/commonJS/FilterMethods\";\r\nimport GetDataMethods from \"@/assets/commonJS/GetDataMethods\";\r\nimport { setInterval,setTimeout } from \"timers\";\r\nimport { truncateSync } from \"fs\";\r\nexport default {\r\n    data() {\r\n        return {\r\n            imglist:[],\r\n            theight:window.screen.height,\r\n            subheight1:window.screen.height*0.25,\r\n            lwidth:window.screen.width*0.28125,\r\n            cwidth:window.screen.width*0.4375,\r\n            imgwidth:window.screen.height*2055/1703*1.19,\r\n            imgheight:window.screen.height*1.19,\r\n            allwidth:window.screen.width,\r\n            leftwidth:window.screen.width*0.28125*0.7,\r\n            showleft:true,\r\n            showright:true,\r\n            videosign:false,\r\n            videotop:(window.screen.height-680)/2,\r\n            videoleft:(window.screen.width-900)/2,\r\n            videosrc:'',\r\n            form:{},\r\n            canallist:[],\r\n            gatelist:[],\r\n        }\r\n    },\r\n  mixins: [FilterMethods, GetDataMethods],\r\n  mounted() {\r\n      this.loadRealData();\r\n      this.loadline();  \r\n      this.loadImgdata();\r\n      this.loadPiechart();  \r\n      setInterval(() => {\r\n          this.reloadData();\r\n        }, 1000*60*5);  \r\n  },\r\n  methods: {\r\n    toggleFullScreen(){\r\n          var el=document.documentElement;\r\n          if(el.requestFullscreen){\r\n              el.requestFullscreen()\r\n            }else if(el.mozRequestFullScreen){\r\n              el.mozRequestFullScreen()\r\n            }else if(el.webkitRequestFullscreen){\r\n              el.webkitRequestFullscreen();    \r\n            }else if(el.msRequestFullscreen){\r\n              el.msRequestFullscreen()            \r\n            }\r\n      },\r\n    //重新加载数据\r\n    reloadData(){\r\n      this.loadRealData();\r\n      this.loadline();  \r\n      this.loadImgdata();\r\n      this.loadPiechart(); \r\n    },\r\n    //绘制线性图\r\n    loadline(){\r\n        var body = {\r\n        STCD: 'SMB0000002',\r\n        _page_size: 999999\r\n      };\r\n\r\n      // 时间参数\r\n      var DTT = this.$FilterData\r\n              .elDatePicker_Filter(this.$App.zeroPointToNowOfTheDay())\r\n              .split(\",\");\r\n      body.Time_min = DTT[1];\r\n      body.Time_max = DTT[2];\r\n\r\n      this.$GetData.Survey_History_QDSQ(\r\n        \"historyTable\",\r\n        body,\r\n        {\r\n          default: true\r\n        },\r\n        data => {\r\n          this.createChart('firstchart', data.data,'凉水干渠渠首');\r\n        }\r\n      );\r\n      var body2={\r\n          STCD: 'SMB0000003',\r\n          _page_size: 999999\r\n      };\r\n      body2.Time_min = DTT[1];\r\n      body2.Time_max = DTT[2];\r\n      this.$GetData.Survey_History_QDSQ(\r\n        \"historyTable\",\r\n        body2,\r\n        {\r\n          default: true\r\n        },\r\n        data => {\r\n          this.createChart('secondchart', data.data,'团岭干渠渠首');\r\n        }\r\n      );\r\n      var body3={\r\n          STCD: 'SMB0000019',\r\n          _page_size: 999999\r\n      };\r\n      body3.Time_min = DTT[1];\r\n      body3.Time_max = DTT[2];\r\n      this.$GetData.Survey_History_QDSQ(\r\n        \"historyTable\",\r\n        body3,\r\n        {\r\n          default: true\r\n        },\r\n        data => {\r\n          this.createChart('threechart', data.data,'孙家冲平衡站');\r\n        }\r\n      );\r\n      var body4={\r\n          STCD: 'SMB0000016',\r\n          _page_size: 999999\r\n      };\r\n      body4.Time_min = DTT[1];\r\n      body4.Time_max = DTT[2];\r\n      this.$GetData.Survey_History_QDSQ(\r\n        \"historyTable\",\r\n        body4,\r\n        {\r\n          default: true\r\n        },\r\n        data => {\r\n          this.createChart('fourchart', data.data,'石门桥干渠渠首');\r\n        }\r\n      );\r\n    },\r\n    //加载渠道和闸阀水情实时数据\r\n    loadRealData(){\r\n       this.axios.get('/fieldinfo/getrinfo').then(res => {\r\n             var obj=res.data;\r\n             this.canallist=obj.typecanal;\r\n             for(var i=0;i<this.canallist.length;i++){\r\n              var canalobj=this.canallist[i];\r\n              if(canalobj.Z>0){\r\n                document.getElementById(canalobj.STCD).className = \"waterqddiv\";\r\n              }\r\n              if(canalobj.ALARM==1){\r\n                document.getElementById(canalobj.STCD).className = \"warmqddiv\";\r\n              }\r\n            }\r\n             this.gatelist=obj.typegate;\r\n         });\r\n    },\r\n    //加载图像站数据\r\n    loadImgdata(){\r\n      this.imglist=[];\r\n        this.axios.get('/fieldinfo/videodata').then(res => {\r\n            var list=res.data;\r\n            for(var i=0;i<list.length;i++){\r\n                    var img_obj=new Object();\r\n                    img_obj.stnm=list[i].STNM;\r\n                    img_obj.stcd=list[i].STCD;\r\n                    img_obj.puid=list[i].PUID;\r\n                    this.imglist.push(img_obj);\r\n            }\r\n        });\r\n    },\r\n  //加载饼状图\r\n  loadPiechart(){\r\n      this.axios.get('/fieldinfo/piechart').then(res => {\r\n            var list=res.data;\r\n            var echartData={y:{list:[]}};\r\n            if(list.length==1){\r\n                if(list[0].CS==0){\r\n                    var p1=new Object();\r\n                    p1.value=list[0].TOTAL;\r\n                    p1.name=list[0].TITLE;\r\n                    echartData.y.list.push(p1);\r\n                    var p2=new Object();\r\n                    p2.value=0;\r\n                    p2.name=\"正常\";\r\n                    echartData.y.list.push(p2);\r\n                }else{\r\n                    var p2=new Object();\r\n                    p2.value=0;\r\n                    p2.name=\"故障\";\r\n                    echartData.y.list.push(p2);\r\n                    var p1=new Object();\r\n                    p1.value=list[0].TOTAL;\r\n                    p1.name=list[0].TITLE;\r\n                    echartData.y.list.push(p1);                   \r\n                }\r\n            }else if(list.length>1){\r\n                for(var h=0;h<list.length;h++){\r\n                    var p_obj=new Object();\r\n                    p_obj.value=list[h].TOTAL;\r\n                    p_obj.name=list[h].TITLE;\r\n                    echartData.y.list.push(p_obj);\r\n                }               \r\n            }\r\n            this.createPiechart(echartData);\r\n        });\r\n  },\r\n    // 水位流量线性图\r\n    createChart(id, data,stnm) {\r\n      if (data.length > 0) {\r\n        var echartData = this.$App.transform_QDSQ_data_into_ehart_data(\r\n          data,\r\n          \"historyTable\"\r\n        );\r\n        // 渠道水情历史统计表数据 转 ehart图形用数据 返回一个对象, 对象里分别装 Y1轴对象 Y2轴对象 X轴对象\r\n        var x_List = echartData.x.list\r\n        .map((val, index, array) => {\r\n          // 时间过滤\r\n          var time = val.split(\" \");\r\n          return time[1];\r\n        });\r\n        myChart = this.$echarts.init(document.getElementById(id));\r\n\r\n        myChart.setOption({\r\n          title: {\r\n            text: stnm+\"今日水情图\",\r\n             textStyle: {\r\n              fontSize: 14,\r\n              fontWeight: 'bolder',\r\n              color: '#fff'\r\n            },\r\n          },\r\n          backgroundColor:'',\r\n          tooltip: {\r\n            trigger: \"axis\",\r\n          },\r\n          color:['#f6ff00','#00ffa2'],\r\n          legend: {\r\n            icon : 'roundRect',//icon为圆角矩形          \r\n            data: [echartData.y1.name, echartData.y2.name],\r\n            x: \"right\",\r\n            textStyle:{\r\n               color:'#fff'\r\n           }\r\n          },\r\n          grid: {  \r\n                left: '3%',   //图表距边框的距离\r\n                right: '4%',\r\n                bottom:'1%',\r\n                containLabel: true,\r\n                backgroundColor:'rgba(280,280,280,0.4)',\r\n                show:true\r\n            },\r\n          animation: false,\r\n          xAxis: [\r\n            {\r\n              type: \"category\",\r\n              boundaryGap: false,\r\n              data: x_List,\r\n              splitLine:{show: false},//去除网格线\r\n              axisLine: {\r\n                   lineStyle: {\r\n                       type: 'solid',\r\n                       color:'#ebebe3',\r\n                       width:'2'\r\n                   }\r\n               },\r\n              axisTick: {\r\n                interval: function(index, val) {\r\n                  var listLength = echartData.x.list.length;\r\n                  if (listLength >= 4) {\r\n                    var tick = Math.round(listLength / 4);\r\n                    if ((index + 1) % tick === 0) {\r\n                      return true;\r\n                    } else {\r\n                      return false;\r\n                    }\r\n                  } else {\r\n                    return true;\r\n                  }\r\n                },\r\n                length: 10\r\n              },\r\n              axisLabel: {\r\n                interval: function(index, val) {\r\n                  var listLength = echartData.x.list.length;\r\n                  if (listLength >= 4) {\r\n                    var tick = Math.round(listLength / 4);\r\n                    let a = (index + 1) % tick;\r\n                    if ((index + 1) % tick === 0) {\r\n                      return true;\r\n                    } else {\r\n                      return false;\r\n                    }\r\n                  } else {\r\n                    return true;\r\n                  }\r\n                },\r\n                rotate: 0,\r\n                margin: 16,\r\n                textStyle: {\r\n                       color: '#fff'\r\n                   }\r\n              }\r\n            }\r\n          ],\r\n          yAxis: [\r\n            {\r\n              name: `${echartData.y1.name} m³/s`,\r\n              type: \"value\",             \r\n              splitLine:{show: false},//去除网格线\r\n              axisLine: {\r\n                   lineStyle: {\r\n                       type: 'solid',\r\n                       color:'#ebebe3',\r\n                       width:'2'\r\n                   }\r\n               },\r\n              axisLabel: {\r\n                formatter: \"{value} \",\r\n                textStyle: {\r\n                       color: '#fff'\r\n                   }\r\n              },\r\n              scale: true\r\n            },\r\n            {\r\n              name: `${echartData.y2.name}m`,\r\n              type: \"value\",\r\n              splitLine:{show: false},//去除网格线\r\n              axisLine: {\r\n                   lineStyle: {\r\n                       type: 'solid',\r\n                       color:'#ebebe3',\r\n                       width:'2'\r\n                   }\r\n               },\r\n              axisLabel: {\r\n                formatter: \"{value} \",\r\n                textStyle: {\r\n                       color: '#fff'\r\n                   }\r\n              },\r\n              scale: true\r\n            }\r\n          ],\r\n          series: [\r\n            {\r\n              name: echartData.y1.name,\r\n              type: \"line\",\r\n              data: echartData.y1.list,\r\n              symbol: 'none',\r\n              smooth:true,\r\n              itemStyle : {  \r\n                                normal : {  \r\n                                    lineStyle:{  \r\n                                        color:'#f6ff00',\r\n                                        width:2,\r\n                                        opacity:1\r\n                                    }  \r\n                                }  \r\n                            },\r\n            },\r\n            {\r\n              name: echartData.y2.name,\r\n              type: \"line\",\r\n              data: echartData.y2.list,\r\n              yAxisIndex: 1,\r\n              symbol: 'none',\r\n              smooth:true,\r\n              itemStyle : {  \r\n                                normal : {  \r\n                                    lineStyle:{  \r\n                                        color:'#00ffa2',\r\n                                        width:2,\r\n                                        opacity:1\r\n                                    }  \r\n                                }  \r\n                            },\r\n            }\r\n          ]\r\n        });\r\n      } else {\r\n        var myChart = document.getElementById(id);\r\n        myChart.style.display = \"flex\";\r\n        myChart.style.alignItems = \"center\";\r\n        myChart.style.justifyContent = \"center\";\r\n        myChart.innerHTML =\"<font style='color:#fff;font-weight:bold;'>\"+stnm+\"暂无今天数据</font>\";\r\n      }\r\n    },\r\n    //饼状图\r\n    createPiechart(edata){\r\n    var myChart = this.$echarts.init(this.$refs.piechart);\r\n        // 指定图表的配置项和数据\r\n        var option = {\r\n            // 标题\r\n            title: {\r\n                text: '站点运行工况故障分布图',\r\n                 x: 'center',\r\n                 top: 10,\r\n                 textStyle: {\r\n                    fontSize: 14,\r\n                    fontWeight: 'bold',\r\n                    color:'#fff'\r\n                  },\r\n            },\r\n            //自定义的颜色\r\n            color:[  '#ef2424','#12d0ff'],\r\n            // 图例\r\n            legend: {\r\n                data: ['正常','故障'],\r\n                orient: 'vertical',\r\n                x:'right',\r\n                y:'center',\r\n                textStyle:{\r\n                    color:'#fff'\r\n                }\r\n            },\r\n            grid: {  \r\n                bottom:'2%',\r\n            },\r\n            // 数据\r\n            series: [{\r\n                name: '分布情况',\r\n                type: 'pie',\r\n                radius : '65%',\r\n                center: ['50%', '55%'],\r\n                data: edata.y.list,\r\n                label: {\r\n                normal: {\r\n                    textStyle: {\r\n                        color: 'rgba(255, 255, 255, 1)'\r\n                    }\r\n                }\r\n            },\r\n            labelLine: {\r\n                normal: {\r\n                    lineStyle: {\r\n                        color: 'rgba(255, 255, 255, 1)'\r\n                    },\r\n                    smooth: 0.2,\r\n                    length: 10,\r\n                    length2: 20\r\n                }\r\n            },\r\n                itemStyle: {\r\n                    emphasis: {\r\n                        shadowBlur: 10,\r\n                        shadowOffsetX: 0,\r\n                        shadowColor: 'rgba(255, 255, 255, 0.9)'\r\n                    },\r\n                    normal:{ \r\n                        label:{ \r\n                            show: true, \r\n                            formatter: '{b} : {c} ({d}%)',\r\n                        }, \r\n                        labelLine :{show:true},\r\n                        // 设置扇形的阴影\r\n                        shadowBlur: 30,\r\n                        shadowColor: 'rgba(6,121,159,0.8)', \r\n                        shadowOffsetX: -10,\r\n                        shadowOffsetY: 10\r\n                    }\r\n                } \r\n            }\r\n            ]\r\n        };\r\n    // 使用刚指定的配置项和数据显示图表。\r\n    myChart.setOption(option);       \r\n    },\r\n    showvideo(puid){\r\n      if (!!window.ActiveXObject || \"ActiveXObject\" in window){\r\n         try\r\n          {\r\n            var obj = new ActiveXObject(\"DPSDK_OCX.DPSDK_OCXCtrl.1\");\r\n          }\r\n          catch(e)\r\n          {\r\n            this.$message({message:'控件未注册，请先注册控件！',type:'warning'});\r\n            var url = '/file/downloadocx';\r\n            window.location.href = url;\r\n            return;\r\n          }\r\n      }else{\r\n        this.$message({message:'请确保在IE浏览器下使用视频监控功能！',type:'warning'});\r\n        return;\r\n      }\r\n      this.videosign=true;\r\n      this.videosrc=\"webdemo/index.html?\"+puid;\r\n      \r\n    },\r\n    hidediv(){\r\n      this.videosign=false;\r\n    },\r\n    //显示渠道信息\r\n  showcanalinfo(stcd){\r\n      this.form=new Object();\r\n      for(var i=0;i<this.canallist.length;i++){\r\n        var canalobj=this.canallist[i];\r\n        if(canalobj.STCD==stcd){\r\n          this.form=canalobj;\r\n          break;\r\n        }\r\n      }\r\n  },\r\n  //显示闸阀信息\r\n  showgateinfo(stcd){\r\n    this.form=new Object();\r\n      for(var i=0;i<this.gatelist.length;i++){\r\n        var gateobj=this.gatelist[i];\r\n        if(gateobj.STCD==stcd){\r\n          this.form=gateobj;\r\n          break;\r\n        }\r\n      }\r\n  },\r\n    switchleft(){\r\n    this.showleft=!this.showleft;\r\n    if(this.showleft){\r\n      this.$refs.switchleft.style.left=this.lwidth+'px';\r\n    }else{\r\n      this.$refs.switchleft.style.left='0px';\r\n    }\r\n  },\r\n  switchright(){\r\n    this.showright=!this.showright;\r\n    if(this.showright){\r\n      this.$refs.switchright.style.right=this.lwidth+'px';\r\n    }else{\r\n      this.$refs.switchright.style.right='0px';\r\n    }\r\n  },\r\n },\r\n}\r\n",{"version":3,"sources":["wschart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"wschart.vue","sourceRoot":"src/warm/yixiang-chart","sourcesContent":["<template>\r\n  <div id=\"clickMe\" class=\"backdiv\" @dblclick=\"toggleFullScreen()\">\r\n    <img src=\"../common/image/wsmapnosite.png\" :style=\"{'width':imgwidth+'px','height':imgheight+'px','position':'absolute','top':-0.085*imgheight+'0px','left':leftwidth+'px'}\"></img>\r\n      <div ref=\"left\" :style=\"{'display':'inline-block','height':theight+'px','width':lwidth+'px','z-index':'3','position':'absolute','top':'0px','left':'0px'}\" v-show=\"showleft\">\r\n        <div ref=\"line\" :style=\"{'width':lwidth+'px','height':(subheight1*4)+'px'}\">\r\n            <div id=\"firstchart\" :style=\"{'width':lwidth+'px','height':(subheight1-1)+'px','margin-bottom':'1px'}\" class=\"subback\"></div>\r\n            <div id=\"secondchart\" :style=\"{'width':lwidth+'px','height':(subheight1-1)+'px','margin-bottom':'1px'}\" class=\"subback\"></div>\r\n            <div id=\"threechart\" :style=\"{'width':lwidth+'px','height':(subheight1-1)+'px','margin-bottom':'1px'}\" class=\"subback\"></div>\r\n            <div id=\"fourchart\" :style=\"{'width':lwidth+'px','height':(subheight1)+'px'}\" class=\"subback\"></div>\r\n        </div>\r\n    </div>\r\n    <div ref=\"center\" :style=\"{'display':'inline-block','height':theight+'px','width':cwidth+'px','z-index':'3','margin-left':lwidth+'px'}\">\r\n      <div style=\"color:#fff;text-shadow:5px 2px 6px #000;text-align:center;z-index:21;position:relative;top:25px;\"><h1>枉水灌区量测水管理系统</h1></div>\r\n      <div class=\"switch\" @click=\"switchleft\" ref=\"switchleft\">\r\n          <i class=\"el-icon-d-arrow-left\" v-if=\"showleft\"></i>\r\n          <i class=\"el-icon-d-arrow-right\" v-if=\"!showleft\"></i>\r\n        </div>\r\n      <div class=\"switchright\" @click=\"switchright\" ref=\"switchright\">\r\n          <i class=\"el-icon-d-arrow-left\" v-if=\"!showright\"></i>\r\n          <i class=\"el-icon-d-arrow-right\" v-if=\"showright\"></i>\r\n        </div>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(728/2055*imgwidth+leftwidth)+'px','top':(imgheight*(522/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMB0000014')\" id=\"SMB0000014\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(785/2055*imgwidth+leftwidth)+'px','top':(imgheight*(600/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMB0000013')\" id=\"SMB0000013\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(565/2055*imgwidth+leftwidth)+'px','top':(imgheight*(705/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMF0000001')\" id=\"SMF0000001\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(584/2055*imgwidth+leftwidth)+'px','top':(imgheight*(778/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMB0000006')\" id=\"SMB0000006\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(608/2055*imgwidth+leftwidth)+'px','top':(imgheight*(778/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMF0000002')\" id=\"SMF0000002\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(776/2055*imgwidth+leftwidth)+'px','top':(imgheight*(677/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMB0000017')\" id=\"SMB0000017\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(492/2055*imgwidth+leftwidth)+'px','top':(imgheight*(850/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMB0000007')\" id=\"SMB0000007\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(465/2055*imgwidth+leftwidth)+'px','top':(imgheight*(870/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMB0000021')\" id=\"SMB0000021\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(500/2055*imgwidth+leftwidth)+'px','top':(imgheight*(946/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMB0000008')\" id=\"SMB0000008\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(452/2055*imgwidth+leftwidth)+'px','top':(imgheight*(1001/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMF0000005')\" id=\"SMF0000005\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(415/2055*imgwidth+leftwidth)+'px','top':(imgheight*(1125/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMB0000011')\" id=\"SMB0000011\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(426/2055*imgwidth+leftwidth)+'px','top':(imgheight*(1147/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMB0000010')\" id=\"SMB0000010\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(420/2055*imgwidth+leftwidth)+'px','top':(imgheight*(1170/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMB0000009')\" id=\"SMB0000009\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(386/2055*imgwidth+leftwidth)+'px','top':(imgheight*(1304/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMU0000001')\" id=\"SMU0000001\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(669/2055*imgwidth+leftwidth)+'px','top':(imgheight*(1036/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMB0000012')\" id=\"SMB0000012\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(676/2055*imgwidth+leftwidth)+'px','top':(imgheight*(1139/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMB0000020')\" id=\"SMB0000020\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(1255/2055*imgwidth+leftwidth)+'px','top':(imgheight*(736/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMF0000004')\" id=\"SMF0000004\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(1169/2055*imgwidth+leftwidth)+'px','top':(imgheight*(756/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMF0000003')\" id=\"SMF0000003\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(1076/2055*imgwidth+leftwidth)+'px','top':(imgheight*(836/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMB0000015')\" id=\"SMB0000015\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(1059/2055*imgwidth+leftwidth)+'px','top':(imgheight*(856/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMB0000016')\" id=\"SMB0000016\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(934/2055*imgwidth+leftwidth)+'px','top':(imgheight*(877/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMB0000004')\" id=\"SMB0000004\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(946/2055*imgwidth+leftwidth)+'px','top':(imgheight*(994/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMB0000005')\" id=\"SMB0000005\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(828/2055*imgwidth+leftwidth)+'px','top':(imgheight*(1118/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMB0000018')\" id=\"SMB0000018\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(836/2055*imgwidth+leftwidth)+'px','top':(imgheight*(1184/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMB0000003')\" id=\"SMB0000003\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(800/2055*imgwidth+leftwidth)+'px','top':(imgheight*(1220/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMB0000019')\" id=\"SMB0000019\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(807/2055*imgwidth+leftwidth)+'px','top':(imgheight*(1260/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMB0000002')\" id=\"SMB0000002\"></div>\r\n      </el-popover>\r\n      <el-popover placement=\"top-start\" :title=\"form.STNM\" width=\"220\" trigger=\"hover\">\r\n      <table><tr><td>时间：</td><td>{{form.TM}}</td></tr><tr><td>水深：</td><td>{{form.Z}}m</td></tr><tr><td>流量：</td><td>{{form.Q}}m³/s</td></tr></table>\r\n      <div slot=\"reference\" :style=\"{'left':(745/2055*imgwidth+leftwidth)+'px','top':(imgheight*(1333/1703-0.085))+'px'}\" class=\"qddiv\" @mouseover=\"showcanalinfo('SMB0000001')\" id=\"SMB0000001\"></div>\r\n      </el-popover>\r\n    </div>\r\n    <div ref=\"right\" :style=\"{'display':'inline-block','height':theight+'px','width':lwidth+'px','z-index':'3','position':'absolute','top':'0px','right':'0px'}\" v-show=\"showright\">\r\n        <div ref=\"imgsite\" :style=\"{'width':lwidth+'px','height':(theight*0.68)+'px','padding-top':'5px'}\" class=\"subback\">\r\n            <div :style=\"{'margin-left':(lwidth*0.0183)+'px','margin-right':(lwidth*0.0183)+'px','width':(lwidth*0.2134)+'px','margin-top':'3px','display':'inline-block','float':'left','text-align':'center'}\" v-for=\"item in imglist\">   \r\n                <img :style=\"{'width':(theight*0.0545)+'px','height':(theight*0.05445)+'px','cursor':'pointer'}\" src=\"../common/image/shipin.png\" @click=\"showvideo(item.puid)\"></img>\r\n                <div :style=\"{'width':(lwidth*0.2134)+'px','height':(theight*0.02-3)+'px','margin-bottom':'3px','color':'#fff','font-family':'微软雅黑','font-size':'12px','font-weight':'bold'}\">{{item.stnm}}</div>            \r\n            </div>\r\n        </div>\r\n        <div ref=\"piechart\" :style=\"{'width':lwidth+'px','height':(theight*0.32-1)+'px','margin-top':'1px'}\" class=\"subback\"></div>\r\n    </div>\r\n    <div id=\"videodiv\" class=\"videodiv\" v-show=\"videosign\">\r\n      <img src=\"../common/image/close.png\" style=\"float:right;cursor:pointer;width:32px;height:32px;\" @click=\"hidediv()\"></img>\r\n      <iframe :style=\"{'width':'900px','height':'680px','overflow':'hidden','margin-top':videotop+'px','margin-left':videoleft+'px'}\" :src=\"videosrc\"  frameborder=\"no\" border=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\">\r\n\r\n      </iframe>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport FilterMethods from \"@/assets/commonJS/FilterMethods\";\r\nimport GetDataMethods from \"@/assets/commonJS/GetDataMethods\";\r\nimport { setInterval,setTimeout } from \"timers\";\r\nimport { truncateSync } from \"fs\";\r\nexport default {\r\n    data() {\r\n        return {\r\n            imglist:[],\r\n            theight:window.screen.height,\r\n            subheight1:window.screen.height*0.25,\r\n            lwidth:window.screen.width*0.28125,\r\n            cwidth:window.screen.width*0.4375,\r\n            imgwidth:window.screen.height*2055/1703*1.19,\r\n            imgheight:window.screen.height*1.19,\r\n            allwidth:window.screen.width,\r\n            leftwidth:window.screen.width*0.28125*0.7,\r\n            showleft:true,\r\n            showright:true,\r\n            videosign:false,\r\n            videotop:(window.screen.height-680)/2,\r\n            videoleft:(window.screen.width-900)/2,\r\n            videosrc:'',\r\n            form:{},\r\n            canallist:[],\r\n            gatelist:[],\r\n        }\r\n    },\r\n  mixins: [FilterMethods, GetDataMethods],\r\n  mounted() {\r\n      this.loadRealData();\r\n      this.loadline();  \r\n      this.loadImgdata();\r\n      this.loadPiechart();  \r\n      setInterval(() => {\r\n          this.reloadData();\r\n        }, 1000*60*5);  \r\n  },\r\n  methods: {\r\n    toggleFullScreen(){\r\n          var el=document.documentElement;\r\n          if(el.requestFullscreen){\r\n              el.requestFullscreen()\r\n            }else if(el.mozRequestFullScreen){\r\n              el.mozRequestFullScreen()\r\n            }else if(el.webkitRequestFullscreen){\r\n              el.webkitRequestFullscreen();    \r\n            }else if(el.msRequestFullscreen){\r\n              el.msRequestFullscreen()            \r\n            }\r\n      },\r\n    //重新加载数据\r\n    reloadData(){\r\n      this.loadRealData();\r\n      this.loadline();  \r\n      this.loadImgdata();\r\n      this.loadPiechart(); \r\n    },\r\n    //绘制线性图\r\n    loadline(){\r\n        var body = {\r\n        STCD: 'SMB0000002',\r\n        _page_size: 999999\r\n      };\r\n\r\n      // 时间参数\r\n      var DTT = this.$FilterData\r\n              .elDatePicker_Filter(this.$App.zeroPointToNowOfTheDay())\r\n              .split(\",\");\r\n      body.Time_min = DTT[1];\r\n      body.Time_max = DTT[2];\r\n\r\n      this.$GetData.Survey_History_QDSQ(\r\n        \"historyTable\",\r\n        body,\r\n        {\r\n          default: true\r\n        },\r\n        data => {\r\n          this.createChart('firstchart', data.data,'凉水干渠渠首');\r\n        }\r\n      );\r\n      var body2={\r\n          STCD: 'SMB0000003',\r\n          _page_size: 999999\r\n      };\r\n      body2.Time_min = DTT[1];\r\n      body2.Time_max = DTT[2];\r\n      this.$GetData.Survey_History_QDSQ(\r\n        \"historyTable\",\r\n        body2,\r\n        {\r\n          default: true\r\n        },\r\n        data => {\r\n          this.createChart('secondchart', data.data,'团岭干渠渠首');\r\n        }\r\n      );\r\n      var body3={\r\n          STCD: 'SMB0000019',\r\n          _page_size: 999999\r\n      };\r\n      body3.Time_min = DTT[1];\r\n      body3.Time_max = DTT[2];\r\n      this.$GetData.Survey_History_QDSQ(\r\n        \"historyTable\",\r\n        body3,\r\n        {\r\n          default: true\r\n        },\r\n        data => {\r\n          this.createChart('threechart', data.data,'孙家冲平衡站');\r\n        }\r\n      );\r\n      var body4={\r\n          STCD: 'SMB0000016',\r\n          _page_size: 999999\r\n      };\r\n      body4.Time_min = DTT[1];\r\n      body4.Time_max = DTT[2];\r\n      this.$GetData.Survey_History_QDSQ(\r\n        \"historyTable\",\r\n        body4,\r\n        {\r\n          default: true\r\n        },\r\n        data => {\r\n          this.createChart('fourchart', data.data,'石门桥干渠渠首');\r\n        }\r\n      );\r\n    },\r\n    //加载渠道和闸阀水情实时数据\r\n    loadRealData(){\r\n       this.axios.get('/fieldinfo/getrinfo').then(res => {\r\n             var obj=res.data;\r\n             this.canallist=obj.typecanal;\r\n             for(var i=0;i<this.canallist.length;i++){\r\n              var canalobj=this.canallist[i];\r\n              if(canalobj.Z>0){\r\n                document.getElementById(canalobj.STCD).className = \"waterqddiv\";\r\n              }\r\n              if(canalobj.ALARM==1){\r\n                document.getElementById(canalobj.STCD).className = \"warmqddiv\";\r\n              }\r\n            }\r\n             this.gatelist=obj.typegate;\r\n         });\r\n    },\r\n    //加载图像站数据\r\n    loadImgdata(){\r\n      this.imglist=[];\r\n        this.axios.get('/fieldinfo/videodata').then(res => {\r\n            var list=res.data;\r\n            for(var i=0;i<list.length;i++){\r\n                    var img_obj=new Object();\r\n                    img_obj.stnm=list[i].STNM;\r\n                    img_obj.stcd=list[i].STCD;\r\n                    img_obj.puid=list[i].PUID;\r\n                    this.imglist.push(img_obj);\r\n            }\r\n        });\r\n    },\r\n  //加载饼状图\r\n  loadPiechart(){\r\n      this.axios.get('/fieldinfo/piechart').then(res => {\r\n            var list=res.data;\r\n            var echartData={y:{list:[]}};\r\n            if(list.length==1){\r\n                if(list[0].CS==0){\r\n                    var p1=new Object();\r\n                    p1.value=list[0].TOTAL;\r\n                    p1.name=list[0].TITLE;\r\n                    echartData.y.list.push(p1);\r\n                    var p2=new Object();\r\n                    p2.value=0;\r\n                    p2.name=\"正常\";\r\n                    echartData.y.list.push(p2);\r\n                }else{\r\n                    var p2=new Object();\r\n                    p2.value=0;\r\n                    p2.name=\"故障\";\r\n                    echartData.y.list.push(p2);\r\n                    var p1=new Object();\r\n                    p1.value=list[0].TOTAL;\r\n                    p1.name=list[0].TITLE;\r\n                    echartData.y.list.push(p1);                   \r\n                }\r\n            }else if(list.length>1){\r\n                for(var h=0;h<list.length;h++){\r\n                    var p_obj=new Object();\r\n                    p_obj.value=list[h].TOTAL;\r\n                    p_obj.name=list[h].TITLE;\r\n                    echartData.y.list.push(p_obj);\r\n                }               \r\n            }\r\n            this.createPiechart(echartData);\r\n        });\r\n  },\r\n    // 水位流量线性图\r\n    createChart(id, data,stnm) {\r\n      if (data.length > 0) {\r\n        var echartData = this.$App.transform_QDSQ_data_into_ehart_data(\r\n          data,\r\n          \"historyTable\"\r\n        );\r\n        // 渠道水情历史统计表数据 转 ehart图形用数据 返回一个对象, 对象里分别装 Y1轴对象 Y2轴对象 X轴对象\r\n        var x_List = echartData.x.list\r\n        .map((val, index, array) => {\r\n          // 时间过滤\r\n          var time = val.split(\" \");\r\n          return time[1];\r\n        });\r\n        myChart = this.$echarts.init(document.getElementById(id));\r\n\r\n        myChart.setOption({\r\n          title: {\r\n            text: stnm+\"今日水情图\",\r\n             textStyle: {\r\n              fontSize: 14,\r\n              fontWeight: 'bolder',\r\n              color: '#fff'\r\n            },\r\n          },\r\n          backgroundColor:'',\r\n          tooltip: {\r\n            trigger: \"axis\",\r\n          },\r\n          color:['#f6ff00','#00ffa2'],\r\n          legend: {\r\n            icon : 'roundRect',//icon为圆角矩形          \r\n            data: [echartData.y1.name, echartData.y2.name],\r\n            x: \"right\",\r\n            textStyle:{\r\n               color:'#fff'\r\n           }\r\n          },\r\n          grid: {  \r\n                left: '3%',   //图表距边框的距离\r\n                right: '4%',\r\n                bottom:'1%',\r\n                containLabel: true,\r\n                backgroundColor:'rgba(280,280,280,0.4)',\r\n                show:true\r\n            },\r\n          animation: false,\r\n          xAxis: [\r\n            {\r\n              type: \"category\",\r\n              boundaryGap: false,\r\n              data: x_List,\r\n              splitLine:{show: false},//去除网格线\r\n              axisLine: {\r\n                   lineStyle: {\r\n                       type: 'solid',\r\n                       color:'#ebebe3',\r\n                       width:'2'\r\n                   }\r\n               },\r\n              axisTick: {\r\n                interval: function(index, val) {\r\n                  var listLength = echartData.x.list.length;\r\n                  if (listLength >= 4) {\r\n                    var tick = Math.round(listLength / 4);\r\n                    if ((index + 1) % tick === 0) {\r\n                      return true;\r\n                    } else {\r\n                      return false;\r\n                    }\r\n                  } else {\r\n                    return true;\r\n                  }\r\n                },\r\n                length: 10\r\n              },\r\n              axisLabel: {\r\n                interval: function(index, val) {\r\n                  var listLength = echartData.x.list.length;\r\n                  if (listLength >= 4) {\r\n                    var tick = Math.round(listLength / 4);\r\n                    let a = (index + 1) % tick;\r\n                    if ((index + 1) % tick === 0) {\r\n                      return true;\r\n                    } else {\r\n                      return false;\r\n                    }\r\n                  } else {\r\n                    return true;\r\n                  }\r\n                },\r\n                rotate: 0,\r\n                margin: 16,\r\n                textStyle: {\r\n                       color: '#fff'\r\n                   }\r\n              }\r\n            }\r\n          ],\r\n          yAxis: [\r\n            {\r\n              name: `${echartData.y1.name} m³/s`,\r\n              type: \"value\",             \r\n              splitLine:{show: false},//去除网格线\r\n              axisLine: {\r\n                   lineStyle: {\r\n                       type: 'solid',\r\n                       color:'#ebebe3',\r\n                       width:'2'\r\n                   }\r\n               },\r\n              axisLabel: {\r\n                formatter: \"{value} \",\r\n                textStyle: {\r\n                       color: '#fff'\r\n                   }\r\n              },\r\n              scale: true\r\n            },\r\n            {\r\n              name: `${echartData.y2.name}m`,\r\n              type: \"value\",\r\n              splitLine:{show: false},//去除网格线\r\n              axisLine: {\r\n                   lineStyle: {\r\n                       type: 'solid',\r\n                       color:'#ebebe3',\r\n                       width:'2'\r\n                   }\r\n               },\r\n              axisLabel: {\r\n                formatter: \"{value} \",\r\n                textStyle: {\r\n                       color: '#fff'\r\n                   }\r\n              },\r\n              scale: true\r\n            }\r\n          ],\r\n          series: [\r\n            {\r\n              name: echartData.y1.name,\r\n              type: \"line\",\r\n              data: echartData.y1.list,\r\n              symbol: 'none',\r\n              smooth:true,\r\n              itemStyle : {  \r\n                                normal : {  \r\n                                    lineStyle:{  \r\n                                        color:'#f6ff00',\r\n                                        width:2,\r\n                                        opacity:1\r\n                                    }  \r\n                                }  \r\n                            },\r\n            },\r\n            {\r\n              name: echartData.y2.name,\r\n              type: \"line\",\r\n              data: echartData.y2.list,\r\n              yAxisIndex: 1,\r\n              symbol: 'none',\r\n              smooth:true,\r\n              itemStyle : {  \r\n                                normal : {  \r\n                                    lineStyle:{  \r\n                                        color:'#00ffa2',\r\n                                        width:2,\r\n                                        opacity:1\r\n                                    }  \r\n                                }  \r\n                            },\r\n            }\r\n          ]\r\n        });\r\n      } else {\r\n        var myChart = document.getElementById(id);\r\n        myChart.style.display = \"flex\";\r\n        myChart.style.alignItems = \"center\";\r\n        myChart.style.justifyContent = \"center\";\r\n        myChart.innerHTML =\"<font style='color:#fff;font-weight:bold;'>\"+stnm+\"暂无今天数据</font>\";\r\n      }\r\n    },\r\n    //饼状图\r\n    createPiechart(edata){\r\n    var myChart = this.$echarts.init(this.$refs.piechart);\r\n        // 指定图表的配置项和数据\r\n        var option = {\r\n            // 标题\r\n            title: {\r\n                text: '站点运行工况故障分布图',\r\n                 x: 'center',\r\n                 top: 10,\r\n                 textStyle: {\r\n                    fontSize: 14,\r\n                    fontWeight: 'bold',\r\n                    color:'#fff'\r\n                  },\r\n            },\r\n            //自定义的颜色\r\n            color:[  '#ef2424','#12d0ff'],\r\n            // 图例\r\n            legend: {\r\n                data: ['正常','故障'],\r\n                orient: 'vertical',\r\n                x:'right',\r\n                y:'center',\r\n                textStyle:{\r\n                    color:'#fff'\r\n                }\r\n            },\r\n            grid: {  \r\n                bottom:'2%',\r\n            },\r\n            // 数据\r\n            series: [{\r\n                name: '分布情况',\r\n                type: 'pie',\r\n                radius : '65%',\r\n                center: ['50%', '55%'],\r\n                data: edata.y.list,\r\n                label: {\r\n                normal: {\r\n                    textStyle: {\r\n                        color: 'rgba(255, 255, 255, 1)'\r\n                    }\r\n                }\r\n            },\r\n            labelLine: {\r\n                normal: {\r\n                    lineStyle: {\r\n                        color: 'rgba(255, 255, 255, 1)'\r\n                    },\r\n                    smooth: 0.2,\r\n                    length: 10,\r\n                    length2: 20\r\n                }\r\n            },\r\n                itemStyle: {\r\n                    emphasis: {\r\n                        shadowBlur: 10,\r\n                        shadowOffsetX: 0,\r\n                        shadowColor: 'rgba(255, 255, 255, 0.9)'\r\n                    },\r\n                    normal:{ \r\n                        label:{ \r\n                            show: true, \r\n                            formatter: '{b} : {c} ({d}%)',\r\n                        }, \r\n                        labelLine :{show:true},\r\n                        // 设置扇形的阴影\r\n                        shadowBlur: 30,\r\n                        shadowColor: 'rgba(6,121,159,0.8)', \r\n                        shadowOffsetX: -10,\r\n                        shadowOffsetY: 10\r\n                    }\r\n                } \r\n            }\r\n            ]\r\n        };\r\n    // 使用刚指定的配置项和数据显示图表。\r\n    myChart.setOption(option);       \r\n    },\r\n    showvideo(puid){\r\n      if (!!window.ActiveXObject || \"ActiveXObject\" in window){\r\n         try\r\n          {\r\n            var obj = new ActiveXObject(\"DPSDK_OCX.DPSDK_OCXCtrl.1\");\r\n          }\r\n          catch(e)\r\n          {\r\n            this.$message({message:'控件未注册，请先注册控件！',type:'warning'});\r\n            var url = '/file/downloadocx';\r\n            window.location.href = url;\r\n            return;\r\n          }\r\n      }else{\r\n        this.$message({message:'请确保在IE浏览器下使用视频监控功能！',type:'warning'});\r\n        return;\r\n      }\r\n      this.videosign=true;\r\n      this.videosrc=\"webdemo/index.html?\"+puid;\r\n      \r\n    },\r\n    hidediv(){\r\n      this.videosign=false;\r\n    },\r\n    //显示渠道信息\r\n  showcanalinfo(stcd){\r\n      this.form=new Object();\r\n      for(var i=0;i<this.canallist.length;i++){\r\n        var canalobj=this.canallist[i];\r\n        if(canalobj.STCD==stcd){\r\n          this.form=canalobj;\r\n          break;\r\n        }\r\n      }\r\n  },\r\n  //显示闸阀信息\r\n  showgateinfo(stcd){\r\n    this.form=new Object();\r\n      for(var i=0;i<this.gatelist.length;i++){\r\n        var gateobj=this.gatelist[i];\r\n        if(gateobj.STCD==stcd){\r\n          this.form=gateobj;\r\n          break;\r\n        }\r\n      }\r\n  },\r\n    switchleft(){\r\n    this.showleft=!this.showleft;\r\n    if(this.showleft){\r\n      this.$refs.switchleft.style.left=this.lwidth+'px';\r\n    }else{\r\n      this.$refs.switchleft.style.left='0px';\r\n    }\r\n  },\r\n  switchright(){\r\n    this.showright=!this.showright;\r\n    if(this.showright){\r\n      this.$refs.switchright.style.right=this.lwidth+'px';\r\n    }else{\r\n      this.$refs.switchright.style.right='0px';\r\n    }\r\n  },\r\n },\r\n}\r\n</script>\r\n<style lang=\"less\" scope>\r\n.backdiv{\r\nwidth:100%;\r\nheight: 100vh;\r\nmargin: 0 auto;\r\nbackground-image: url(../common/image/backpic.jpg);\r\nbackground-repeat: no-repeat;\r\nbackground-size: cover;\r\noverflow: hidden;\r\nposition: relative;\r\n}\r\n.videodiv{\r\nwidth:100%;\r\nheight: 100vh;\r\ntop: 0;\r\nleft: 0;\r\nbackground: #166CC7;\r\nposition:absolute;\r\nz-index:20;\r\nopacity:0.85;\r\n}\r\n.subback{\r\n  opacity:0.9;\r\n  //background: #1B74D0;\r\n  background: linear-gradient(to bottom, #177DE7, #1768BD);\r\n  background: -ms-linear-gradient(top, #177DE7, #1768BD);\r\n  background: -webkit-linear-gradient(top, #177DE7, #1768BD);\r\n  background: -moz-linear-gradient(top, #177DE7, #1768BD);\r\n  box-shadow: 0 0 1px #fff;\r\n}\r\n.qddiv{\r\n  width:16px;\r\n  height:16px;\r\n  background:url(../common/image/qd.png);\r\n  position:absolute;\r\n  z-index:10;\r\n  opacity: 1;\r\n}\r\n.waterqddiv{\r\n  width:16px;\r\n  height:16px;\r\n  background:url(../common/image/waterqd.png);\r\n  position:absolute;\r\n  z-index:10;\r\n  opacity: 1;\r\n}\r\n.warmqddiv{\r\n  width:16px;\r\n  height:16px;\r\n  background:url(../common/image/warmqd.png);\r\n  position:absolute;\r\n  z-index:10;\r\n  opacity: 1;\r\n}\r\n.gatediv{\r\n  width:14px;\r\n  height:14px;\r\n  background-color:yellow;\r\n  position:absolute;\r\n  z-index:10;\r\n  opacity: 0;\r\n}\r\n.switch {\r\n    position: absolute;\r\n    left: 28.125%;\r\n    top:50%;\r\n    width: 15px;\r\n    height: 30px;\r\n    cursor: pointer;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: #BEDEFF;\r\n    border-top-right-radius: 5px;\r\n    border-bottom-right-radius: 5px;\r\n    border: #1B74D0 2px solid;\r\n    border-left: 0;\r\n\r\n    &:hover {\r\n      filter: brightness(1.1);\r\n    }\r\n  }\r\n.switchright{\r\n  position: absolute;\r\n    right:28.125%;\r\n    top:50%;\r\n    width: 15px;\r\n    height: 30px;\r\n    cursor: pointer;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: #BEDEFF;\r\n    border-top-left-radius: 5px;\r\n    border-bottom-left-radius: 5px;\r\n    border: #1B74D0 2px solid;\r\n    border-right: 0;\r\n\r\n    &:hover {\r\n      filter: brightness(1.1);\r\n    }\r\n}\r\n</style>"]}]}